{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/lc_commission/lc-commission-upload.js"],"names":["$","$idUpload","$toUpload","$uploadStatus","val","trim","show","on","lcCommissionInstances","Papa","parse","delimiter","header","step","row","lcCommissionData","obj","data","_","each","key","LC_COMMISSION_REPORT_MODEL_HEADERS_MAPPING","lcCommissionAttribute","push","e","window","alert","message","JSON","stringify","submit","evt","test","prop","this","addClass","preventDefault"],"mappings":"AAAAA,EAAG,WAGD,YAEA,IAAIC,GAAwBD,EAAG,8BAC3BE,EAAwBF,EAAG,yBAC3BG,EAAwBH,EAAG,+BAE1BG,GAAcC,MAAMC,QAASF,EAAcG,OAEhDL,EAAUM,GAAI,QAAS,WACrB,GAAIC,KACJN,GAAUE,IAAK,IAEfK,KAAKC,MAAOT,EAAUG,MAAMC,QAC1BM,UAAW,KAAMC,QAAQ,EAAMC,KAAM,SAAUC,GAC7C,GAAIC,MACAC,EAAMF,EAAIG,KAAK,EAEnB,KACEC,EAAEC,KAAMH,EAAK,SAAUZ,EAAKgB,GAC1B,GAAKA,IAAOC,4CAA6C,CACvD,GAAIC,GAAwBD,2CAA2CD,EACvEL,GAAiBO,GAAyBlB,EAAIC,UAIlDG,EAAsBe,KAAMR,GAC5B,MAAOS,GACPC,OAAOC,MAAO,uBAAyBF,EAAEG,aAK/CzB,EAAUE,IAAKwB,KAAKC,UAAWrB,MAGjCR,EAAG,8BAA+B8B,OAAQ,SAAUC,GAE7C,WAAWC,KAAM9B,EAAUE,QAC9BJ,EAAG,8BAA+BiC,KAAM,YAAY,GACpDjC,EAAG,YAAamB,KAAM,WACpBnB,EAAGkC,MAAOD,KAAM,YAAY,KAE9BjC,EAAGkC,MAAOC,SAAU,gCAGpBV,OAAOC,MAAO,6CACdK,EAAIK","file":"letter_of_credit/static/letter_of_credit/js/lc_commission/lc-commission-upload.min.js","sourcesContent":["$( function () {\r\n  /*jshint camelcase:false*/\r\n\r\n  \"use strict\";\r\n\r\n  var $idUpload             = $( '#upload-lc-commission-text' ),\r\n      $toUpload             = $( '#upload-lc-commission' ),\r\n      $uploadStatus         = $( '#upload-lc-commission-status' )\r\n\r\n  if ( $uploadStatus.val().trim() ) $uploadStatus.show()\r\n\r\n  $idUpload.on( 'input', function () {\r\n    var lcCommissionInstances = []\r\n    $toUpload.val( '' )\r\n\r\n    Papa.parse( $idUpload.val().trim(), {\r\n      delimiter: '\\t', header: true, step: function (row) {\r\n        var lcCommissionData = {}\r\n        var obj = row.data[0]\r\n\r\n        try {\r\n          _.each( obj, function (val, key) {\r\n            if ( key in LC_COMMISSION_REPORT_MODEL_HEADERS_MAPPING ) {\r\n              var lcCommissionAttribute = LC_COMMISSION_REPORT_MODEL_HEADERS_MAPPING[key]\r\n              lcCommissionData[lcCommissionAttribute] = val.trim()\r\n            }\r\n          } )\r\n\r\n          lcCommissionInstances.push( lcCommissionData )\r\n        } catch (e) {\r\n          window.alert( \"Error parsing data\\n\" + e.message )\r\n        }\r\n      }\r\n    } )\r\n\r\n    $toUpload.val( JSON.stringify( lcCommissionInstances ) )\r\n  } )\r\n\r\n  $( '.upload-lc-commission-form' ).submit( function (evt) {\r\n\r\n    if ( /^\\[\\{\".+/.test( $toUpload.val() ) ) {\r\n      $( '#upload-lc-register-submit' ).prop( 'disabled', true )\r\n      $( 'textarea' ).each( function () {\r\n        $( this ).prop( 'readonly', true )\r\n      } )\r\n      $( this ).addClass( 'ui-widget-overlay ui-front' )\r\n\r\n    } else {\r\n      window.alert( 'Nothing to upload or invalid upload data!' )\r\n      evt.preventDefault()\r\n    }\r\n  } )\r\n\r\n} )\r\n"],"sourceRoot":"/source/"}