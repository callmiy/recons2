!function(e){function o(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}var t={};return o.m=e,o.c=t,o.p="",o(0)}([function(e,o,t){"use strict";function i(e,o){o.otherwise("/"),e.state("home",{url:"/",kanmiiTitle:"Home",template:t(20)})}t(1),t(4),t(7),t(8),t(10),t(12),t(13),t(15),t(16);var n=t(2),r=angular.module("form-m-root-app",["rootApp","ui.router","form-m","form-m-bid"]);r.config(n.interpolateProviderConfig),r.run(["$rootScope","$state","$stateParams",function(e,o,t){e.$state=o,e.$stateParams=t}]),r.config(i),i.$inject=["$stateProvider","$urlRouterProvider"]},function(e,o,t){"use strict";function i(e){e.state("addBid",{url:"/bid/add-bid",kanmiiTitle:"Make Bid Request",template:t(3),controller:"MakeBidRequestController as makeBidRequest"})}function n(e,o,t,i,n,r,s,a,l,d,c){function m(e){e&&(e.$setPristine(),e.$setUntouched()),g.formMDetailShown=!1,g.goodsInputIsEditable=!1,g.bid={mf:null,amount:""}}function u(e){function o(){var o={mf:e.mf.url,amount:e.amount};new n(o).$save(t,i)}function t(e){a.editWithModal({bid:e,formM:b,title:"Bid Save Successful",closeCb:function(e){l.go("bid",{newBid:e})}})}function i(e){s(e,c)}b.goods_description!==e.mf.goods_description?(b.goods_description=e.mf.goods_description,r.put(b).$promise.then(function(e){o(),b=e},function(e){s(e,d)})):o()}function f(e){b=angular.copy(e),g.mfGetterSetter(e),g.bid.number||g.amountGetterSetter(e.amount),g.dateReceivedGetterSetter(e.date_received),g.formMs=[e]}function p(){g.goodsInputIsEditable=!g.goodsInputIsEditable&&g.bid.mf&&g.bid.mf.number?!0:!1}var g=this,b={goods_description:null};m(),g.reset=m,g.modelManager=o,g.tableCaption="Select form M for bid request",g.formMs=[],g.submitBid=u,g.mfGetterSetter=function(e){return e?void(g.bid.mf=e):t.isEmpty(g.bid.mf)?"":g.bid.mf.number+": "+g.bid.mf.applicant_data.name},g.amountGetterSetter=function(e){return e?void(g.bid.amount=Number(String(e).replace(",",""))):g.bid.amount?i("number")(g.bid.amount,2):""},g.dateReceivedGetterSetter=function(e){return e?void(g.bid.mf.date_received=new Date(e)):g.bid.mf?i("date")(g.bid.mf.date_received,"dd-MMM-yyyy"):""},g.onSelectFormM=f,g.getFormM=function(){e.searchWithModal().then(function(e){var o=e.results;o.length&&(1===o.length?g.onSelectFormM(o[0]):(g.formMs=o,g.paginationHooks={next:e.next,previous:e.previous,count:e.count}))})},g.toggleShowFormMDetail=function(){g.formMDetailShown=!g.formMDetailShown},g.toggleEditGoods=p}var r=t(2),s=angular.module("add-bid",["rootApp","ui.router","model-table","form-m-service","form-m-search-service","kanmii-underscore","lc-bid-request","edit-bid"]);s.config(r.interpolateProviderConfig),s.config(i),i.$inject=["$stateProvider"],s.controller("MakeBidRequestController",n),n.$inject=["SearchFormMService","formMModelManager","kanmiiUnderscore","$filter","LcBidRequest","FormM","xhrErrorDisplay","EditBid","$state","formMAttributesVerboseNames","bidAttributesVerboseNames"]},function(e,o){"use strict";function t(e,o){return staticPrefix+e+"/js/"+o}function i(e){e.run(["$rootScope",function(e){e.staticPrefix=staticPrefix,e.addIconSrc=staticPrefix+"core_recons/css/images/icon_addposting.gif"}])}var n=["$interpolateProvider",function(e){e.startSymbol("{$"),e.endSymbol("$}")}];e.exports={interpolateProviderConfig:n,buildUrl:t,rootAppName:"core_recons",setStaticPrefix:i}},function(e,o){e.exports='<div class="make-bid-request-root-container"><div class="" style="font-size: 18px;margin-bottom: 15px; margin-left: 10px;"><a ui-sref="bid" style="text-decoration: initial;"><span class="glyphicon glyphicon-circle-arrow-left"></span> Pending Bids</a></div><div class="row" style="margin-bottom: 45px;"><div class="bid-request-form col-sm-5 well"><form novalidate="" ng-submit="makeBidRequest.submitBid(makeBidRequest.bid)" role="form" name="makeBidRequestForm"><div class="form-group form-m-group"><label for="form-m">Form M</label><div class="input-group"><span class="input-group-addon" data-toggle="tooltip" title="Search for Form M" ng-dblclick="makeBidRequest.getFormM()" style="cursor: pointer;"><i class="glyphicon glyphicon-search"></i></span> <input type="text" class="form-control" min="4" id="form-m" readonly="" required="" name="mf" placeholder="Double click to search" ng-model="makeBidRequest.mfGetterSetter" ng-dblclick="makeBidRequest.getFormM()" ng-pattern="/^MF\\d{11}\\: .+/" ng-model-options="{getterSetter: true}"> <span class="input-group-addon" data-toggle="tooltip" ng-show="makeBidRequest.bid.mf.number" ng-click="makeBidRequest.toggleShowFormMDetail()" title="View Form M" style="cursor:pointer;"><i class="glyphicon glyphicon-eye-open"></i></span></div></div><div class="form-group amount-group"><label for="amount">Bid Amount</label><div class="input-group"><span class="input-group-addon">{$makeBidRequest.bid.mf.currency_data.code || \'@\'$}</span> <input type="text" class="form-control" id="amount" required="" ng-model="makeBidRequest.amountGetterSetter" ng-model-options="{getterSetter: true, updateOn: \'blur\'}"></div></div><div class="form-group goods-description-group"><label for="goods-description">Goods description</label><div class="input-group"><input type="text" class="form-control" id="goods-description" required="" ng-minlength="5" to-upper="" name="goods-description" ng-model="makeBidRequest.bid.mf.goods_description" ng-readonly="!makeBidRequest.goodsInputIsEditable"> <span class="input-group-addon" style="cursor:pointer;" ng-click="makeBidRequest.toggleEditGoods()"><span class="glyphicon glyphicon-pencil"></span></span></div></div><div class="form-group add-bid-form-control"><button type="submit" class="btn btn-info" ng-disabled="makeBidRequestForm.$invalid" name="add-bid-form-control-submit" style="margin-right: 5%;">Make Request</button> <button type="button" class="btn btn-default" ng-click="makeBidRequest.reset(makeBidRequestForm)">Reset</button></div></form></div><div class="form-m-detail-container col-sm-offset-2 col-sm-4" ng-show="makeBidRequest.formMDetailShown"><span class="form-m-detail-container-dismiss" ng-click="makeBidRequest.toggleShowFormMDetail()">&times;</span><div class="form-group form-m-number-group"><label class="control-label" for="form-m-detail-number">Form M Number</label> <input class="form-control" ng-model="makeBidRequest.bid.mf.number" id="form-m-detail-number" disabled=""></div><div class="form-group applicant-group"><label class="control-label" for="form-m-detail-applicant">Applicant</label> <input class="form-control" type="text" id="form-m-detail-applicant" ng-model="makeBidRequest.bid.mf.applicant_data.name" disabled=""></div><div class="form-group amount-group"><label class="control-label" for="form-m-detail-amount">Form M Amount</label><div class="input-group"><span class="input-group-addon">{$makeBidRequest.bid.mf.currency_data.code$}</span> <input class="form-control" id="form-m-detail-amount" required="" ng-model="makeBidRequest.amountGetterSetter" disabled="" ng-model-options="{getterSetter: true}"></div></div><div class="form-group goods-description-group"><label class="control-label" for="form-m-detail-goods-description">Goods Description</label> <input class="form-control" type="text" id="form-m-detail-goods-description" ng-model="makeBidRequest.bid.mf.goods_description" disabled=""></div><div class="form-group received-date-group"><label class="control-label" for="form-m-detail-date-received">Date Received</label> <input class="form-control" id="form-m-detail-date-received" disabled="" ng-model="makeBidRequest.dateReceivedGetterSetter" ng-model-options="{getterSetter: true}"></div></div></div><model-table model-collection="makeBidRequest.formMs" table-model-manager="::makeBidRequest.modelManager" table-caption="::makeBidRequest.tableCaption" pagination-size="20" update-collection="makeBidRequest.getBidsOnNavigation(linkUrl)" pager-object="makeBidRequest.paginationHooks" on-row-dbl-click-callback="makeBidRequest.onSelectFormM(rowModel)"></model-table></div>'},function(e,o,t){"use strict";function i(){return{restrict:"EA",templateUrl:r.buildUrl("bid-request/display-pending-bid/display-pending-bid.html"),scope:{},bindToController:{bids:"=pendingBids",updateCollection:"&",onSelectedBidsChanged:"&",pager:"=pagerObject",onDblClick:"&onRowDblClickCallback",newModel:"=",paginationSize:"=",selectedBids:"="},controller:"displayPendingBidDirectiveCtrl as bidTable"}}function n(e,o,t){function i(o,t,i){var n=Math.ceil(i/a.paginationSize),r=e(o,t,n);a.nextPageLink=o,a.prevPageLink=t,a.linkUrls=r.linkUrls,a.currentLink=r.currentLink,a.rowIndexOffset=(a.currentLink-1)*a.paginationSize}function n(e){a.updateCollection({linkUrl:e})}function r(){a.bids.forEach(function(e){e.highlighted=!1})}function s(e){e.downloaded||(r(),e.highlighted=!t.any(a.bids,function(e){return e.checked}))}var a=this;a.selectedBids={},a.onUpdateCollection=n,o.$watch(function(){return a.pager},function(e){e&&!t.isEmpty(e)&&i(e.next,e.previous,e.count)}),a.modelRowClicked=s,o.$watch(function(){return a.selectedBids},function(e){a.onSelectedBidsChanged({newSelections:e}),e&&!t.isEmpty(e)&&(t.each(e,function(e,o){for(var t=0;t<a.bids.length;t++){var i=a.bids[t];i.id===+o&&(i.checked=e)}}),a.toggleAll=t.all(a.bids,function(e){return e.checked===!0}))},!0),a.toggleAll=!1,a.toggleAllClicked=function(){a.bids.forEach(function(e){a.selectedBids[e.id]=a.toggleAll})}}var r=t(5),s=angular.module("display-pending-bid",["kanmii-underscore"]);s.directive("displayPendingBid",i),s.controller("displayPendingBidDirectiveCtrl",n),n.$inject=["pagerNavSetUpLinks","$scope","kanmiiUnderscore"]},function(e,o,t){"use strict";function i(e){return n.buildUrl("form-m")+"/"+e}var n=t(6);e.exports={buildUrl:i}},function(e,o,t){"use strict";function i(e){return n.buildUrl(r,e)}var n=t(2),r="letter_of_credit";e.exports={buildUrl:i,appName:r}},function(e,o,t){"use strict";function i(e){function o(o,i,n,r){i.css({cursor:"pointer"}).bind("click",function(){e.showModal({templateUrl:t(5).buildUrl("bid-request/add-bid/add-bid.html"),controller:"AddBidModalCtrl as addBidModal"}).then(function(e){e.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,maxHeight:450,title:"Make Bid Request"}),e.close.then(function(e){e&&r.saveBid(e)})})})}return{restrict:"A",link:o,controller:"AddBidDirectiveCtrl as addBid",scope:{},bindToController:{onNewBid:"&"}}}function n(e,o){function t(t){function n(e){i.onNewBid({newBid:e})}function r(o){e(o,{mf:"form m",amount:"amount"})}var s={amount:t.amount,mf:t.mf.url};new o(s).$save(n,r)}var i=this;i.saveBid=t}function r(e,o,t,i,n,r){function s(){l.bid={mf:{}}}function a(e){t(e)}var l=this;s(),l.mfGetterSetter=function(e){return angular.isDefined(e)?void(l.bid.mf=e):n.isEmpty(l.bid.mf)?"":l.bid.mf.number+": "+l.bid.mf.applicant_data.name},l.close=t,l.reset=function(t){e(t,o,".form-control",s)},l.submitBid=a,l.getFormM=function(){function e(){o.find(".form-control").each(function(){var e=$(this);e.prop("disabled",!e.prop("disabled"))})}i.searchWithModal({parent:o,dim:!0,dimCb:e,unDimCb:e}).then(function(e){var o=e.results;o.length&&(1===o.length?l.mfGetterSetter(o[0]):(t(),r.go("addBid",{formMsFromSearch:e})))})}}var s=angular.module("add-bid-service",["rootApp","kanmii-underscore","form-m-search-service"]);s.directive("addBid",i),i.$inject=["ModalService"],s.controller("AddBidDirectiveCtrl",n),n.$inject=["xhrErrorDisplay","LcBidRequest"],s.controller("AddBidModalCtrl",r),r.$inject=["resetForm","$element","close","SearchFormMService","kanmiiUnderscore","$state"]},function(e,o,t){"use strict";function i(e){e.state("bid",{url:"/bid",params:{newBid:null},kanmiiTitle:"Bid Requests",template:t(9),controller:"BidRequestController as bidHome"})}function n(e,o,t,i,n,r,s,a,l,d,c,m,u){function f(){y.newBid=null,y.searchedBidResult=null,y.selectedBids={},y.selectedDownloadedBids={}}function p(){t.searchWithModal().then(function(e){console.log(e)})}function g(e){e&&y.bidRequests.unshift(e)}function b(e){n.get(e).then(function(e){h(e.data)})}function h(e){var o=e.results;if(r.newBid){for(var t=0;t<o.length;t++)if(o[t].id===r.newBid.id){o.splice(t,1);break}r.newBid.highlighted=!0,o.unshift(r.newBid),r.newBid=null}y.bidRequests=o,y.paginationHooks={next:e.next,previous:e.previous,count:e.count}}function v(e){e&&!l.isEmpty(e)&&l.each(e,function(e,o){var t=M(o);t&&t.downloaded&&(y.selectedDownloadedBids[o]=e)})}function M(e){for(var o=0;o<y.bidRequests.length;o++){var t=y.bidRequests[o];if(t.id===+e)return t}return null}var y=this;f(),y.searchFormMs=p,y.modelManager=i,y.bidRequests=[],y.paginationHooks={},e.pending().$promise.then(function(e){h(e)}),y.receiveNewBid=g,y.tableCaption="Pending Bids",y.getBidsOnNavigation=b,o.$watch(function(){return y.searchedBidResult},function(e){e&&h(e)});var F=s(a.lcBidRequestDownloadUrl);y.downloadUrl=function(){if(!l.isEmpty(y.selectedBids)){var e=[];return l.each(y.selectedBids,function(o,t){o===!0&&e.push(t)}),F.search({bid_ids:e}).toString()}},y.downloadBtnDisabled=function(){return l.isEmpty(y.selectedBids)?!0:!l.any(y.selectedBids,function(e){return e===!0})},y.onSelectedBidsChanged=v,y.markRequestedBtnDisabled=function(){if(l.isEmpty(y.selectedDownloadedBids))return!0;var e=l.any(y.selectedBids,function(e,o){return!l.has(y.selectedDownloadedBids,o)&&e===!0});return e?!0:!l.any(y.selectedDownloadedBids,function(e){return e===!0})},y.markRequested=function(){function o(e){y.bidRequests=y.bidRequests.filter(function(o){return o.id!==e.id})}function t(e){c(e)}l.each(y.selectedDownloadedBids,function(i,n){if(i){var r=M(n);r&&(r.requested_at=d(new Date),e.put(r).$promise.then(o,t))}}),f()},y.refreshPage=function(){u(function(){m.reload()},3e3)}}var r=t(2),s=angular.module("form-m-bid",["ui.router","model-table","display-pending-bid","add-bid","form-m-search-service","lc-bid-request","rootApp","kanmii-URI","kanmii-underscore"]);s.config(r.interpolateProviderConfig),s.config(i),i.$inject=["$stateProvider"],s.controller("BidRequestController",n),n.$inject=["LcBidRequest","$scope","SearchFormMService","lcBidRequestModelManager","$http","$stateParams","kanmiiUri","urls","kanmiiUnderscore","formatDate","xhrErrorDisplay","$state","$timeout"]},function(e,o){e.exports='<div class="form-m-home-view"><div class="action-buttons" style="text-align: right;margin-bottom: 30px;"><button type="button" class="btn btn-info" ng-click="$state.go(\'addBid\')">Add bid request</button> <button class="btn btn-info" ng-click="bidHome.searchBids()">Search Bid Requests</button> <a class="btn btn-success" ng-href="{$bidHome.downloadUrl()$}" ng-disabled="bidHome.downloadBtnDisabled()" ng-click="bidHome.refreshPage()">Download</a> <button type="button" name="bid-home-mark-as-requested-btn" class="btn btn-success" ng-click="bidHome.markRequested()" ng-disabled="bidHome.markRequestedBtnDisabled()">Mark as requested</button></div><div display-pending-bid="" pending-bids="bidHome.bidRequests" pager-object="bidHome.paginationHooks" update-collection="bidHome.getBidsOnNavigation(linkUrl)" pagination-size="20" selected-bids="bidHome.selectedBids" on-selected-bids-changed="bidHome.onSelectedBidsChanged(newSelections)"></div></div>'},function(e,o,t){"use strict";function i(e){function o(){function o(o){o=o&&angular.isObject(o)?o:{};var i=o.bid;if(!i)throw new Error("You did not specify the bid to edit");var n=o.formM;e.showModal({controller:"EditBidModalCtrl as editBidModal",template:t(11),inputs:{bid:i,formM:n}}).then(function(e){e.element.dialog({minWidth:450,minHeight:400,modal:!0,title:o.title||"Edit Bid for "+i.form_m_number,close:function(){e.close.then(),o.closeCb?o.closeCb(i):angular.noop}}),e.close.then(function(e){e&&(console.log("bidForEdit = ",e),o.closeCb?o.closeCb():angular.noop)})})}var i=this;i.editWithModal=o}return new o}function n(e,o,t){function i(e){n.formIsEditable[e]=!n.formIsEditable[e],n.formIsEditable.controls=n.formIsEditable.amount||n.formIsEditable.goods}var n=this;n.resetForm=function(t){t&&(t.$setPristine(),t.$setUntouched()),n.formIsEditable={goods:!1,amount:!1,controls:!1},n.bid=angular.copy(e),n.formM=angular.copy(o)},n.resetForm(),n.bidAmountGetterSetter=function(e){return e?void(n.bid.amount=Number(e.replace(",",""))):n.bid.amount?t("number")(n.bid.amount,2):""},n.toggleEnableEditForm=i}var r=angular.module("edit-bid",["angularModalService"]);r.factory("EditBid",i),i.$inject=["ModalService"],r.controller("EditBidModalCtrl",n),n.$inject=["bid","formM","$filter"]},function(e,o){e.exports='<div class="bid-edit-modal"><form role="form" name="bidEditForm"><div class="form-group bid-edit-form-m-number"><label class="control-label" for="bid-edit-form-m-number">Form M Number</label> <input class="form-control" ng-model="editBidModal.bid.form_m_number" id="bid-edit-form-m-number" disabled=""></div><div class="form-group customer-name-group"><label class="control-label" for="bid-edit-customer-name">Customer Name</label> <input class="form-control" type="text" id="bid-edit-customer-name" ng-model="editBidModal.bid.applicant" disabled=""></div><div class="form-group amount-group"><label class="control-label" for="bid-edit-form-m-amount">Form M Amount</label><div class="input-group"><span class="input-group-addon">{$editBidModal.formM.currency_data.code$}</span> <input class="form-control" id="bid-edit-form-m-amount" ng-model="editBidModal.formM.amount" disabled="" number-format=""></div></div><div class="form-group goods-description-group"><label class="control-label" for="bid-edit-goods-description">Goods Description</label><div class="input-group"><input class="form-control" type="text" id="bid-edit-goods-description" ng-disabled="!editBidModal.formIsEditable.goods" ng-model="editBidModal.bid.goods_description"> <span class="input-group-addon" style="cursor:pointer;" ng-click="editBidModal.toggleEnableEditForm(\'goods\')"><span class="glyphicon glyphicon-pencil"></span></span></div></div><div class="form-group bid-amount-group"><label class="control-label" for="bid-edit-bid-amount">Bid Amount</label><div class="input-group"><span class="input-group-addon">{$editBidModal.formM.currency_data.code$}</span> <input type="text" class="form-control" id="bid-edit-bid-amount" required="" ng-disabled="!editBidModal.formIsEditable.amount" ng-model="editBidModal.bidAmountGetterSetter" ng-model-options="{getterSetter: true, updateOn: \'blur\'}"> <span class="input-group-addon" style="cursor:pointer;" ng-click="editBidModal.toggleEnableEditForm(\'amount\')"><span class="glyphicon glyphicon-pencil"></span></span></div></div><div class="edit-bid-form-control" ng-show="editBidModal.formIsEditable.controls"><button type="submit" class="btn btn-info" ng-disabled="bidEditForm.$invalid">Edit</button> <button type="button" class="btn btn-default" ng-click="editBidModal.resetForm(bidEditForm)">Reset</button></div></form></div>'},function(e,o,t){"use strict";function i(e,o,i,n,r,s){function a(t){function i(e){s.resolve(e)}function n(e){o(e),s.reject(e)}var s=r.defer(),a=angular.copy(t);return a.applicant&&(a.applicant=a.applicant.name),a.currency&&(a.currency=a.currency.code),e.getPaginated(a).$promise.then(i,n),s.promise}function l(){function e(e){var o=r.defer();return e=e||{},i.showModal({templateUrl:t(5).buildUrl("form-m/search-form-m-service/search-form-m-modal.html"),controller:"SearchFormMServiceModalCtrl as searchFormMModal",inputs:{uiOptions:e.uiOptions}}).then(function(t){t.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,title:"Search Form M",open:function(){e.dim&&s.dim(e.parent,e.dimCb)},close:function(){e.dim&&s.unDim(e.parent,e.unDimCb)}}),t.close.then(function(t){t&&angular.isObject(t)&&!n.isEmpty(t)&&o.resolve(a(t)),e.dim&&s.unDim(e.parent,e.unDimCb)})}),o.promise}var o=this;o.searchWithModal=e}return new l}function n(e,o,t,i,n,r){function s(){c.searchParams={},c.showLcIssueContainer=!1,c.searchLcIssuesTitle="Search By Letter Of Credit Issues",c.selectedLcIssues={}}function a(){c.showLcIssueContainer=!c.showLcIssueContainer,c.searchLcIssuesTitle=c.showLcIssueContainer?"Dismiss":"Search By Letter Of Credit Issues"}function l(e){t(e,i,".form-control",s),e.$invalid=!1,e.$error={}}function d(e){o(e)}var c=this;c.displayLcIssueUI=!1,e&&(c.displayLcIssueUI=e.displayLcIssueUI),s(),c.toggleShowLcIssueContainer=a,c.close=o,c.reset=l,c.submitSearchParams=d,c.getApplicant=n,c.getCurrency=r}var r=angular.module("form-m-search-service",["kanmii-underscore","toggle-dim-element"]);r.factory("SearchFormMService",i),i.$inject=["FormM","xhrErrorDisplay","ModalService","kanmiiUnderscore","$q","ToggleDimElement"],r.controller("SearchFormMServiceModalCtrl",n),n.$inject=["uiOptions","close","resetForm","$element","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o,t){"use strict";function i(e,o){return{restrict:"A",link:function(i,n,r,s){n.css({cursor:"pointer"}).bind("click",function(){e.showModal({template:t(14),controller:"SearchFormMModalCtrl as searchFormMModal"}).then(function(e){e.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,title:"Search Form M"}),e.close.then(function(e){e&&angular.isObject(e)&&!o.isEmpty(e)&&s.searchFormM(e)})})})},controller:"SearchFormMDirectiveCtrl as searchFormM",scope:{},bindToController:{searchFormMResult:"="}}}function n(e,o){function t(t){function n(e){i.searchFormMResult=e}function r(e){o(e)}var s=angular.copy(t);s.applicant&&(s.applicant=s.applicant.name),s.currency&&(s.currency=s.currency.code),e.getPaginated(s).$promise.then(n,r)}var i=this;i.searchFormM=t}function r(e,o,t,i,n){function r(){d.searchParams={},d.showLcIssueContainer=!1,d.searchLcIssuesTitle="Search By Letter Of Credit Issues",d.selectedLcIssues={}}function s(){d.showLcIssueContainer=!d.showLcIssueContainer,d.searchLcIssuesTitle=d.showLcIssueContainer?"Dismiss":"Search By Letter Of Credit Issues"}function a(e){o(e,t,".form-control",r),e.$invalid=!1,e.$error={}}function l(o){e(o)}var d=this;r(),d.toggleShowLcIssueContainer=s,d.close=e,d.reset=a,d.submitSearchParams=l,d.getApplicant=i,d.getCurrency=n}var s=angular.module("form-m-search",["kanmii-underscore"]);s.directive("searchFormM",i),i.$inject=["ModalService","kanmiiUnderscore"],s.controller("SearchFormMDirectiveCtrl",n),n.$inject=["FormM","xhrErrorDisplay"],s.controller("SearchFormMModalCtrl",r),r.$inject=["close","resetForm","$element","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o){e.exports='<div id="search-form-m-root-container" class="search-form-m-root-container"><form novalidate="" class="form-horizontal" ng-submit="searchFormMModal.submitSearchParams(searchFormMModal.searchParams)" name="searchFormMModalForm"><fieldset class="search-form-m-container" style="position: relative; padding: 7px;"><div class="form-group form-m-number-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="form-m-number">Form M Number</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" maxlength="13" id="form-m-number" min="0" ng-pattern="/(?:mf)?\\d{4,11}/i" ng-model="searchFormMModal.searchParams.number"></div></div><div class="form-group applicant-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="applicant">Applicant</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" type="text" min="3" id="applicant" ng-model="searchFormMModal.searchParams.applicant" typeahead-min-length="3" typeahead="applicant as applicant.name for applicant in searchFormMModal.getApplicant($viewValue)"></div></div><div class="form-group currency-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="currency">Currency</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="currency" maxlength="3" ng-model="searchFormMModal.searchParams.currency" typeahead="currency as currency.code for currency in searchFormMModal.getCurrency($viewValue)" typeahead-min-length="2"></div></div><div class="form-group amount-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="amount">Amount</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="amount" min="0" ng-model="searchFormMModal.searchParams.amount" number-format="" ng-pattern="/^\\d[\\d,]*(?:\\.\\d*)?$/"></div></div></fieldset><div class="form-m-lc-issue-container"><span ng-click="searchFormMModal.toggleShowLcIssueContainer()" class="form-m-lc-issue-toggle-show"><span ng-class="[\'glyphicon\', {\'glyphicon-chevron-down\': !searchFormMModal.showLcIssueContainer, \'glyphicon-chevron-up\': searchFormMModal.showLcIssueContainer}]"></span> {$searchFormMModal.searchLcIssuesTitle$}</span><div class="form-m-search-lc-issue" ng-show="searchFormMModal.showLcIssueContainer"><lc-issue lc-issue-show="searchFormMModal.showLcIssueContainer" lc-issues-selected="searchFormMModal.selectedLcIssues"></lc-issue></div></div><div class="row search-form-m-form-control"><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: left"><span class="btn btn-default" ng-click="searchFormMModal.reset(searchFormMModalForm)">Reset</span></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: center"><button type="submit" class="btn btn-info" ng-disabled="searchFormMModalForm.$invalid">Search Form M</button></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: right"><span class="btn btn-default" ng-click="searchFormMModal.close()">Close</span></div></div></form></div>'},function(e,o,t){"use strict";function i(e){return{restrict:"E",templateUrl:t(5).buildUrl("form-m/lc-issue/lc-issue.html"),link:function(o,t,i,n){o.$watch(function(){return n.show},function(o){n.show=o,o&&!n.lcIssues.length?n.lcIssues=e.query():(t.find(".lc-issue-item-checkbox").each(function(){$(this).prop("checked",!1).closest(".lc-issue-item").removeClass("selected")}),n.selectedIssues={})}),t.on({change:function(){var e=$(this);e.closest(".lc-issue-item").toggleClass("selected",e.prop("checked"))}},".lc-issue-item-checkbox")},scope:{},bindToController:{show:"=lcIssueShow",selectedIssues:"=lcIssuesSelected"},controller:"LcIssueDirectiveCtrl as lcIssue"}}function n(){var e=this;e.lcIssues=[],e.selectedIssues={}}var r=angular.module("form-m-lc-issue",[]);r.directive("lcIssue",i),i.$inject=["LCIssue"],r.controller("LcIssueDirectiveCtrl",n)},function(e,o,t){"use strict";function i(e){e.state("form-m",{url:"/form-m",kanmiiTitle:"Form M",template:t(17),controller:"FormMController as formMHome"})}function n(e,o,t,i){function n(e){a.formMs=e.results,a.paginationHooks={next:e.next,previous:e.previous,count:e.count}}function r(e){e&&(e.highlighted=!0,a.formMs.unshift(e))}function s(e){i.get(e).then(function(e){n(e.data)})}var a=this;a.modelManager=t,a.paginationHooks=[],a.formMs=[],e.getNoLcAttached().$promise.then(function(e){n(e)}),a.newFormM=null,a.receiveNewFormM=r,a.tableCaption="Form M (LC Not Established)",a.getFormMCollectionOnNavigation=s,a.searchedFormMResult=null,o.$watch(function(){return a.searchedFormMResult},function(e){e&&n(e)})}var r=t(2),s=angular.module("form-m",["rootApp","ui.router","form-m-service","form-m-search","form-m-lc-issue","model-table","customer"]);s.config(r.interpolateProviderConfig),s.config(i),i.$inject=["$stateProvider"],s.controller("FormMController",n),n.$inject=["FormM","$scope","formMModelManager","$http"],t(18)},function(e,o){e.exports='<div class="form-m-home-view"><div class="action-buttons" style="float: right;"><button class="btn btn-info" name="add-form-m-form-show-trigger" id="add-form-m-form-show-trigger" add-form-m="" on-new-mf="formMHome.receiveNewFormM(newFormM)">Add Form M</button> <button class="btn btn-info" search-form-m="" search-form-m-result="formMHome.searchedFormMResult">Search Form M</button></div><model-table model-collection="formMHome.formMs" table-model-manager="::formMHome.modelManager" table-caption="::formMHome.tableCaption" pagination-size="20" update-collection="formMHome.getFormMCollectionOnNavigation(linkUrl)" pager-object="formMHome.paginationHooks"></model-table></div>'},function(e,o,t){"use strict";function i(e){function o(o,i,n,r){i.css({cursor:"pointer"}).bind("click",function(){e.showModal({template:t(19),controller:"AddFormMModalCtrl as addFormMModal"}).then(function(e){e.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,maxHeight:600,title:"Add Form M"}),e.close.then(function(e){e&&e.submittedFormM&&r.saveFormM(e)})})})}return{restrict:"A",link:o,controller:"AddFormMDirectiveCtrl as addFormM",scope:{},bindToController:{onNewMf:"&"}}}function n(e,o,t,i,n,r,s){function a(n){function r(e){l(e.url),u.goods_description&&d(e.url,f),c.onNewMf({newFormM:e})}function a(e){t(e,s)}var m=n.submittedFormM,u=angular.copy(m);u.applicant=m.applicant.url,u.currency=m.currency.url,u.date_received=e(m.date_received);var f=n.submittedBidRequest;f&&!i.isEmpty(f)&&(u.goods_description=n.submittedBidRequest.goods_description);var p=new o(u);p.$save(r,a)}function l(e){i.each(c.selectedLcIssues,function(o,t){o&&new n({issue:t,mf:e}).$save(function(e){console.log(e)},function(e){console.log(e)})})}function d(e,o){o.mf=e;var i=new r(o);i.$save(function(e){console.log("bid saved successfully with data = ",e)},function(e){t(e)})}var c=this;c.saveFormM=a}function r(e,o,t,i,n){function r(){u.formM={date_received:new Date},u.showLcIssueContainer=!1,u.addLcIssuesTitle="Add Letter Of Credit Issues",u.selectedLcIssues={},u.showBidContainer=!1,u.makeBidTitle="Make Bid Request",u.bidRequest={amount:null}}function s(t){u.showBidContainer=!u.showBidContainer,u.makeBidTitle=u.showBidContainer?"Dismiss":"Make Bid Request",u.showBidContainer?u.bidRequest.amount=u.formM.amount:e(t,o,".bid-request-form-container .form-control")}function a(){u.showLcIssueContainer=!u.showLcIssueContainer,u.addLcIssuesTitle=u.showLcIssueContainer?"Dismiss":"Add Letter Of Credit Issues"}function l(e,o){return e?!0:u.showBidContainer&&o?!0:!1}function d(t){u.formM={},e(t,o,".form-control",r)}function c(e,o){t({submittedFormM:e,submittedBidRequest:o})}function m(){u.datePickerIsOpen=!0}var u=this;u.element=o,r(),u.toggleShowBidContainer=s,u.toggleShowLcIssueContainer=a,u.disableSubmitBtn=l,u.close=t,u.reset=d,u.submitFormM=c,u.getApplicant=i,u.getCurrency=n,u.datePickerFormat="dd-MMMM-yyyy",u.datePickerIsOpen=!1,u.openDatePicker=m}var s=angular.module("form-m");s.directive("addFormM",i),i.$inject=["ModalService"],s.controller("AddFormMDirectiveCtrl",n),n.$inject=["formatDate","FormM","xhrErrorDisplay","kanmiiUnderscore","LCIssueConcrete","LcBidRequest","formMAttributesVerboseNames"],s.controller("AddFormMModalCtrl",r),r.$inject=["resetForm","$element","close","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o){e.exports='<div id="add-form-m-root-container" class="add-form-m-root-container"><form novalidate="" class="form-horizontal" role="form" ng-submit="addFormMModal.submitFormM(addFormMModal.formM, addFormMModal.bidRequest)" name="addFormMModalForm"><fieldset class="add-new-form-m-container" ng-form="" name="newFormMModalForm" style="position: relative;padding: 7px;"><div class="form-group form-m-number-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="form-m-number">Form M Number</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" maxlength="13" id="form-m-number" required="" name="form-m-number" to-upper="" ng-pattern="/mf\\d{11}/i" ng-model="addFormMModal.formM.number"></div></div><div class="form-group applicant-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="applicant">Applicant</label><div class="col-md-8 col-lg-8 col-sm-8"><div class="input-group"><input class="form-control" type="text" min="3" id="applicant" name="applicant" ng-model="addFormMModal.formM.applicant" ng-pattern="/.{4,}/" typeahead-min-length="3" typeahead="applicant as applicant.name for applicant in addFormMModal.getApplicant($viewValue)"> <span class="input-group-addon"><img ng-src="{$$root.addIconSrc$}" alt="" add-customer="" dim-parent="addFormMModal.element" added-new-customer="addFormMModal.formM.applicant"></span></div></div></div><div class="form-group currency-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="currency">Currency</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="currency" required="" maxlength="3" name="currency" ng-model="addFormMModal.formM.currency" typeahead="currency as currency.code for currency in addFormMModal.getCurrency($viewValue)" typeahead-min-length="2"></div></div><div class="form-group amount-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="amount">Amount</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="amount" name="amount" required="" ng-model="addFormMModal.formM.amount" number-format=""></div></div><div class="form-group received-date-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="received-date">Date Received</label><div class="col-md-8 col-lg-8 col-sm-8"><div class="input-group"><input class="form-control" id="received-date" required="" ng-model="addFormMModal.formM.date_received" datepicker-popup="{$addFormMModal.datePickerFormat$}" is-open="addFormMModal.datePickerIsOpen"> <span class="input-group-addon" ng-click="addFormMModal.openDatePicker($event)"><i class="glyphicon glyphicon-calendar"></i></span></div></div></div></fieldset><div class="bid-request-form-container"><div ng-click="addFormMModal.toggleShowBidContainer(bidRequestForm)" class="form-m-bid-toggle-show clearfix"><span class="on-show-helper" ng-show="addFormMModal.showBidContainer">Make Bid Request</span><div class="show-icon"><span ng-class="[\'glyphicon\', {\'glyphicon-chevron-down\': !addFormMModal.showBidContainer, \'glyphicon-chevron-up\': addFormMModal.showBidContainer}]"></span> {$addFormMModal.makeBidTitle$}</div></div><fieldset ng-form="" name="bidRequestForm" ng-show="addFormMModal.showBidContainer"><div class="form-group bid-request-goods_description"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="goods-description">Goods Description</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="goods-description" name="goods-description" required="" min="5" ng-model="addFormMModal.bidRequest.goods_description" to-upper=""></div></div><div class="form-group bid-request-amount-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="bid-amount">Amount</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="bid-amount" name="bid-amount" required="" ng-model="addFormMModal.bidRequest.amount" number-format=""></div></div></fieldset></div><div class="form-m-lc-issue-container"><div ng-click="addFormMModal.toggleShowLcIssueContainer()" class="form-m-lc-issue-toggle-show clearfix"><span class="on-show-helper" ng-show="addFormMModal.showLcIssueContainer">Specify LC Request Issues</span><div class="show-icon"><span ng-class="[\'glyphicon\', {\'glyphicon-chevron-down\': !addFormMModal.showLcIssueContainer, \'glyphicon-chevron-up\': addFormMModal.showLcIssueContainer}]"></span> {$addFormMModal.addLcIssuesTitle$}</div></div><div class="form-m-add-lc-issue" ng-show="addFormMModal.showLcIssueContainer"><lc-issue lc-issue-show="addFormMModal.showLcIssueContainer" lc-issues-selected="addFormMModal.selectedLcIssues"></lc-issue></div></div><div class="row add-form-m-form-control"><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: left"><span class="btn btn-default" ng-click="addFormMModal.reset(addFormMModalForm)">Reset</span></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: center"><button type="submit" class="btn btn-info" name="add-form-m-submit" ng-disabled="addFormMModal.disableSubmitBtn(newFormMModalForm.$invalid, bidRequestForm.$invalid)">Add Form M</button></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: right"><span class="btn btn-default" ng-click="addFormMModal.close()">Close</span></div></div></form></div>';
},function(e,o){e.exports='<div class="form-m-home-view"><div class="form-m-home-action-buttons btn-group-vertical" role="group"><a class="btn btn-info form-m-home-action-button" ui-sref="form-m">Form M</a> <a class="btn btn-info form-m-home-action-button" ui-sref="bid">Bid Request</a></div></div>'}]);
//# sourceMappingURL=form-m.app.min.js.map