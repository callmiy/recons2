$(function(){"use strict";function e(e){return e.size()?t(e.parent(),"div[id^=AUTOGENBOOKMARK_]:contains(Operator:)",!0):""}function t(e,t,i){var r=e.find(t).parent().next().children("div");return i?n(r.html()):r}function n(e){return e.trim().replace(/<br>/gi,"\n").replace(/&nbsp;/gi," ")}function i(e){var t=new RegExp("F32A: Value Date, Currency Code, Amount[.\\s]*Date:\\s+\\d+\\s+(\\d{4}\\s+[a-zA-Z]+\\s+\\d+)[.\\s]*Currency:\\s+([A-Z]{3})\\s+.+\\s*Amount:\\s+([\\d,]+)\\s+.+\\s*F53B: Sender's Correspondent(?: - Party Identifier - Location)?\\s*Party Identifier:\\s+/(.+)\\s*F57A: Account With Institution - Party Identifier - Identifier Code\\s*Party Identifier:\\s*/(.+)\\s*Identifier Code:\\s*(.+)\\s*[\\s\\S]+Narrative[\\s\\S]+?((?:\\d+/)?\\d{3,})"),n=t.exec(e);return n?{date:n[1],ccy:n[2],amount:n[3].replace(",","."),debitAcct:n[4],beneAcct:n[5],beneBank:n[6],dealNo:n[7]}:{}}function r(e){var t=new RegExp("F32A: Value Date, Currency Code, Amount[.\\s]*Date:\\s+\\d+\\s+(\\d{4}\\s+[a-zA-Z]+\\s+\\d+)[.\\s]*Currency:\\s+([A-Z]{3})\\s+.+\\s*Amount:\\s+([\\d,]+)\\s+.+\\s*F53B: Sender's Correspondent - Party Identifier - Location\\s*Party Identifier:\\s+/(.+)\\s*(?:F56A: Intermediary - Party Identifier - Identifier Code\\s+Identifier Code:\\s+(\\S+)\\s+)?[\\s\\S]+?F57A: Account With Institution - Party Identifier - Identifier Code\\s*(?:Party Identifier:\\s*/(.+))?[\\s\\S]+?Identifier Code:\\s*(.+)\\s*[\\s\\S]+F58A: Beneficiary Institution - Party Identifier - Identifier Code\\s+(?:Party Identifier:\\s*/(\\S+))?[\\s\\S]+?Identifier Code:\\s*(.+)\\s*[\\s\\S]+Narrative[\\s\\S]+?((?:\\d+/)?\\d{3,})"),n=t.exec(e);return n?{date:n[1],ccy:n[2],amount:n[3].replace(",","."),debitAcct:n[4],intermediary:n[5],acctWithAcct:n[6],acctWithBank:n[7],beneAcct:n[8],beneBank:n[9],dealNo:n[10]}:{}}var s=document.getElementById("process-swift"),a=$("#swift-messages"),o=$("#swift-messages-20");$("#process-swift-form").submit(function(c){c.preventDefault(),a.hide().val("");var d=s.files[0];if(d){var u=new FileReader;u.readAsText(d),u.onload=function(s){for(var c,d=$(s.target.result.trim()),u=0;u<d.size()&&(c=$(d[u]),!c.is("table"));u++)c=null;if(!c)return void window.alert("No table selector found, exiting...");var f=["div:contains(F20: Transaction Reference Number)","div:contains(F20: Sender's Reference)","div:contains(F20: Documentary Credit Number)"].join(","),A="",l="Message type\tOur ref\tTheir ref\tDelivery Status\tAck Time\tValue Date\tCurrency\tAmount\tDebit Bank\tDebit A/C\tIntermediary\tAccount With Institution Bank\tAccount With Institution AC\tBeneficiary Institution Bank\tBeneficiary Institution A/C\tDeal No.\n";c.find("div[id^=AUTOGENBOOKMARK_]:contains(Start of Message)").each(function(){var s=$(this).parent(),a=s.find("div:contains(fin.)").text(),o=t(s,"div[id^=AUTOGENBOOKMARK_]:contains(Receiver Institution)"),c=o.text(),d=t(s,"div[id^=AUTOGENBOOKMARK_]:contains(Transaction Reference:)",!0),u=t(s,"div[id^=AUTOGENBOOKMARK_]:contains(Related Reference:)"),v=u.size()?n(u.text()):"",y=t(s,"div[id^=AUTOGENBOOKMARK_]:contains(ACK/NAK Reception Date/Time (GMT):)"),m=y.size()?new Date(n(y.text()).replace(/\//g,"-")):null,I=n(s.find(f).html()),p=s.find("td>div:contains(Routed from rp [_MP_authorisation] to rp [_SI_to_SWIFT]; On Processing by Function mpa with result Success;)").eq(0),b=e(p),h=s.find("td>div:contains(Routed from rp [_MP_verification] to rp [_MP_authorisation]; On Processing by Function mpa with result Success;)"),O=h.size(),B=O?e(h.eq(O-1)):"",C=s.find("td>div:contains(Routed from rp [_MP_creation] to rp [_MP_verification]; On Processing by Function mpc with result Success;)"),S=C.size(),R=S?e(C.eq(S-1)):"",_=t(s,"div[id^=AUTOGENBOOKMARK_]:contains(Network Delivery Status:)"),P=_.size()?n(_.text()):"Message has not been authorized";if(A+=a+"\n"+c+"\n"+d+"\n"+v+"\n\n"+I+"\n\nInput by:\t         "+R+"\nVerified by:\t  "+B+"\nAuthorized by:\t  "+b+"\nAuthorization completed at:\t"+m+"\nDelivery status:\t"+P+"\n================================================\n\n\n\n","fin.200x"===a||"fin.202x"===a){var N="fin.200"===a?i(I):r(I),g=["date","ccy","amount","debitBank","debitAcct","intermediary","acctWithBank","acctWithAcct","beneBank","beneAcct","dealNo"],M="";g.forEach(function(e){M+="debitBank"===e?c:(N[e]||"").trim(),M+="\t"}),m=m?m.toString().replace(/:\d+\s*GMT.+/,""):"",l+=a+"\t"+d+"\t"+v+"\t"+P+"\t"+m+"\t"+M+"\n"}}),a.show().val(A),o.show().val(l)}}})});
//# sourceMappingURL=process_swift.min.js.map
