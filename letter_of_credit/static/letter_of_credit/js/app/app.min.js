!function(e){function o(r){if(t[r])return t[r].exports;var n=t[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}var t={};return o.m=e,o.c=t,o.p="",o(0)}([function(e,o,t){"use strict";function r(e,o){o.otherwise("/"),e.state("home",{url:"/",kanmiiTitle:"Home",template:t(27)})}t(1),t(24);var n=t(7),i=angular.module("lc-root-app",["rootApp","ui.router","form-m","lc"]);i.config(n.interpolateProviderConfig),i.run(["$rootScope","$state","$stateParams",function(e,o,t){e.$state=o,e.$stateParams=t}]),i.config(r),r.$inject=["$stateProvider","$urlRouterProvider"]},function(e,o,t){"use strict";function r(e){e.state("form_m",{url:"/form-m",kanmiiTitle:"Form M",template:t(23),controller:"FormMController as formMHome"})}function n(e,o){var t={title:"List Form M",viewName:"listFormM",select:function(){o.updateAddFormMTitle(),e.go("form_m.list")}},r="Form M",n=!0,i={title:r,active:!0,viewName:"addFormM",select:function(){n&&e.go("form_m.add"),n=!0}},s={title:"Reports",active:!1,viewName:"formMReports",select:function(){o.updateAddFormMTitle(),e.go("form_m.add")}},c={title:"Pending Bids",active:!1,viewName:"bids",select:function(){o.updateAddFormMTitle(),e.go("form_m.bids")}},a={title:"Upload Form M",active:!1,viewName:"uploadFormM",select:function(){o.updateAddFormMTitle(),e.go("form_m.upload")}};o.tabs={uploadFormM:a,listFormM:t,addFormM:i,bids:c,reports:s},o.updateAddFormMTitle=function(e){o.tabs.addFormM.title=e?'Details of "'+e.number+'"':r},o.goToFormM=function(t){n=!1,e.transitionTo("form_m.add",{detailedFormM:t}),o.tabs.addFormM.active=!0}}t(2),t(11),t(14),t(16),t(17),t(18),t(20);var i=angular.module("form-m",["rootApp","ui.router","list-form-m","upload-form-m","add-form-m","form-m-bids"]);i.config(r),r.$inject=["$stateProvider"],i.controller("FormMController",n),n.$inject=["$state","$scope"]},function(e,o,t){"use strict";function r(e){e.state("form_m.add",{kanmiiTitle:"Add form M",params:{detailedFormM:null,showSummary:null},views:{addFormM:{templateUrl:t(5).buildUrl("form-m/add-form-m/add-form-m.html"),controller:"AddFormMStateController as addFormMState"}}})}function n(e,o,t,r,n,i,s,c,a,l,m,d){function u(e){m.init(h.detailedFormM,function(e){h.formM=e,h.formM.number?(a.updateAddFormMTitle(e),h.fieldIsEditable={number:!1,currency:!1,applicant:!1,date_received:!1,amount:!1}):(a.updateAddFormMTitle(),h.fieldIsEditable={number:!0,currency:!0,applicant:!0,date_received:!0,amount:!0})}),h.searchFormM={},f(),e&&(e.$setPristine(),e.$setUntouched())}function f(){var e=i.showSummary;i.showSummary=null,e&&l.showDialog({title:'"'+h.formM.number+'" successfully saved',text:e,infoOnly:!0})}function p(e){h.detailedFormM=null,s(e,[{form:a.newFormMForm,elements:["applicant","currency"]}]),u()}var h=this;h.detailedFormM=angular.copy(i.detailedFormM),i.detailedFormM=null,u(),h.enableFieldEdit=function(e){h.fieldIsEditable[e]=h.detailedFormM?!h.fieldIsEditable[e]:!1},h.validators={applicant:{test:function(){return r.isObject(h.formM.applicant)}},currency:{test:function(){return r.isObject(h.formM.currency)}}},h.disableSubmitBtn=function(){if(a.newFormMForm.$invalid)return!0;if(r.has(h.formM.coverForm,"$invalid")&&h.formM.coverForm.$invalid)return!0;if(r.has(h.formM.bidForm,"$invalid")&&h.formM.bidForm.$invalid)return!0;if(r.has(h.formM.issuesForm,"$invalid")&&h.formM.issuesForm.$invalid)return!0;if(r.has(h.formM.commentForm,"$invalid")&&h.formM.commentForm.$invalid)return!0;if(m.showEditBid||m.showCommentForm)return!0;var e=m.compareFormMs(h.detailedFormM);return e&&r.all(e)?m.bid.goods_description&&m.bid.amount?!1:r.isEmpty(h.formM.cover)?!h.formM.selectedIssues.length:!1:!1},h.reset=p,h.getApplicant=e,h.getCurrency=o,h.datePickerFormat="dd-MMM-yyyy",h.datePickerIsOpen=!1,h.openDatePicker=function(){h.datePickerIsOpen=!0},h.getUploadedFormM=function(){h.detailedFormM=null,u(),t.searchWithModal().then(function(e){if(e.detailed)h.detailedFormM=e.detailed,u();else{var t=e.uploaded;h.searchFormM=t,h.formM.number=t.mf,h.formM.amount=t.cost_freight,h.formM.goods_description=t.goods_description,o(t.ccy).then(function(e){h.formM.currency=e[0]})}})},h.submit=function(e){m.saveFormM(e,h.detailedFormM).then(function(e){c.go("form_m.add",e)},function(e){n(e,d)})}}t(3),t(4),t(8),t(9),t(10);var i=angular.module("add-form-m",["ui.router","rootApp","kanmii-underscore","customer","search-detailed-or-uploaded-form-m","form-m-service","lc-cover","lc-issue","lc-bid","form-m-comment","lc-bid-request","confirmation-dialog","add-form-m-form-m-object"]);i.config(r),r.$inject=["$stateProvider"],i.controller("AddFormMStateController",n),n.$inject=["getTypeAheadCustomer","getTypeAheadCurrency","SearchDetailedOrUploadedFormMService","kanmiiUnderscore","xhrErrorDisplay","$stateParams","resetForm2","$state","$scope","confirmationDialog","formMObject","formMAttributesVerboseNames"]},function(e,o){"use strict";function t(e,o,t,r,n,i,s,c,a,l,m,d){function u(){function u(){e.getPaginated({mf:g.number}).$promise.then(function(e){if(e.count){var o=e.results;o.length&&(g.existingBids=o)}},function(e){console.log("xhr = ",e)})}function f(e){d.query({ct:g.ct_id,pk:e,not_deleted:!0}).$promise.then(function(e){g.comments=e},function(e){console.log("xhr = ",e)})}function p(){o.query({form_m_number:g.number}).$promise.then(function(e){e.forEach(function(e){e.closed_at?g.closedIssues.push(e):g.nonClosedIssues.push(e)})})}function h(){t.query({form_m_number:g.number}).$promise.then(function(e){g.covers=e},function(e){console.log(e)})}var g=this,v=40;g.init=function(e,o){function t(){g.bid={},g.showEditBid=!1,g.showBidForm=!1,g.existingBids=[],g.closedIssues=[],g.commentText=null,g.showEditComment=!1,g.showCommentForm=!1,g.comments=[],g.nonClosedIssues=[],g.selectedIssues=[],g.issue=null,g.showIssueForm=!1,g.covers=[],g.cover={},g.showCoverForm=!1,g.date_received=new Date,g.number=null,g.applicant=null,g.currency=null,g.amount=null,g.goods_description=null,g.form_m_issues=null,g.url=null,g.ct_id=null}t(),e&&(g.date_received=new Date(e.date_received),g.number=e.number,g.applicant=e.applicant_data,g.currency=e.currency_data,g.amount=Number(e.amount),g.goods_description=e.goods_description,g.form_m_issues=e.form_m_issues,g.url=e.url,g.ct_id=e.ct_id,g.ct_url=e.ct_url,g._id=e.id,u(),p(),h(),f(g._id)),o(g)},g.formatIssueText=function(e){return e.replace(/:ISSUE$/i,"")},g.closeIssue=function(e,t){function s(){var o="Issue closed successfully:\n"+g.formatIssueText(e.issue_text);r.showDialog({title:"Close issue",text:o,infoOnly:!0}),g.nonClosedIssues.splice(t,1),g.closedIssues.push(e)}function c(e){i(e)}var a='Sure you want to close issue:\n"'+g.formatIssueText(e.issue_text)+'"?';r.showDialog({title:"Close issue",text:a}).then(function(t){t&&(e.closed_at=n(new Date),o.put(e).$promise.then(s,c))})},g.createIssuesMessage=function(e){if(e=g.nonClosedIssues.concat(e&&e.length?e:[]),!e.length)return"";var o="\n\n\nPlease note the following issues which must be regularized before the LC request can be treated:\n";return s.each(e,function(e,t){++t,o+="("+t+") "+g.formatIssueText(e.issue_text)+"\n"}),o},g.createFormMMessage=function(){var e=c("number")(g.amount,2),o=g.applicant.name+" - "+g.number+" - "+g.currency.code+" "+e;return o+"\n\nForm M Number : "+g.number+"\nValue         : "+g.currency.code+" "+e+"\nApplicant     : "+g.applicant.name},g.showSummary=function(){r.showDialog({title:g.number,text:g.createFormMMessage()+g.createIssuesMessage(),infoOnly:!0})},g.getFreshIssues=function(e){var o=[];g.selectedIssues.forEach(function(e){o.push(e.id)});var t=[],r=new RegExp(".+/(\\d+)$");return t.concat(g.nonClosedIssues).concat(g.closedIssues).forEach(function(e){o.push(r.exec(e.issue)[1])}),a({text:e,exclude_issue_ids:o.join(",")})},g.saveFormM=function(e,o){function t(e){var o=g.createFormMMessage()+g.createIssuesMessage(e.new_issues);i.bid&&(o+="\n\nBid Amount     : "+e.currency_data.code+" "+c("number")(i.bid.amount,2)),delete e.new_issues,a.resolve({detailedFormM:e,showSummary:o})}function r(e){a.reject(e)}var i={applicant:e.applicant.url,currency:e.currency.url,date_received:n(e.date_received),amount:e.amount,number:e.number,goods_description:e.goods_description};e.bid.amount&&e.bid.goods_description&&(i.goods_description=e.bid.goods_description,i.bid={amount:Number(e.bid.amount)},g.goods_description=e.bid.goods_description,e.goods_description=e.bid.goods_description),e.selectedIssues.length&&(i.issues=e.selectedIssues),s.isEmpty(e.cover)||(i.cover={amount:e.cover.amount,cover_type:e.cover.cover_type[0]});var a=m.defer();return o?(s.all(g.compareFormMs(o,e))&&(i.do_not_update="do_not_update",i.applicant_data=e.applicant,i.currency_data=e.currency,i.url=e.url),i.id=o.id,new l(i).$put(t,r)):new l(i).$save(t,r),a.promise},g.compareFormMs=function(e,o){return e?o?{number:o.number&&angular.equals(o.number,e.number),date_received:angular.equals(o.date_received,new Date(e.date_received)),amount:o.amount&&angular.equals(o.amount,Number(e.amount)),currency:o.currency&&o.currency.code===e.currency_data.code,applicant:o.applicant&&o.applicant.name===e.applicant_data.name,goods_description:o.goods_description===e.goods_description}:{number:g.number&&angular.equals(g.number,e.number),date_received:angular.equals(g.date_received,new Date(e.date_received)),amount:g.amount&&angular.equals(g.amount,Number(e.amount)),currency:g.currency&&g.currency.code===e.currency_data.code,applicant:g.applicant&&g.applicant.name===e.applicant_data.name,goods_description:g.goods_description===e.goods_description}:!1},g.addComment=function(e){var o=m.defer();return d.save({content_type:g.ct_url,object_id:g._id,text:e}).$promise.then(function(e){var t=e.text;r.showDialog({title:'Comment successfully created "'+t.slice(0,v)+'"',text:t,infoOnly:!0}),g.comments.push(e),o.resolve(e)},function(e){i(e)}),o.promise},g.closeComment=function(e){var o=m.defer(),t=e.text;return r.showDialog({title:'Close comment "'+t.slice(0,v)+'"',text:"Sure you want to close comment:\n===============================\n"+t}).then(function(n){n&&(e.deleted_at=(new Date).toJSON(),d.put(e).$promise.then(function(e){r.showDialog({title:'Comment successfully closed "'+t.slice(0,v)+'"',text:t,infoOnly:!0}),o.resolve(e);var n=[];g.comments.forEach(function(o){o.id!==e.id&&n.push(o)}),g.comments=n},function(e){i(e)}))}),o.promise},g.editComment=function(e,o){var t=m.defer();return r.showDialog({title:'Edit comment "'+o.text.slice(0,v)+'"',text:"Are you sure you want to edit comment:\n======================================\n"+o.text}).then(function(n){n&&(o.text=e,d.put(o).$promise.then(function(o){r.showDialog({title:'Comment successfully changed "'+e.slice(0,v)+'"',text:e,infoOnly:!0}),t.resolve(o);for(var n=angular.copy(g.comments),i=0,s=n.length;s>i;i++)if(o.id===n[i].id){n[i]=o;break}g.comments=n},function(e){i(e)}))}),t.promise}}return new u}var r=angular.module("add-form-m-form-m-object",["rootApp","lc-issue-service","lc-cover-service","form-m-service","comment-service"]);r.factory("formMObject",t),t.$inject=["LcBidRequest","LCIssueConcrete","FormMCover","confirmationDialog","formatDate","xhrErrorDisplay","kanmiiUnderscore","$filter","getTypeAheadLCIssue","FormM","$q","Comment"]},function(e,o,t){"use strict";function r(){return{restrict:"A",templateUrl:t(5).buildUrl("form-m/add-form-m/lc-issue/lc-issue.html"),scope:!0,bindToController:{onIssuesChanged:"&"},controller:"LcIssueDirectiveController as lcIssue"}}function n(e,o,t,r){function n(e){i.title=s,r.selectedIssues=[],r.issue=null,e&&o(e,[{form:e,elements:["issue"]}])}var i=this;i.formM=r;var s="Add Letter Of Credit Issues";n(),i.issueSelected=function(o,n){r.selectedIssues.push(n),r.issue=null,t(e.issuesForm,"issue")},i.deleteIssue=function(e){i.formM.selectedIssues.splice(e,1)},i.toggleShow=function(e){r.showIssueForm=i.formM.amount&&i.formM.number&&!r.showIssueForm,r.showIssueForm?i.title="Dismiss":n(e)},e.$watch(function(){return i.formM},function(o){i.formM.issuesForm=e.issuesForm,o&&(o.amount&&o.number||n(r.issueForm))},!0),e.$watch(function(){return r.showIssueForm},function(){e.issuesForm.issue.$validate()})}var i=angular.module("lc-issue",["rootApp","add-form-m-form-m-object"]);i.directive("lcIssue",r),r.$inject=[],i.controller("LcIssueDirectiveController",n),n.$inject=["$scope","resetForm2","clearFormField","formMObject"],i.directive("validateIssues",function(){return{restrict:"A",require:"ngModel",link:function(e,o,t,r){var n=e.lcIssue;r.$validators.issues=function(){return!n.formM.showIssueForm||Boolean(n.formM.selectedIssues.length)}}}})},function(e,o,t){"use strict";function r(e){return n.buildUrl("app")+"/"+e}var n=t(6);e.exports={buildUrl:r}},function(e,o,t){"use strict";function r(e){return n.buildUrl(i,e)}var n=t(7),i="letter_of_credit";e.exports={buildUrl:r,appName:i}},function(e,o){"use strict";function t(e,o){return staticPrefix+e+"/js/"+o}function r(e){e.run(["$rootScope",function(e){e.staticPrefix=staticPrefix,e.addIconSrc=staticPrefix+"core_recons/css/images/icon_addposting.gif"}])}var n=["$interpolateProvider",function(e){e.startSymbol("{$"),e.endSymbol("$}")}];e.exports={interpolateProviderConfig:n,buildUrl:t,rootAppName:"core_recons",setStaticPrefix:r}},function(e,o,t){"use strict";function r(){return{restrict:"A",templateUrl:t(5).buildUrl("form-m/add-form-m/lc-cover/lc-cover.html"),scope:!0,bindToController:{formM:"=mfContext",cover:"=",onCoverChanged:"&"},controller:"LcCoverDirectiveController as lcCover"}}function n(e,o,t,r,n){function i(e){s.title=c,s.coverTypes=null,e&&(e.$setPristine(),e.$setUntouched())}var s=this;s.formM=n;var c="Register Cover";i(),s.isValid=function(o,t){return r(e,"coverForm",o,t)},s.amountGetterSetter=function(e){return arguments.length?void(n.cover.amount=/[\d,\.]+/.test(e)?Number(e.replace(/,/g,"")):null):n.cover.amount?t("number")(n.cover.amount,2):""},s.toggleShow=function(e){n.showCoverForm=s.formM.amount&&s.formM.number&&!n.showCoverForm,n.showCoverForm?(s.title="Dismiss",s.coverTypes=o,n.cover.amount=s.formM.amount):i(e)},e.$watch(function(){return s.formM},function(o){n.coverForm=e.coverForm,o&&(o.amount&&o.number||i(n.coverForm))},!0)}var i=angular.module("lc-cover",["rootApp","add-form-m-form-m-object"]);i.directive("lcCover",r),r.$inject=[],i.controller("LcCoverDirectiveController",n),n.$inject=["$scope","formMCoverTypes","$filter","formFieldIsValid","formMObject"]},function(e,o,t){"use strict";function r(){return{restrict:"A",templateUrl:t(5).buildUrl("form-m/add-form-m/lc-bid/lc-bid.html"),scope:!0,controller:"LcBidDirectiveController as lcBid"}}function n(e,o,t,r,n,i,s,c,a){function l(e){d.title=u,d.formM.showBidForm=!1,d.formM.showEditBid=!1,d.bidToEdit=null,c.bid={},e&&a(e)}function m(){return{amount:d.bidToEdit.amount===c.bid.amount,goods_description:d.bidToEdit.goods_description===c.bid.goods_description}}var d=this;d.formM=c;var u="Make Bid Request";l(),d.isValid=function(o,r){return t(e,"bidForm",o,r)},d.amountGetterSetter=function(e){return arguments.length?void(d.formM.bid.amount=/[\d,\.]+/.test(e)?Number(e.replace(/,/g,"")):null):d.formM.bid.amount?o("number")(d.formM.bid.amount,2):null},d.toggleShow=function(e){d.formM.showBidForm=d.formM.amount&&d.formM.number&&!d.formM.showBidForm,d.formM.showBidForm?(d.title="Dismiss",c.bid.goods_description=c.goods_description,d.formM.bid.amount=d.formM.existingBids.length?null:c.amount):l(e)},d.editBidInvalid=function(e){return r.isEmpty(d.bidToEdit)?!0:e.$invalid?!0:r.all(m())},d.onBidDblClick=function(e,o){d.formM.showEditBid=!0,d.formM.showBidForm=!1,d.toggleShow(),d.bidToEdit=angular.copy(e),d.bidToEdit.amount=Number(d.bidToEdit.amount),d.bidToEdit.$index=o,d.formM.bid.amount=d.bidToEdit.amount},d.trashBid=function(e,t){function r(){s.showDialog({text:"Bid delete successfully:"+c,title:"Bid for "+a+" deleted successfully",infoOnly:!0}),d.formM.existingBids.splice(t,1)}var c="\n\nApplicant: "+e.applicant+"\nForm M: "+e.form_m_number+"\nBid Amount: "+e.currency+" "+o("number")(e.amount,2),a='"'+e.form_m_number+'"';s.showDialog({text:"Sure you want to delete bid:"+c,title:"Delete bid for "+a}).then(function(o){o&&n["delete"](e).$promise.then(r,function(e){i(e)})})},d.editBid=function(){function e(){var e=angular.copy(d.bidToEdit);e.amount=d.formM.bid.amount,e.goods_description=c.bid.goods_description,e.requested_at=null,n.put(e).$promise.then(function(){s.showDialog({title:t,text:"Edit successful: "+a,infoOnly:!0}),d.formM.existingBids.splice(e.$index,1,e),l()},function(e){i(e)})}var t='Edit bid "'+d.bidToEdit.form_m_number+'"',r=c.currency.code,a="\n\nForm M:           "+d.bidToEdit.form_m_number+"\nBid Amount\n  before edit:    "+r+o("number")(d.bidToEdit.amount,2)+"\n  after edit:     "+r+o("number")(d.formM.bid.amount,2)+"\nGoods description\n  before edit:    "+d.bidToEdit.goods_description+"\n\n  after edit:     "+d.formM.bid.goods_description;s.showDialog({title:t,text:"Are you sure you want to edit Bid:"+a}).then(function(o){o&&e()})},e.$watch(function(){return c},function(o){c.bidForm=e.bidForm,o&&(o.amount&&o.number||l(c.bidForm))},!0)}var i=angular.module("lc-bid",[]);i.directive("lcBid",r),r.$inject=[],i.controller("LcBidDirectiveController",n),n.$inject=["$scope","$filter","formFieldIsValid","kanmiiUnderscore","LcBidRequest","xhrErrorDisplay","confirmationDialog","formMObject","resetForm2"]},function(e,o,t){"use strict";function r(){return{restrict:"A",templateUrl:t(5).buildUrl("form-m/add-form-m/comment/comment.html"),scope:!0,controller:"FormMCommentDirectiveController as formMComment"}}function n(e,o,t,r,n,i,s){function c(e){a.title=l,a.formM.showCommentForm=!1,a.formM.showEditComment=!1,a.commentToEdit=null,i.commentText=null,e&&s(e)}var a=this;a.formM=i;var l="Add comment",m=40;c(),a.isValid=function(t,r){return o(e,"commentForm",t,r)},a.toggleShow=function(e){a.formM.showCommentForm=a.formM.amount&&a.formM.number&&!a.formM.showCommentForm,a.formM.showCommentForm?a.title="Dismiss":c(e)},a.editCommentInvalid=function(e){return t.isEmpty(a.commentToEdit)||e.$invalid?!0:a.commentToEdit.text===i.commentText},a.onCommentDblClick=function(e){a.formM.showEditComment=!0,a.formM.showCommentForm=!1,a.toggleShow(),a.commentToEdit=angular.copy(e),i.commentText=a.commentToEdit.text},a.viewComment=function(e){n.showDialog({title:'View comment "'+e.text.slice(0,m)+'"',text:e.text,infoOnly:!0})},a.editComment=function(e,o){i.editComment(e,a.commentToEdit).then(function(){c(o)})},a.addComment=function(e,o){i.addComment(e).then(function(){c(o)})},e.$watch(function(){return i},function(){i.commentForm=e.commentForm},!0)}var i=angular.module("form-m-comment",["rootApp","kanmii-underscore","comment-service"]);i.directive("formMComment",r),r.$inject=[],i.controller("FormMCommentDirectiveController",n),n.$inject=["$scope","formFieldIsValid","kanmiiUnderscore","xhrErrorDisplay","confirmationDialog","formMObject","resetForm2"]},function(e,o,t){"use strict";function r(e){e.state("form_m.bids",{kanmiiTitle:"Bids",views:{bids:{template:t(12),controller:"BidRequestController as bidHome"}}})}function n(e,o,t,r,n,i,s,c,a,l){function m(){h.newBid=null,h.searchedBidResult=null,h.selectedBids={},h.selectedDownloadedBids={},h.bidRequests=[],h.paginationHooks={},e.pending().$promise.then(function(e){u(e)})}function d(e){t.get(e).then(function(e){u(e.data)})}function u(e){h.bidRequests=e.results,h.paginationHooks={next:e.next,previous:e.previous,count:e.count}}function f(e){e&&!i.isEmpty(e)&&i.each(e,function(e,o){var t=p(o);t&&t.downloaded&&(h.selectedDownloadedBids[o]=e)})}function p(e){for(var o=0;o<h.bidRequests.length;o++){var t=h.bidRequests[o];if(t.id===+e)return t}return null}var h=this;m(),h.rowDblClickCb=function(e){l.getPaginated({number:e.form_m_number}).$promise.then(function(e){var t=e.results;t.length&&1===t.length&&o.goToFormM(t[0])})},h.tableCaption="Pending Bids",h.getBidsOnNavigation=d,o.$watch(function(){return h.searchedBidResult},function(e){e&&u(e)});var g=r(n.lcBidRequestDownloadUrl);h.downloadUrl=function(){if(!i.isEmpty(h.selectedBids)){var e=[];return i.each(h.selectedBids,function(o,t){o===!0&&e.push(t)}),g.search({bid_ids:e}).toString()}},h.downloadBtnDisabled=function(){return i.isEmpty(h.selectedBids)?!0:!i.any(h.selectedBids,function(e){return e===!0})},h.onSelectedBidsChanged=f,h.markRequestedBtnDisabled=function(){if(i.isEmpty(h.selectedDownloadedBids))return!0;var e=i.any(h.selectedBids,function(e,o){return!i.has(h.selectedDownloadedBids,o)&&e===!0});return e?!0:!i.any(h.selectedDownloadedBids,function(e){return e===!0})},h.markRequested=function(){var o=[];i.each(h.selectedDownloadedBids,function(t,r){if(t){var n=p(r);n&&(n.requested_at=s(new Date),o.push(e.put(n).$promise))}}),o.length&&a.all(o).then(function(){m()})},h.refreshPage=function(){c(function(){m()},3e3)}}var i=t(7),s=angular.module("form-m-bids",["ui.router","lc-bid-request","rootApp","kanmii-URI","kanmii-underscore","form-m-service"]);s.config(i.interpolateProviderConfig),s.config(r),r.$inject=["$stateProvider"],s.controller("BidRequestController",n),n.$inject=["LcBidRequest","$scope","$http","kanmiiUri","urls","kanmiiUnderscore","formatDate","$timeout","$q","FormM"],t(13)},function(e,o){e.exports='<div class="form-m-home-view"><div class="action-buttons" style="text-align: right;margin-bottom: 30px;"><button class="btn btn-info" ng-click="bidHome.searchBids()">Search Bid Requests</button> <a class="btn btn-success" ng-href="{$bidHome.downloadUrl()$}" ng-disabled="bidHome.downloadBtnDisabled()" ng-click="bidHome.refreshPage()">Download</a> <button type="button" name="bid-home-mark-as-requested-btn" class="btn btn-success" ng-click="bidHome.markRequested()" ng-disabled="bidHome.markRequestedBtnDisabled()">Mark as requested</button></div><div display-pending-bid="" pending-bids="bidHome.bidRequests" pager-object="bidHome.paginationHooks" update-collection="bidHome.getBidsOnNavigation(linkUrl)" pagination-size="20" selected-bids="bidHome.selectedBids" on-selected-bids-changed="bidHome.onSelectedBidsChanged(newSelections)" on-row-dbl-click="bidHome.rowDblClickCb(bid)"></div></div>'},function(e,o,t){"use strict";function r(){return{restrict:"EA",templateUrl:i.buildUrl("form-m/bids/display-pending-bid/display-pending-bid.html"),scope:!0,bindToController:{bids:"=pendingBids",updateCollection:"&",onSelectedBidsChanged:"&",pager:"=pagerObject",onDblClick:"&onRowDblClick",paginationSize:"=",selectedBids:"="},controller:"displayPendingBidDirectiveCtrl as bidTable"}}function n(e,o,t){function r(o,t,r){var n=Math.ceil(r/c.paginationSize),i=e(o,t,n);c.nextPageLink=o,c.prevPageLink=t,c.linkUrls=i.linkUrls,c.currentLink=i.currentLink,c.rowIndexOffset=(c.currentLink-1)*c.paginationSize}function n(e){c.updateCollection({linkUrl:e})}function i(){c.bids.forEach(function(e){e.highlighted=!1})}function s(e){e.downloaded||(i(),e.highlighted=!t.any(c.bids,function(e){return e.checked}))}var c=this;c.selectedBids={},c.onUpdateCollection=n,o.$watch(function(){return c.pager},function(e){e&&!t.isEmpty(e)&&r(e.next,e.previous,e.count)}),c.modelRowClicked=s,c.onRowDblClick=function(e){c.onDblClick({bid:e})},o.$watch(function(){return c.selectedBids},function(e){c.onSelectedBidsChanged({newSelections:e}),e&&!t.isEmpty(e)&&(t.each(e,function(e,o){for(var t=0;t<c.bids.length;t++){var r=c.bids[t];r.id===+o&&(r.checked=e)}}),c.toggleAll=t.all(c.bids,function(e){return e.checked===!0}))},!0),c.toggleAll=!1,c.toggleAllClicked=function(){c.bids.forEach(function(e){c.selectedBids[e.id]=c.toggleAll})}}var i=t(5),s=angular.module("form-m-bids");s.directive("displayPendingBid",r),s.controller("displayPendingBidDirectiveCtrl",n),n.$inject=["pagerNavSetUpLinks","$scope","kanmiiUnderscore"]},function(e,o,t){"use strict";function r(e){e.state("form_m.list",{kanmiiTitle:"Form M List",views:{listFormM:{template:t(15),controller:"FormMListController as formMList"}}})}function n(e,o,t,r){function n(e){s.formMs=e.results,s.paginationHooks={next:e.next,previous:e.previous,count:e.count}}function i(e){r.get(e).then(function(e){n(e.data)})}var s=this;s.modelManager=t,s.modelRowDblClick=function(e){o.goToFormM(e)},s.paginationHooks=[],s.formMs=[],e.getNoLcAttached().$promise.then(function(e){n(e)}),s.tableCaption="Form M (LC Not Established)",s.getFormMCollectionOnNavigation=i,s.searchedFormMResult=null,o.$watch(function(){return s.searchedFormMResult},function(e){e&&n(e)})}var i=t(7),s=angular.module("list-form-m",["rootApp","ui.router","form-m-service","form-m-search","model-table","customer","add-form-m"]);s.config(i.interpolateProviderConfig),s.config(r),r.$inject=["$stateProvider"],s.controller("FormMListController",n),n.$inject=["FormM","$scope","formMModelManager","$http"]},function(e,o){e.exports='<div class="manage-form-m-tab-content"><div class="action-buttons pull-right"><button class="btn btn-info" search-form-m="" search-form-m-result="formMList.searchedFormMResult">Search Form M</button></div><div model-table="" model-collection="formMList.formMs" table-model-manager="::formMList.modelManager" table-caption="::formMList.tableCaption" pagination-size="20" update-collection="formMList.getFormMCollectionOnNavigation(linkUrl)" pager-object="formMList.paginationHooks" on-row-dbl-click-callback="formMList.modelRowDblClick(rowModel)"></div></div>'},function(e,o,t){"use strict";function r(e,o,r,n,i,s){function c(t){function r(e){1===e.length&&c.resolve({uploaded:e[0]})}function n(e){o(e),c.reject(e)}var c=i.defer(),a=t.mf;return s.getPaginated({number:a}).$promise.then(function(o){1===o.count?c.resolve({detailed:o.results[0]}):e.query({mf:a}).$promise.then(r,n)},n),c.promise}function a(){function e(){var e=i.defer();return r.showModal({templateUrl:t(5).buildUrl("form-m/search-detailed-or-uploaded-form-m/search-detailed-or-uploaded-form-m-modal.html"),controller:"SearchDetailedOrUploadedFormMServiceModalCtrl as searchUploadedFormMModal"}).then(function(o){o.element.dialog({dialogClass:"no-close",modal:!0,minWidth:500,title:"Search Form M",close:function(){o.controller.close()}}),o.close.then(function(o){o&&angular.isObject(o)&&!n.isEmpty(o)&&e.resolve(c(o))})}),e.promise}var o=this;o.searchWithModal=e}return new a}function n(e,o,t){function r(){i.searchParams={}}function n(e){o(e,t,".form-control",r),e.$invalid=!1,e.$error={}}var i=this;r(),i.close=e,i.reset=n}var i=angular.module("search-detailed-or-uploaded-form-m",["kanmii-underscore","upload-form-m-service","toggle-dim-element","form-m-service"]);i.factory("SearchDetailedOrUploadedFormMService",r),r.$inject=["UploadFormM","xhrErrorDisplay","ModalService","kanmiiUnderscore","$q","FormM"],i.controller("SearchDetailedOrUploadedFormMServiceModalCtrl",n),n.$inject=["close","resetForm","$element"]},function(e,o,t){"use strict";function r(e,o,r,n,i,s){function c(t){function r(e){s.resolve(e)}function n(e){o(e),s.reject(e)}var s=i.defer(),c=angular.copy(t);return c.applicant&&(c.applicant=c.applicant.name),c.currency&&(c.currency=c.currency.code),e.getPaginated(c).$promise.then(r,n),s.promise}function a(){function e(e){var o=i.defer();return e=e||{},r.showModal({templateUrl:t(5).buildUrl("form-m/search-form-m-service/search-form-m-modal.html"),controller:"SearchFormMServiceModalCtrl as searchFormMModal",inputs:{uiOptions:e.uiOptions}}).then(function(t){t.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,title:"Search Form M",open:function(){e.dim&&s.dim(e.parent,e.dimCb)},close:function(){e.dim&&s.unDim(e.parent,e.unDimCb)}}),t.close.then(function(t){t&&angular.isObject(t)&&!n.isEmpty(t)&&o.resolve(c(t)),e.dim&&s.unDim(e.parent,e.unDimCb)})}),o.promise}var o=this;o.searchWithModal=e}return new a}function n(e,o,t,r,n,i){function s(){m.searchParams={},m.showLcIssueContainer=!1,m.searchLcIssuesTitle="Search By Letter Of Credit Issues",m.selectedLcIssues={}}function c(){m.showLcIssueContainer=!m.showLcIssueContainer,m.searchLcIssuesTitle=m.showLcIssueContainer?"Dismiss":"Search By Letter Of Credit Issues"}function a(e){t(e,r,".form-control",s),e.$invalid=!1,e.$error={}}function l(e){o(e)}var m=this;m.displayLcIssueUI=!1,e&&(m.displayLcIssueUI=e.displayLcIssueUI),s(),m.toggleShowLcIssueContainer=c,m.close=o,m.reset=a,m.submitSearchParams=l,m.getApplicant=n,m.getCurrency=i}var i=angular.module("form-m-search-service",["kanmii-underscore","toggle-dim-element"]);i.factory("SearchFormMService",r),r.$inject=["FormM","xhrErrorDisplay","ModalService","kanmiiUnderscore","$q","ToggleDimElement"],i.controller("SearchFormMServiceModalCtrl",n),n.$inject=["uiOptions","close","resetForm","$element","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o,t){"use strict";function r(e,o){return{restrict:"A",link:function(r,n,i,s){n.css({cursor:"pointer"}).bind("click",function(){e.showModal({template:t(19),controller:"SearchFormMModalCtrl as searchFormMModal"}).then(function(e){e.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,title:"Search Form M"}),e.close.then(function(e){e&&angular.isObject(e)&&!o.isEmpty(e)&&s.searchFormM(e)})})})},controller:"SearchFormMDirectiveCtrl as searchFormM",scope:{},bindToController:{searchFormMResult:"="}}}function n(e,o){function t(t){function n(e){r.searchFormMResult=e}function i(e){o(e)}var s=angular.copy(t);s.applicant&&(s.applicant=s.applicant.name),s.currency&&(s.currency=s.currency.code),e.getPaginated(s).$promise.then(n,i)}var r=this;r.searchFormM=t}function i(e,o,t,r,n){function i(){l.searchParams={},l.showLcIssueContainer=!1,l.searchLcIssuesTitle="Search By Letter Of Credit Issues",l.selectedLcIssues={}}function s(){l.showLcIssueContainer=!l.showLcIssueContainer,l.searchLcIssuesTitle=l.showLcIssueContainer?"Dismiss":"Search By Letter Of Credit Issues"}function c(e){o(e,t,".form-control",i),e.$invalid=!1,e.$error={}}function a(o){e(o)}var l=this;i(),l.toggleShowLcIssueContainer=s,l.close=e,l.reset=c,l.submitSearchParams=a,l.getApplicant=r,l.getCurrency=n}var s=angular.module("form-m-search",["kanmii-underscore"]);s.directive("searchFormM",r),r.$inject=["ModalService","kanmiiUnderscore"],s.controller("SearchFormMDirectiveCtrl",n),n.$inject=["FormM","xhrErrorDisplay"],s.controller("SearchFormMModalCtrl",i),i.$inject=["close","resetForm","$element","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o){e.exports='<div id="search-form-m-root-container" class="search-form-m-root-container"><form novalidate="" class="form-horizontal" ng-submit="searchFormMModal.submitSearchParams(searchFormMModal.searchParams)" name="searchFormMModalForm"><fieldset class="search-form-m-container" style="position: relative; padding: 7px;"><div class="form-group form-m-number-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="form-m-number">Form M Number</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" maxlength="13" id="form-m-number" min="0" ng-pattern="/(?:mf)?\\d{4,11}/i" ng-model="searchFormMModal.searchParams.number"></div></div><div class="form-group applicant-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="applicant">Applicant</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" type="text" min="3" id="applicant" ng-model="searchFormMModal.searchParams.applicant" typeahead-min-length="3" uib-typeahead="applicant as applicant.name for applicant in searchFormMModal.getApplicant($viewValue)"></div></div><div class="form-group currency-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="currency">Currency</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="currency" maxlength="3" ng-model="searchFormMModal.searchParams.currency" uib-typeahead="currency as currency.code for currency in searchFormMModal.getCurrency($viewValue)" typeahead-min-length="2"></div></div><div class="form-group amount-group"><label class="control-label col-md-4 col-lg-4 col-sm-4" for="amount">Amount</label><div class="col-md-8 col-lg-8 col-sm-8"><input class="form-control" id="amount" min="0" ng-model="searchFormMModal.searchParams.amount" number-format="" ng-pattern="/^\\d[\\d,]*(?:\\.\\d*)?$/"></div></div></fieldset><div class="form-m-lc-issue-container"><span ng-click="searchFormMModal.toggleShowLcIssueContainer()" class="form-m-lc-issue-toggle-show"><span ng-class="[\'glyphicon\', {\'glyphicon-chevron-down\': !searchFormMModal.showLcIssueContainer, \'glyphicon-chevron-up\': searchFormMModal.showLcIssueContainer}]"></span> {$searchFormMModal.searchLcIssuesTitle$}</span><div class="form-m-search-lc-issue" ng-show="searchFormMModal.showLcIssueContainer"><lc-issue lc-issue-show="searchFormMModal.showLcIssueContainer" lc-issues-selected="searchFormMModal.selectedLcIssues"></lc-issue></div></div><div class="row search-form-m-form-control"><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: left"><span class="btn btn-default" ng-click="searchFormMModal.reset(searchFormMModalForm)">Reset</span></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: center"><button type="submit" class="btn btn-info" ng-disabled="searchFormMModalForm.$invalid">Search Form M</button></div><div class="col-md-4 col-lg-4 col-sm-4" style="text-align: right"><span class="btn btn-default" ng-click="searchFormMModal.close()">Close</span></div></div></form></div>';

},function(e,o,t){"use strict";function r(e){e.state("form_m.upload",{kanmiiTitle:"Form M Upload",views:{uploadFormM:{template:t(22),controller:"UploadFormMController as uploadFormM"}}})}function n(e,o,t,r){function n(e){s.formMShowIndicator=!1,s.indicateError=!1,s.formMIsUploading=!1,s.uploadIndicationText="Uploading Form Ms.........please wait",s.uploadFormMText="",e&&(e.$setPristine(),e.$setUntouched())}function i(){s.formMShowIndicator=!1,s.formMIsUploading&&n(r.uploadFormMForm)}var s=this;s.datePrompt="Date must be in format dd-mm-yyyy e.g 31-01-2015",n(),s.dismissIndicator=function(){i()},s.dismissIndicatorEvent=function(e){console.log(e),e&&27===e.keyCode&&i()},s.uploadFormM=function(r){function n(e){var o=/(\d{2})\D(\d{1,2})\D(\d{4})/,t=o.exec(e);if(!t)return null;var r=+t[2].trim();return r>12?null:t[3]+"-"+r+"-"+t[1]}function i(e){var o=e.created_data,t=o.length,r=h.length-t;s.uploadIndicationText="Done Uploading form Ms\n======================\nTotal new form Ms created: "+t+"\n",r&&(s.uploadIndicationText+="Total not created (uploaded previously): "+r)}function c(e){s.formMIsUploading=!1,s.indicateError=!0,s.uploadIndicationText="Error uploading form!",o(e)}s.formMIsUploading=!0,s.formMShowIndicator=!0;var a,l,m,d,u,f={};try{Papa.parse(r,{delimiter:"	",header:!0,step:function(e){if(a=e.data[0],l=a["MF NUM"].trim(),d=a["BA NUM"].trim(),u=n(a["DATE SUBMITTED"]),!u)throw new Error('Error in form M date: "'+l+'"\n'+s.datePrompt);m={ba:d,mf:l,ccy:a.CURRENCY.trim(),applicant:a["APPLICANT NAME"].trim(),fob:a.FOB.replace(/[,\s]/g,""),cost_freight:a["COST AND FREIGHT"].replace(/[,\s]/g,""),submitted_at:u,validated_at:u,goods_description:a.DESCS.trim()},t.has(f,l)?"Validated"===a.STAX.trim()?(m.submitted_at=f[l].submitted_at,f[l]=m):"Submitted"===a.STAX.trim()&&(f[l].submitted_at=m.submitted_at):16===d.length&&(f[l]=m)}})}catch(p){return s.formMIsUploading=!1,s.indicateError=!0,void(s.uploadIndicationText=p.message)}var h=t.values(f);e.save({uploaded:h,likely_duplicates:!0}).$promise.then(i,c)}}t(21);var i=t(7),s=angular.module("upload-form-m",["rootApp","ui.router","upload-form-m-service","kanmii-underscore"]);s.config(i.interpolateProviderConfig),s.config(r),r.$inject=["$stateProvider"],s.controller("UploadFormMController",n),n.$inject=["UploadFormM","xhrErrorDisplay","kanmiiUnderscore","$scope"]},function(e,o,t){"use strict";function r(e,o,r,n,i){function s(t){function r(e){s.resolve(e)}function n(e){o(e),s.reject(e)}var s=i.defer(),c=angular.copy(t);return c.applicant&&(c.applicant=c.applicant.name),c.currency&&(c.currency=c.currency.code),e.query(c).$promise.then(r,n),s.promise}function c(){function e(){var e=i.defer();return r.showModal({templateUrl:t(5).buildUrl("form-m/upload-form-m/search-uploaded-form-m/search-uploaded-form-m-modal.html"),controller:"SearchUploadedFormMServiceModalCtrl as searchUploadedFormMModal"}).then(function(o){o.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:250,title:"Search Uploaded Form M",close:function(){o.close.then()}}),o.close.then(function(o){o&&angular.isObject(o)&&!n.isEmpty(o)&&e.resolve(s(o))})}),e.promise}var o=this;o.searchWithModal=e}return new c}function n(e,o,t){function r(){s.searchParams={}}function n(e){o(e,t,".form-control",r),e.$invalid=!1,e.$error={}}function i(o){e(o)}var s=this;r(),s.close=e,s.reset=n,s.submitSearchParams=i}var i=angular.module("search-uploaded-form-m",["kanmii-underscore","upload-form-m-service","toggle-dim-element"]);i.factory("SearchUploadedFormMService",r),r.$inject=["UploadFormM","xhrErrorDisplay","ModalService","kanmiiUnderscore","$q"],i.controller("SearchUploadedFormMServiceModalCtrl",n),n.$inject=["close","resetForm","$element"]},function(e,o){e.exports='<div class="upload-form-m-tab-content" ng-keypress="uploadFormM.dismissIndicatorEvent($event)"><form class="upload-form-m-form" role="form" name="uploadFormMForm" ng-submit="uploadFormM.uploadFormM(uploadFormM.uploadFormMText, uploadFormMForm)"><div class="form-group upload-form-m-text-group"><pre ng-class="[\'upload-form-m-indicator\', {\'error-indicator\': uploadFormM.indicateError}]" ng-show="uploadFormM.formMShowIndicator">{$uploadFormM.uploadIndicationText$}\r\n        <span class="dismiss" data-toggle="tooltip" title="Dismiss" ng-click="uploadFormM.dismissIndicator()">x</span>\r\n      </pre><label for="upload-form-m" class="control-label">{$uploadFormM.datePrompt$}</label> <textarea name="upload-form-m" id="upload-form-m" required="" ng-model="uploadFormM.uploadFormMText" ng-class="[\'form-control\', \'upload-form-m\', {\'form-m-is-uploading\':uploadFormM.formMIsUploading}]" ng-readonly="uploadFormM.formMIsUploading"></textarea></div><div class="upload-form-m-submit" style="text-align: center"><button type="submit" class="btn btn-success" ng-disabled="uploadFormMForm.$invalid || uploadFormM.formMIsUploading">Upload</button></div></form></div>'},function(e,o){e.exports='<div class="form-m-home-view"><div uib-tabset=""><div uib-tab="" ng-repeat="(key, tab) in tabs" heading="{$tab.title$}" active="tab.active" select="tab.select()"><div class="" ui-view="{$tab.viewName$}"></div></div></div></div>'},function(e,o,t){"use strict";function r(e){e.state("lc",{url:"/lc",kanmiiTitle:"Letter of credit",templateUrl:t(5).buildUrl("lc/lc.html"),controller:"LetterOfCreditController as lcHome"})}function n(e,o){var t=this;t.searchLc=function(){e.searchWithModal().then(function(e){var t=e.results;if(t.length&&1===t.length){var r=t[0];o.go("lc_detail",{lc_number:r.lc_number,lc:r})}})}}var i=t(7),s=angular.module("lc",["ui.router","model-table","rootApp","search-lc","lc-detail"]);s.config(i.interpolateProviderConfig),s.config(r),r.$inject=["$stateProvider"],s.controller("LetterOfCreditController",n),n.$inject=["SearchLc","$state"],t(25),t(26)},function(e,o,t){"use strict";function r(e){e.state("lc_detail",{url:"/lc/:lc_number",params:{lc:null},kanmiiTitle:"Letter of credit",templateUrl:t(5).buildUrl("lc/lc-detail/lc-detail.html"),controller:"LetterOfCreditDetailController as lcDetail"})}function n(e,o,t,r,n,i,s,c,a,l,m,d){function u(){function r(e){return e?e.filter(function(e){return!e.closed_at}):[]}e.lc?(f.lc=e.lc,f.lcIssues=r(f.lc.issues)):o.getPaginated({lc_number:e.lc_number}).$promise.then(function(e){e.count?(f.lc=e.results[0],f.lcIssues=r(f.lc.issues)):t.go("lc")}),f.lcForm={},f.alertIsShown=!1,f.issue={}}var f=this;u(),f.issueDateGetterSetter=function(){return f.lc&&f.lc.estb_date?n("date")(f.lc.estb_date,"dd-MMM-yyyy"):void 0},f.expiryDateGetterSetter=function(){return f.lc&&f.lc.expiry_date?n("date")(f.lc.expiry_date,"dd-MMM-yyyy"):void 0},f.saveIssue=function(e,o){function t(e){f.lcIssues.unshift({issue_text:e.issue_text,issue:e.issue,id:e.id,mf:e.mf}),f.issue={},f.lc.applicant_data||(f.lc.applicant_data=i),o.$setPristine(),o.$setUntouched()}function r(e){var o=null;e.data.form_m_creation_errors&&(o=d,delete e.data.form_m_creation_errors),a(e,o)}if(e&&!c.isEmpty(e)){var n={issue:e.issue.url,mf:f.lc.mf,lc_number:f.lc.lc_number,get_or_create_form_m:!0},i=e.applicant;i&&!c.isEmpty(i)&&(n.form_m_data={applicant:i.url,currency:f.lc.ccy_data.url,amount:f.lc.lc_amt_org_ccy,lc:f.lc.url,number:f.lc.mf}),s.save(n).$promise.then(t,r)}},f.closeIssue=function(e){e.closed_at=l(new Date),s.put(e).$promise.then(function(){f.lcIssues=f.lcIssues.filter(function(o){return o.id!==e.id})},function(e){a(e)})},f.replaceLc=function(e){o.getPaginated({lc_number:e}).$promise.then(function(e){if(e.count){var o=e.results[0];t.go(".",{lc_number:o.lc_number,lc:o})}else f.alertIsShown=!0})},f.replaceLcFormInvalid=function(e,o){return e||-1!==f.lc.lc_number.toLowerCase().indexOf(o.toLowerCase())},f.customerAdded=function(e){f.issue.applicant=e},f.getApplicant=r,f.getIssue=function(e){return i({text:e,exclude_form_m_issues:f.lc.mf})},f.addCustomer=function(){m.save({name:f.lc.applicant}).$promise.then(function(e){f.issue.applicant=e,f.lc.applicant_data=e})},f.closeAlert=function(){f.alertIsShown=!1}}var i=t(7),s=angular.module("lc-detail",["ui.router","rootApp","lc-service","lc-issue-service","kanmii-underscore","customer"]);s.config(i.interpolateProviderConfig),s.config(r),r.$inject=["$stateProvider"],s.controller("LetterOfCreditDetailController",n),n.$inject=["$stateParams","LetterOfCredit","$state","getTypeAheadCustomer","$filter","getTypeAheadLCIssue","LCIssueConcrete","kanmiiUnderscore","xhrErrorDisplay","formatDate","Customer","formMAttributesVerboseNames"]},function(e,o,t){"use strict";function r(e,o,r,n,i,s){function c(o){function t(e){i.resolve(e)}function r(o){e(o),i.reject(o)}var i=n.defer(),c=angular.copy(o);return c.applicant&&(c.applicant=c.applicant.name),c.currency&&(c.currency=c.currency.code),s.getPaginated(c).$promise.then(t,r),i.promise}function a(){function e(e){var s=n.defer();return e=e||{},o.showModal({templateUrl:t(5).buildUrl("lc/search-lc/search-lc.html"),controller:"SearchLcModalCtrl as searchLcModal",inputs:{uiOptions:e.uiOptions}}).then(function(o){o.element.dialog({dialogClass:"no-close",modal:!0,minWidth:600,minHeight:450,title:"Search Letter of credit",open:function(){e.dim&&i.dim(e.parent,e.dimCb)},close:function(){e.dim&&i.unDim(e.parent,e.unDimCb)}}),o.close.then(function(o){o&&angular.isObject(o)&&!r.isEmpty(o)&&s.resolve(c(o)),e.dim&&i.unDim(e.parent,e.unDimCb)})}),s.promise}var s=this;s.searchWithModal=e}return new a}function n(e,o,t,r,n){function i(){a.searchParams={}}function s(e){o(e,t,".form-control",i),e.$invalid=!1,e.$error={}}function c(o){e(o)}var a=this;i(),a.close=e,a.reset=s,a.submitSearchParams=c,a.getApplicant=r,a.getCurrency=n}var i=angular.module("search-lc",["kanmii-underscore","toggle-dim-element","form-m-service","lc-service"]);i.factory("SearchLc",r),r.$inject=["xhrErrorDisplay","ModalService","kanmiiUnderscore","$q","ToggleDimElement","LetterOfCredit"],i.controller("SearchLcModalCtrl",n),n.$inject=["close","resetForm","$element","getTypeAheadCustomer","getTypeAheadCurrency"]},function(e,o){e.exports='<div class="form-m-home-view"><div class="form-m-home-action-buttons btn-group-vertical" role="group"><a class="btn btn-info form-m-home-action-button" ui-sref="lc">Letter of credit</a> <a class="btn btn-info form-m-home-action-button" ui-sref="form_m">Form M</a></div></div>'}]);
//# sourceMappingURL=app.min.js.map
