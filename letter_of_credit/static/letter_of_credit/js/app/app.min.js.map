{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/app/app.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","formMRootAppURLConfig","$stateProvider","$urlRouterProvider","otherwise","state","url","kanmiiTitle","template","rootCommons","app","angular","config","interpolateProviderConfig","run","$rootScope","$state","$stateParams","$inject","formMURLConfig","controller","FormMController","$scope","listFormMTab","className","title","viewName","select","updateAddFormMTitle","go","addFormMTitle","addFormMGoTo","addFormMTab","active","reportsTab","bidsTab","tabs","listFormM","addFormM","bids","reports","formM","number","goToFormM","formMNumber","transitionTo","formMStateConfig","params","showSummary","views","templateUrl","buildUrl","AddFormMStateController","getTypeAheadCustomer","getTypeAheadCurrency","SearchDetailedOrUploadedFormMService","underscore","xhrErrorDisplay","resetForm2","confirmationDialog","formMObject","formMAttributesVerboseNames","getTypeAheadLetterOfCredit","DisplayUploadedFormMModal","initFormMCb","detailedFormM","vm","lcRef","lc_number","fieldIsEditable","currency","applicant","date_received","amount","formMSavedSuccessMessage","initialize","form","elements","concat","newFormMForm","$setPristine","$setUntouched","init","searchFormM","summary","showDialog","text","infoOnly","this","reset","enableFieldEdit","field","disableSubmitBtn","$invalid","has","coverForm","bidForm","issuesForm","commentForm","showEditBid","showCommentForm","compared","compareFormMs","all","bid","goods_description","isEmpty","cover","selectedIssues","length","getLc","trim","mf","getApplicant","getCurrency","datePickerFormat","datePickerIsOpen","openDatePicker","getUploadedFormM","searchWithModal","then","data","display","singleWinFormMs","cost_freight","ccy","submit","saveFormM","xhr","LcBidRequest","LCIssueConcrete","FormMCover","formatDate","$filter","getTypeAheadLCIssue","FormM","$q","Comment","Factory","setComments","query","ct","self","ct_id","pk","not_deleted","$promise","comments","console","log","setIssues","form_m_number","forEach","issue","closed_at","closedIssues","push","nonClosedIssues","setCovers","covers","confirmationTitleLength","setBids","cb","existingBids","getPaginated","count","results","total_allocation","total_utilization","each","allocations","allocation","amount_allocated","amount_utilized","unallocated","setInitialProperties","showBidForm","commentText","showEditComment","showIssueForm","showCoverForm","Date","form_m_issues","_id","applicant_data","currency_data","Number","ct_url","lc","formatIssueText","replace","closeIssue","$index","issueClosedSuccess","issue_text","splice","issueClosedError","answer","put","createIssuesMessage","issues","issuesText","index","createFormMMessage","ref","header","name","code","getFreshIssues","_ids","x","URL_REGEXP","RegExp","exec","exclude_issue_ids","join","formMSavedSuccess","new_issues","formMToSave","deferred","resolve","formMSavedError","reject","maturity","cover_type","defer","do_not_update","$put","$save","promise","editFormM","pristineFormM","otherFormM","equals","addComment","save","content_type","object_id","slice","closeComment","comment","deleted_at","toJSON","editComment","copy","len","factory","lcIssueDirective","restrict","scope","bindToController","onIssuesChanged","LcIssueDirectiveController","clearFormField","issueSelected","$item","$model","deleteIssue","toggleShow","$watch","issueForm","$validate","directive","require","link","elm","attributes","ctrl","lcIssue","$validators","Boolean","fsPath","lcCommons","appName","staticPrefix","setStaticPrefix","addIconSrc","$interpolateProvider","startSymbol","endSymbol","rootAppName","onCoverChanged","LcCoverDirectiveController","formMCoverTypes","formFieldIsValid","coverTypes","isValid","validity","amountGetterSetter","val","arguments","test","lcBidDirective","LcBidDirectiveController","moment","toISODate","ViewBidDetail","bidRequestedDate","bidCreatedDate","bidMaturityDate","bidToEdit","showAllocateFx","bidFormCtrlNames","copyBidForEdit","downloaded","created_at","requested_at","toHumanDate","dtObj","format","getSelectedBids","selections","result","getBidFromId","createEditBidMessage","bidIsNotModified","bidNotModified","bidIndex","checkBids","selectedBids","selectedBidsLen","checked","bidsNewlySetCb","prop","key","editBidInvalid","onEditBid","trashBid","bidDeleteSuccess","editBid","doEdit","update_goods_description","viewBidDetail","allocateFx","initialBidProps","allocationTitle","onFxAllocated","getAmount","deal_number","allocated_on","utilized_on","dismissShowAllocateFxForm","formMCommentDirective","FormMCommentDirectiveController","commentToEdit","editCommentInvalid","onCommentDblClick","viewComment","bidURLConfig","BidRequestController","$http","kanmiiUri","urls","$timeout","selectedDownloadedBids","bidRequests","paginationHooks","pending","updateBids","getBidsOnNavigation","linkUrl","get","response","next","previous","onSelectedBidsChanged","newSelections","bidId","rowDblClickCb","onBidsSearched","searchedBidResult","lcBidRequestDownloadUrl","downloadUrl","search","selection","bid_ids","toString","downloadBtnDisabled","any","selectionVal","markRequestedBtnDisabled","markRequested","editedBids","refreshPage","searchBidsDirective","searchBidsController","searchParams","showForm","clearForm","validators","isObject","searchBids","searchResult","displayPendingBidDirective","lcAppCommons","updateCollection","pager","onDblClick","paginationSize","displayPendingBidDirectiveCtrl","pagerNavSetUpLinks","setUpLinks","prev","numLinks","Math","ceil","linkProperties","nextPageLink","prevPageLink","linkUrls","currentLink","rowIndexOffset","onUpdateCollection","deselectAllBids","highlighted","modelRowClicked","model","onRowDblClick","toggleAll","toggleAllClicked","formMListURLConfig","FormMListController","formMModelManager","updateFormMs","formMs","getFormMCollectionOnNavigation","modelManager","modelRowDblClick","getNoLcAttached","tableCaption","searchedFormMResult","UploadFormM","ModalService","submittedSearchParams","searchFormMSuccess","searchFormMError","SearchService","showModal","modal","element","dialog","dialogClass","minWidth","close","service","SearchDetailedOrUploadedFormMServiceModalCtrl","resetForm","initForm","$error","searchMfDirective","onMfSearch","searchFormMController","cancelled","searchMf","applicant_id","applicantObj","uploadFormMURLConfig","uploadFormM","UploadFormMController","kanmiiUnderscore","initial","formMShowIndicator","indicateError","formMIsUploading","uploadIndicationText","uploadFormMText","doDismiss","uploadFormMForm","datePrompt","dismissIndicator","parseDate","dt","regExp","month","formMCreatedSuccess","creationResult","created_data","numCreatedNow","numCreatedPreviously","uploaded1","formMCreatedError","row","ba","uploaded","Papa","parse","delimiter","step","Error","CURRENCY","fob","FOB","submitted_at","validated_at","DESCS","STAX","e","message","values","likely_duplicates","SearchUploadedFormMService","minHeight","SearchUploadedFormMServiceModalCtrl","submitSearchParams","DisplayService","forMData","inputs","DisplayUploadedFormMModalCtrl","uploadedFormMModelManager","LetterOfCreditController","SearchLc","searchLc","LetterOfCreditDetailController","LetterOfCredit","Customer","getIssuesNotClosed","filter","lcIssues","lcForm","alertIsShown","issueDateGetterSetter","estb_date","expiryDateGetterSetter","expiry_date","saveIssue","saveSuccess","unshift","saveError","transform","form_m_creation_errors","postData","get_or_create_form_m","form_m_data","ccy_data","lc_amt_org_ccy","anIssue","replaceLc","newLcNumber","replaceLcFormInvalid","formInvalid","toLowerCase","indexOf","customerAdded","customer","getIssue","exclude_form_m_issues","addCustomer","closeAlert","ToggleDimElement","searchLcSuccess","searchLcError","uiOptions","open","dim","parent","dimCb","unDim","unDimCb","SearchLcModalCtrl"],"mappings":"CAAS,SAAUA,GAKT,QAASC,GAAoBC,GAG5B,GAAGC,EAAiBD,GACnB,MAAOC,GAAiBD,GAAUE,OAGnC,IAAIC,GAASF,EAAiBD,IAC7BE,WACAE,GAAIJ,EACJK,QAAQ,EAUT,OANAP,GAAQE,GAAUM,KAAKH,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOE,QAAS,EAGTF,EAAOD,QAvBf,GAAID,KAqCJ,OATAF,GAAoBQ,EAAIT,EAGxBC,EAAoBS,EAAIP,EAGxBF,EAAoBU,EAAI,GAGjBV,EAAoB,KAK/B,SAASI,EAAQD,EAASH,GAE/B,YAuBA,SAASW,GAAsBC,EAAgBC,GAC7CA,EACGC,UAAU,KAEbF,EACGG,MAAM,QACLC,IAAK,IAELC,YAAa,OAEbC,SAAUlB,EAAoB,MA/BpCA,EAAoB,GACpBA,EAAoB,GAEpB,IAAImB,GAAcnB,EAAoB,GAElCoB,EAAMC,QAAQjB,OAAO,eACtB,UACA,YACA,SACA,MAGHgB,GAAIE,OAAOH,EAAYI,2BAEvBH,EAAII,KAAK,aAAc,SAAU,eAAgB,SAASC,EAAYC,EAAQC,GAC5EF,EAAWC,OAASA,EACpBD,EAAWE,aAAeA,KAG5BP,EAAIE,OAAOX,GACXA,EAAsBiB,SAAW,iBAAkB,uBAkB9C,SAASxB,EAAQD,EAASH,GAE/B,YAuBA,SAAS6B,GAAejB,GAEtBA,EACGG,MAAM,UACLC,IAAK,UAELC,YAAa,SAEbC,SAAUlB,EAAoB,IAE9B8B,WAAY,iCAMlB,QAASC,GAAgBL,EAAQM,GAE/B,GAAIC,IACFC,UAAW,uBACXC,MAAO,cACPC,SAAU,YACVC,OAAQ,WACNL,EAAOM,sBACPZ,EAAOa,GAAG,iBAIVC,EAAgB,SAQhBC,GAAe,EACfC,GACFR,UAAW,oBACXC,MAAOK,EACPG,QAAQ,EACRP,SAAU,WACVC,OAAQ,WACFI,GAAcf,EAAOa,GAAG,cAC5BE,GAAe,IAIfG,GACFT,MAAO,UACPQ,QAAQ,EACRP,SAAU,eACVC,OAAQ,WACNL,EAAOM,sBACPZ,EAAOa,GAAG,gBAIVM,GACFX,UAAW,oBACXC,MAAO,OACPQ,QAAQ,EACRP,SAAU,OACVC,OAAQ,WACNL,EAAOM,sBACPZ,EAAOa,GAAG,gBAIdP,GAAOc,MACLC,UAAWd,EACXe,SAAUN,EACVO,KAAMJ,EACNK,QAASN,GAGXZ,EAAOM,oBAAsB,SAAUa,GACrCnB,EAAOc,KAAKE,SAASb,MAAQgB,EAAQ,eAAiBA,EAAMC,OAAS,IAAMZ,GAG7ER,EAAOqB,UAAY,SAAmBC,GACpCb,GAAe,EACff,EAAO6B,aAAa,cAAeJ,MAAOG,IAC1CtB,EAAOc,KAAKE,SAASL,QAAS,GAtGlC3C,EAAoB,GACpBA,EAAoB,IACpBA,EAAoB,IACpBA,EAAoB,IACpBA,EAAoB,IACpBA,EAAoB,IACpBA,EAAoB,GAEpB,IAAIoB,GAAMC,QAAQjB,OAAO,UACtB,UACA,YACA,cACA,gBACA,aACA,eAGHgB,GAAIE,OAAOO,GACXA,EAAeD,SAAW,kBAe1BR,EAAIU,WAAW,kBAAmBC,GAClCA,EAAgBH,SAAW,SAAU,WA2EhC,SAASxB,EAAQD,EAASH,GAE/B,YAgCA,SAASwD,GAAiB5C,GACxBA,EACGG,MAAM,cACLE,YAAa,aAEbwC,QAASC,YAAa,KAAMP,MAAO,MAEnCQ,OACEX,UACEY,YAAa5D,EAAoB,GAAG6D,SAAS,qCAE7C/B,WAAY,+CAyBtB,QAASgC,GAAwBC,EAAsBC,EAAsBC,EAC3EC,EAAYC,EAAiBxC,EAAcyC,EAAY1C,EAAQM,EAAQqC,EAAoBC,EAC3FC,EAA6BC,EAA4BC,GAGzD,QAASC,GAAYvB,EAAOwB,GAC1BhD,EAAawB,MAAQ,KACrByB,EAAGzB,MAAQA,EACXyB,EAAGzB,MAAM0B,OAASC,UAAW,MAC7BF,EAAGD,cAAgBA,EAEfA,IACFC,EAAGG,iBACD3B,QAAQ,EACR4B,UAAU,EACVC,WAAW,EACXC,eAAe,EACfC,QAAQ,EACRN,OAAO,IAIX7C,EAAOM,oBAAoBqC,GAC3BS,IAIF,QAASC,GAAWC,EAAMhC,GAExB,GAAIgC,EAAM,CACR,GAAIC,IAAY,YAAa,YAAYC,OAAOxD,EAAOyD,aAAaZ,OAAS,YAE7ET,GAAWkB,IAAQA,KAAMtD,EAAOyD,aAAcF,SAAUA,KAExDD,EAAKI,eACLJ,EAAKK,gBAGPf,EAAGD,cAAgB,KACnBC,EAAGG,iBACD3B,QAAQ,EACR4B,UAAU,EACVC,WAAW,EACXC,eAAe,EACfC,QAAQ,EACRN,OAAO,GAGTP,EAAYsB,KAAKtC,GAAe3B,EAAawB,MAAOuB,GAEpDE,EAAGiB,eAKL,QAAST,KACP,GAAIU,GAAUnE,EAAa+B,WAC3B/B,GAAa+B,YAAc,KAEvBoC,GACFzB,EAAmB0B,YACjB5D,MAAO,IAAMyC,EAAGzB,MAAMC,OAAS,uBAC/B4C,KAAMF,EACNG,UAAU,IA5DhB,GAAIrB,GAAKsB,IAuBTb,KA2BAT,EAAGuB,MAAQd,EAeXT,EAAGwB,gBAAkB,SAAyBC,GAC5CzB,EAAGG,gBAAgBsB,GAASzB,EAAGD,eAAiBC,EAAGG,gBAAgBsB,IAAS,GAG9EzB,EAAG0B,iBAAmB,WACpB,GAAItE,EAAOyD,aAAac,SAAU,OAAO,CAEzC,IAAIrC,EAAWsC,IAAI5B,EAAGzB,MAAMsD,UAAW,aAAe7B,EAAGzB,MAAMsD,UAAUF,SAAU,OAAO,CAE1F,IAAIrC,EAAWsC,IAAI5B,EAAGzB,MAAMuD,QAAS,aAAe9B,EAAGzB,MAAMuD,QAAQH,SAAU,OAAO,CAEtF,IAAIrC,EAAWsC,IAAI5B,EAAGzB,MAAMwD,WAAY,aAAe/B,EAAGzB,MAAMwD,WAAWJ,SAAU,OAAO,CAE5F,IAAIrC,EAAWsC,IAAI5B,EAAGzB,MAAMyD,YAAa,aAAehC,EAAGzB,MAAMyD,YAAYL,SAAU,OAAO,CAE9F,IAAIjC,EAAYuC,aAAevC,EAAYwC,gBAAiB,OAAO,CAEnE,IAAIC,GAAWzC,EAAY0C,cAAcpC,EAAGD,cAE5C,OAAKoC,IAED7C,EAAW+C,IAAIF,GACbzC,EAAY4C,IAAIC,mBAAqB7C,EAAY4C,IAAI/B,QAAe,EACnEjB,EAAWkD,QAAQxC,EAAGzB,MAAMkE,OAC7BzC,EAAGzB,MAAM0B,MAAMC,WAAkB,GAC7BF,EAAGzB,MAAMmE,eAAeC,QAFgB,GAJ5B,GAYxB3C,EAAG4C,MAAQ,SAAU3C,GACnB,MAAOL,IAA4BM,UAAWD,EAAM4C,OAAQC,GAAI9C,EAAGzB,MAAMC,UAE3EwB,EAAG+C,aAAe5D,EAClBa,EAAGgD,YAAc5D,EACjBY,EAAGiD,iBAAmB,cACtBjD,EAAGkD,kBAAmB,EACtBlD,EAAGmD,eAAiB,WAClBnD,EAAGkD,kBAAmB,GAGxBlD,EAAGoD,iBAAmB,WACpBpD,EAAGD,cAAgB,KACnBU,IAEApB,EAAqCgE,kBAAkBC,KAAK,SAAUC,GAChEA,EAAK/E,OACPiC,EAAW,KAAM8C,EAAK/E,QAGtBqB,EAA0B2D,QAAQD,EAAKE,iBAAiBH,KAAK,SAAU/E,GACjEA,IACFyB,EAAGiB,YAAc1C,EACjByB,EAAGzB,MAAMC,OAASD,EAAMuE,GACxB9C,EAAGzB,MAAMgC,OAAShC,EAAMmF,aACxB1D,EAAGzB,MAAMgE,kBAAoBhE,EAAMgE,kBAEnCnD,EAAqBb,EAAMoF,KAAKL,KAAK,SAAUK,GAC7C3D,EAAGzB,MAAM6B,SAAWuD,EAAI,WAQpC3D,EAAG4D,OAAS,SAAgBrF,GAC1BmB,EAAYmE,UAAUtF,EAAOyB,EAAGD,eAAeuD,KAAK,SAA0BC,GAC5EzG,EAAOa,GAAG,aAAc4F,IAEvB,SAAwBO,GACzBvE,EAAgBuE,EAAKnE,MA5M3BvE,EAAoB,GACpBA,EAAoB,GACpBA,EAAoB,GACpBA,EAAoB,GACpBA,EAAoB,GAEpB,IAAIoB,GAAMC,QAAQjB,OAAO,cACvB,YACA,UACA,WACA,qCACA,iBACA,WACA,WACA,SACA,iBACA,iBACA,sBACA,2BACA,aACA,2BACA,2BAGFgB,GAAIE,OAAOkC,GAEXA,EAAiB5B,SAAW,kBAmB5BR,EAAIU,WAAW,0BAA2BgC,GAE1CA,EAAwBlC,SACtB,uBACA,uBACA,uCACA,aACA,kBACA,eACA,aACA,SACA,SACA,qBACA,cACA,8BACA,6BACA,8BAuJG,SAASxB,EAAQD,GAEtB,YA6BA,SAASmE,GAAYqE,EAAcC,EAAiBC,EAAYxE,EAAoByE,EAAY3E,EAC9FD,EAAY6E,EAASC,EAAqBC,EAAOC,EAAIC,GACrD,QAASC,KAsCP,QAASC,GAAYhJ,GACnB8I,EAAQG,OAAOC,GAAIC,EAAKC,MAAOC,GAAIrJ,EAAIsJ,aAAa,IAAOC,SAAS1B,KAAK,SAAUC,GACjFqB,EAAKK,SAAW1B,GAEf,SAAUO,GACXoB,QAAQC,IAAI,SAAUrB,KAI1B,QAASsB,KACPpB,EAAgBU,OAAOW,cAAeT,EAAKpG,SAASwG,SAAS1B,KAAK,SAAUC,GAC1EA,EAAK+B,QAAQ,SAAUC,GAChBA,EAAMC,UACNZ,EAAKa,aAAaC,KAAKH,GADNX,EAAKe,gBAAgBD,KAAKH,OAMtD,QAASK,KACP3B,EAAWS,OAAOW,cAAeT,EAAKpG,SAASwG,SAAS1B,KAAK,SAAUC,GACrEqB,EAAKiB,OAAStC,GACb,SAAUO,GACXoB,QAAQC,IAAIrB,KA3DhB,GAAIc,GAAOtD,IACXsD,GAAK3B,iBAAmB,aACxB,IAAI6C,GAA0B,EAE9BlB,GAAKmB,QAAU,SAAiBC,GAC9BpB,EAAKqB,gBACLlC,EAAamC,cAAcpD,GAAI8B,EAAKpG,SAASwG,SAAS1B,KAAK,SAAUC,GAEnE,GAAIA,EAAK4C,MAAO,CACd,GAAIC,GAAU7C,EAAK6C,OAEfA,GAAQzD,SACVyD,EAAQd,QAAQ,SAAUhD,GACxB,GAAI+D,GAAmB,EACnBC,EAAoB,CAExBhH,GAAWiH,KAAKjE,EAAIkE,YAAa,SAAUC,GACzCJ,GAAoBI,EAAWC,iBAC/BJ,GAAqBG,EAAWE,kBAGlCrE,EAAI+D,iBAAmBA,EACvB/D,EAAIgE,kBAAoBA,EACxBhE,EAAIsE,YAActE,EAAI/B,OAAS8F,EAE/BzB,EAAKqB,aAAaP,KAAKpD,KAGrB0D,GAAIA,EAAGpB,EAAKqB,iBAInB,SAAUnC,GACXoB,QAAQC,IAAI,SAAUrB,MA8B1Bc,EAAK5D,KAAO,SAActC,EAAasH,GAErC,QAASa,KAIPjC,EAAKtC,OAMLsC,EAAK3C,aAAc,EAMnB2C,EAAKkC,aAAc,EAMnBlC,EAAKqB,gBAMLrB,EAAKa,gBAKLb,EAAKmC,YAAc,KAMnBnC,EAAKoC,iBAAkB,EAMvBpC,EAAK1C,iBAAkB,EAMvB0C,EAAKK,YAMLL,EAAKe,mBAMLf,EAAKlC,kBAMLkC,EAAKW,MAAQ,KAMbX,EAAKqC,eAAgB,EAErBrC,EAAKiB,UACLjB,EAAKnC,SACLmC,EAAKsC,eAAgB,EAErBtC,EAAKtE,cAAgB,GAAI6G,MACzBvC,EAAKpG,OAAS,KACdoG,EAAKvE,UAAY,KACjBuE,EAAKxE,SAAW,KAChBwE,EAAKrE,OAAS,KACdqE,EAAKrC,kBAAoB,KACzBqC,EAAKwC,cAAgB,KACrBxC,EAAKxI,IAAM,KACXwI,EAAKC,MAAQ,KACbD,EAAKyC,IAAM,KACXzC,EAAK1E,UAAY,KA5FnB2G,GA+FA,IAAItI,EAEAG,GACF2F,EAAM6B,cAAc1H,OAAQE,IAAcsG,SAAS1B,KAAK,SAAUC,GAC5DA,EAAK4C,QACP5H,EAAQgF,EAAK6C,QAAQ,GACrBxB,EAAKtE,cAAgB,GAAI6G,MAAK5I,EAAM+B,eACpCsE,EAAKpG,OAASD,EAAMC,OACpBoG,EAAKvE,UAAY9B,EAAM+I,eACvB1C,EAAKxE,SAAW7B,EAAMgJ,cACtB3C,EAAKrE,OAASiH,OAAOjJ,EAAMgC,QAC3BqE,EAAKrC,kBAAoBhE,EAAMgE,kBAC/BqC,EAAKwC,cAAgB7I,EAAM6I,cAC3BxC,EAAKxI,IAAMmC,EAAMnC,IACjBwI,EAAKC,MAAQtG,EAAMsG,MACnBD,EAAK6C,OAASlJ,EAAMkJ,OACpB7C,EAAKyC,IAAM9I,EAAM9C,GACjBmJ,EAAK1E,UAAY3B,EAAMmJ,GAEvB9C,EAAKmB,UACLX,IACAQ,IACAnB,EAAYG,EAAKyC,MAGnBrB,EAAGpB,EAAMrG,KAIXyH,EAAGpB,IAKPA,EAAK+C,gBAAkB,SAAyBvG,GAAO,MAAOA,GAAKwG,QAAQ,WAAY,KAEvFhD,EAAKiD,WAAa,SAAoBtC,EAAOuC,GAS3C,QAASC,KACP,GAAI3G,GAAO,+BAAiCwD,EAAK+C,gBAAgBpC,EAAMyC,WACvEvI,GAAmB0B,YAAY5D,MAAO,cAAe6D,KAAMA,EAAMC,UAAU,IAC3EuD,EAAKe,gBAAgBsC,OAAOH,EAAQ,GACpClD,EAAKa,aAAaC,KAAKH,GAGzB,QAAS2C,GAAiBpE,GAAMvE,EAAgBuE,GAfhD,GAAI1C,GAAO,mCAAqCwD,EAAK+C,gBAAgBpC,EAAMyC,YAAc,IACzFvI,GAAmB0B,YAAY5D,MAAO,cAAe6D,KAAMA,IAAOkC,KAAK,SAAU6E,GAC3EA,IACF5C,EAAMC,UAAYtB,EAAW,GAAIiD,OACjCnD,EAAgBoE,IAAI7C,GAAOP,SAAS1B,KAAKyE,EAAoBG,OAcnEtD,EAAKyD,oBAAsB,SAA6BC,GAGtD,GAFAA,EAAS1D,EAAKe,gBAAgB/E,OAAQ0H,GAAUA,EAAO3F,OAAU2F,OAE5DA,EAAO3F,OAAQ,MAAO,EAE3B,IAAI4F,GAAa,0GAQjB,OALAjJ,GAAWiH,KAAK+B,EAAQ,SAAU/C,EAAOiD,KACrCA,EACFD,GAAe,IAAMC,EAAQ,KAAO5D,EAAK+C,gBAAgBpC,EAAMyC,YAAc,OAGxEO,GAGT3D,EAAK6D,mBAAqB,WACxB,GAAIlI,GAAS4D,EAAQ,UAAUS,EAAKrE,OAAQ,GACxCmI,EAAM9D,EAAK1E,UAAY0E,EAAK1E,UAAY,IAAM,GAC9CyI,EAAS/D,EAAKvE,UAAUuI,KAAO,MAAQF,EAAM9D,EAAKpG,OAAS,MAAQoG,EAAKxE,SAASyI,KAAO,IAAMtI,CAClG,OAAOoI,GAAS,uBAAyB/D,EAAKpG,OAAS,qBAChCoG,EAAKxE,SAASyI,KAAO,IAC1CtI,EAAS,qBACYqE,EAAKvE,UAAUuI,MAGxChE,EAAK9F,YAAc,WACjBW,EAAmB0B,YACjB5D,MAAOqH,EAAKpG,OACZ4C,KAAMwD,EAAK6D,qBAAuB7D,EAAKyD,sBACvChH,UAAU,KAUduD,EAAKkE,eAAiB,SAAwB1H,GAC5C,GAAI2H,KAEJnE,GAAKlC,eAAe4C,QAAQ,SAAUC,GACpCwD,EAAKrD,KAAKH,EAAM9J,KAGlB,IAAIuN,MACAC,EAAa,GAAIC,QAAO,aAM5B,OAJAF,GAAEpI,OAAOgE,EAAKe,iBAAiB/E,OAAOgE,EAAKa,cAAcH,QAAQ,SAAUC,GACzEwD,EAAKrD,KAAKuD,EAAWE,KAAK5D,EAAMA,OAAO,MAGlCnB,GAAqBhD,KAAMA,EAAMgI,kBAAmBL,EAAKM,KAAK,QAGvEzE,EAAKf,UAAY,SAAmBtF,EAAOwB,GAsCzC,QAASuJ,GAAkB/F,GACzB,GAAIrC,GAAU0D,EAAK6D,qBAAuB7D,EAAKyD,oBAAoB9E,EAAKgG,WAEpEC,GAAYlH,MACdpB,GAAW,wBAA0B3C,EAAM6B,SAASyI,KAAO,IAAM1E,EAAQ,UAAUqF,EAAYlH,IAAI/B,OAAQ,UAGtGgD,GAAKgG,WACZE,EAASC,SAAS5K,YAAaoC,EAAS3C,MAAOgF,EAAK/E,SAGtD,QAASmL,GAAgB7F,GACvB2F,EAASG,OAAO9F,GAjDlB,GAAI0F,IACFnJ,UAAW9B,EAAM8B,UAAUjE,IAC3BgE,SAAU7B,EAAM6B,SAAShE,IACzBkE,cAAe4D,EAAW3F,EAAM+B,eAChCC,OAAQhC,EAAMgC,OACd/B,OAAQD,EAAMC,OACd+D,kBAAmBhE,EAAMgE,kBAGvBhE,GAAM0B,MAAMC,YAAWsJ,EAAY9B,GAAKnJ,EAAM0B,MAAMC,WAEpD3B,EAAM+D,IAAI/B,QAAUhC,EAAM+D,IAAIC,oBAChCiH,EAAYjH,kBAAoBqC,EAAKrC,kBAAoBhE,EAAM+D,IAAIC,kBACnEiH,EAAYlH,KAAO/B,OAAQiH,OAAOjJ,EAAM+D,IAAI/B,QAASsJ,SAAU3F,EAAW3F,EAAM+D,IAAIuH,YAGlFtL,EAAMmE,eAAeC,SAAQ6G,EAAYlB,OAAS/J,EAAMmE,gBAEvDpD,EAAWkD,QAAQjE,EAAMkE,SAC5B+G,EAAY/G,OAASlC,OAAQhC,EAAMkE,MAAMlC,OAAQuJ,WAAYvL,EAAMkE,MAAMqH,WAAW,IAGtF,IAAIL,GAAWnF,EAAGyF,OA8BlB,OA5BKhK,IAICT,EAAW+C,IAAIuC,EAAKxC,cAAcrC,EAAexB,MAC9CA,EAAM0B,MAAMC,YAAWsJ,EAAYQ,cAAgB,iBACxDR,EAAYpN,IAAMmC,EAAMnC,KAG1BoN,EAAY/N,GAAKsE,EAActE,GAC/B,GAAI4I,GAAMmF,GAAaS,KAAKX,EAAmBK,IAV7B,GAAItF,GAAMmF,GAAaU,MAAMZ,EAAmBK,GA4B7DF,EAASU,SAGlBvF,EAAKwF,UAAY,SAAmB7L,GAElC,MADAA,GAAM9C,GAAKmJ,EAAKyC,IACThD,EAAM+D,IAAI7J,GAAOyG,UAa1BJ,EAAKxC,cAAgB,SAAuBiI,EAAeC,GACzD,IAAKD,EAAe,OAAQhI,KAAK,EAEjC,IAAI9D,GAAQ+L,EAAaA,EAAa1F,CAEtC,QACEpG,OAAQD,EAAMC,QAAUD,EAAMC,SAAW6L,EAAc7L,OACvD8B,cAAe7D,QAAQ8N,OAAOhM,EAAM+B,cAAe,GAAI6G,MAAKkD,EAAc/J,gBAC1EC,OAAQqE,EAAKrE,QAAUhC,EAAMgC,SAAWiH,OAAO6C,EAAc9J,QAC7DH,SAAU7B,EAAM6B,UAAa7B,EAAM6B,SAASyI,OAASwB,EAAc9C,cAAcsB,KACjFxI,UAAW9B,EAAM8B,WAAc9B,EAAM8B,UAAUuI,OAASyB,EAAc/C,eAAesB,KACrFrG,kBAAmBhE,EAAMgE,oBAAsB8H,EAAc9H,oBAIjEqC,EAAK4F,WAAa,SAAoBpJ,GACpC,GAAIqI,GAAWnF,EAAGyF,OAmBlB,OAjBAxF,GAAQkG,MAAMC,aAAc9F,EAAK6C,OAAQkD,UAAW/F,EAAKyC,IAAKjG,KAAMA,IACjE4D,SAAS1B,KAAK,SAAiCC,GAChD,GAAInC,GAAOmC,EAAKnC,IAEhB3B,GAAmB0B,YACjB5D,MAAO,iCAAmC6D,EAAKwJ,MAAM,EAAG9E,GAA2B,IACnF1E,KAAMA,EACNC,UAAU,IAGZuD,EAAKK,SAASS,KAAKnC,GACnBkG,EAASC,QAAQnG,IAEhB,SAAUO,GACXvE,EAAgBuE,KAGX2F,EAASU,SAGlBvF,EAAKiG,aAAe,SAAsBC,GACxC,GAAIrB,GAAWnF,EAAGyF,QACd3I,EAAO0J,EAAQ1J,IAgCnB,OA9BA3B,GAAmB0B,YACjB5D,MAAO,kBAAoB6D,EAAKwJ,MAAM,EAAG9E,GAA2B,IACpE1E,KAAM,qEAAuEA,IAC5EkC,KAAK,SAAU6E,GACZA,IACF2C,EAAQC,YAAa,GAAK5D,OAAQ6D,SAElCzG,EAAQ6D,IAAI0C,GAAS9F,SAAS1B,KAAK,SAAkCC,GACnE9D,EAAmB0B,YACjB5D,MAAO,gCAAkC6D,EAAKwJ,MAAM,EAAG9E,GAA2B,IAClF1E,KAAMA,EACNC,UAAU,IAGZoI,EAASC,QAAQnG,EACjB,IAAI0B,KAEJL,GAAKK,SAASK,QAAQ,SAAUwF,GAC1BA,EAAQrP,KAAO8H,EAAK9H,IACxBwJ,EAASS,KAAKoF,KAGhBlG,EAAKK,SAAWA,GAEf,SAAUnB,GACXvE,EAAgBuE,QAKf2F,EAASU,SAGlBvF,EAAKqG,YAAc,SAAqB7J,EAAM0J,GAC5C,GAAIrB,GAAWnF,EAAGyF,OAmClB,OAjCAtK,GAAmB0B,YACjB5D,MAAO,iBAAmBuN,EAAQ1J,KAAKwJ,MAAM,EAAG9E,GAA2B,IAC3E1E,KAAM,mFAAqF0J,EAAQ1J,OAElGkC,KAAK,SAAU6E,GACZA,IACF2C,EAAQ1J,KAAOA,EAEfmD,EAAQ6D,IAAI0C,GAAS9F,SAAS1B,KAAK,SAAmCC,GACpE9D,EAAmB0B,YACjB5D,MAAO,iCAAmC6D,EAAKwJ,MAAM,EAAG9E,GAA2B,IACnF1E,KAAMA,EACNC,UAAU,IAGZoI,EAASC,QAAQnG,EAGjB,KAAK,GAFD0B,GAAWxI,QAAQyO,KAAKtG,EAAKK,UAExBuD,EAAQ,EAAG2C,EAAMlG,EAAStC,OAAgBwI,EAAR3C,EAAaA,IACtD,GAAIjF,EAAK9H,KAAOwJ,EAASuD,GAAO/M,GAAI,CAClCwJ,EAASuD,GAASjF,CAClB,OAIJqB,EAAKK,SAAWA,GAEf,SAAUnB,GACXvE,EAAgBuE,QAKf2F,EAASU,SAIpB,MAAO,IAAI3F,GAreb,GAAIhI,GAAMC,QAAQjB,OAAO,4BACvB,UACA,mBACA,mBACA,iBACA,mBAGFgB,GAAI4O,QAAQ,cAAe1L,GAE3BA,EAAY1C,SACV,eACA,kBACA,aACA,qBACA,aACA,kBACA,aACA,UACA,sBACA,QACA,KACA,YAqdG,SAASxB,EAAQD,EAASH,GAE/B,YAaA,SAASiQ,KACP,OACEC,SAAU,IACVtM,YAAa5D,EAAoB,GAAG6D,SAAS,4CAC7CsM,OAAO,EACPC,kBACEC,gBAAiB,KAEnBvO,WAAY,yCAahB,QAASwO,GAA2BtO,EAAQoC,EAAYmM,EAAgBjM,GAMtE,QAASsB,GAAKN,GACZV,EAAGzC,MAAQA,EACXmC,EAAYgD,kBACZhD,EAAY6F,MAAQ,KAEhB7E,GAAMlB,EAAWkB,IAClBA,KAAMA,EAAMC,UAAW,YAX5B,GAAIX,GAAKsB,IACTtB,GAAGzB,MAAQmB,CACX,IAAInC,GAAQ,6BAEZyD,KAWAhB,EAAG4L,cAAgB,SAAuBC,EAAOC,GAC/CpM,EAAYgD,eAAegD,KAAKoG,GAChCpM,EAAY6F,MAAQ,KACpBoG,EAAevO,EAAO2E,WAAY,UAGpC/B,EAAG+L,YAAc,SAAqBvD,GACpCxI,EAAGzB,MAAMmE,eAAeuF,OAAOO,EAAO,IAGxCxI,EAAGgM,WAAa,SAAoBtL,GAClChB,EAAYuH,cAAgBjH,EAAGzB,MAAMgC,QAAUP,EAAGzB,MAAMC,SAAWkB,EAAYuH,cAE1EvH,EAAYuH,cACZjH,EAAGzC,MAAQ,UADgByD,EAAKN,IAIvCtD,EAAO6O,OAAO,WAAqB,MAAOjM,GAAGzB,OAAQ,SAAUA,GAC7DyB,EAAGzB,MAAMwD,WAAa3E,EAAO2E,WAEzBxD,IACGA,EAAMgC,QAAWhC,EAAMC,QAC1BwC,EAAKtB,EAAYwM,cAGpB,GAEH9O,EAAO6O,OAAO,WAA6B,MAAOvM,GAAYuH,eAAgB,WAC5E7J,EAAO2E,WAAWwD,MAAM4G,cA1E5B,GAAI3P,GAAMC,QAAQjB,OAAO,YACvB,UACA,4BAGFgB,GAAI4P,UAAU,UAAWf,GAEzBA,EAAiBrO,WAcjBR,EAAIU,WAAW,6BAA8BwO,GAE7CA,EAA2B1O,SACzB,SACA,aACA,iBACA,eAmDFR,EAAI4P,UAAU,iBAAkB,WAC9B,OACEd,SAAU,IACVe,QAAS,UACTC,KAAM,SAAUlP,EAAQmP,EAAKC,EAAYC,GACvC,GAAIzM,GAAK5C,EAAOsP,OAChBD,GAAKE,YAAYrE,OAAS,WACxB,OAAQtI,EAAGzB,MAAM0I,eAAiB2F,QAAQ5M,EAAGzB,MAAMmE,eAAeC,cASrE,SAASnH,EAAQD,EAASH,GAE/B,YAUA,SAAS6D,GAAS4N,GAChB,MAAOC,GAAU7N,SAAS,OAAS,IAAM4N,EAT3C,GAAIC,GAAY1R,EAAoB,EAYpCI,GAAOD,SACL0D,SAAUA,IAMP,SAASzD,EAAQD,EAASH,GAE/B,YAMA,SAAS6D,GAAS4N,GAChB,MAAOtQ,GAAY0C,SAAS8N,EAASF,GALvC,GAAItQ,GAAcnB,EAAoB,GAElC2R,EAAU,kBAMdvR,GAAOD,SACL0D,SAAUA,EACV8N,QAASA,IAMN,SAASvR,EAAQD,GAEtB,YAeA,SAAS0D,GAAS8N,EAASF,GACzB,MAAOG,cAAeD,EAAU,OAASF,EAQ3C,QAASI,GAAgBzQ,GACvBA,EAAII,KAAK,aAAc,SAAUC,GAC/BA,EAAWmQ,aAAeA,aAC1BnQ,EAAWqQ,WAAaF,aAAe,gDAzB3C,GAAIrQ,IAA6B,uBAAwB,SAAUwQ,GACjEA,EAAqBC,YAAY,MACjCD,EAAqBE,UAAU,OA2BjC7R,GAAOD,SACLoB,0BAA2BA,EAE3BsC,SAAUA,EAEVqO,YAAa,cAEbL,gBAAiBA,IAMd,SAASzR,EAAQD,EAASH,GAE/B,YAWA,SAASiQ,KACP,OACEC,SAAU,IACVtM,YAAa5D,EAAoB,GAAG6D,SAAS,4CAC7CsM,OAAO,EACPC,kBACEjN,MAAO,aACPkE,MAAO,IACP8K,eAAgB,KAElBrQ,WAAY,yCAchB,QAASsQ,GAA2BpQ,EAAQqQ,EAAiBtJ,EAASuJ,EAAkBhO,GAMtF,QAASsB,GAAKN,GACZV,EAAGzC,MAAQA,EACXyC,EAAG2N,WAAa,KAChBjO,EAAY+C,SAER/B,IACFA,EAAKI,eACLJ,EAAKK,iBAZT,GAAIf,GAAKsB,IACTtB,GAAGzB,MAAQmB,CACX,IAAInC,GAAQ,gBACZyD,KAaAhB,EAAG4N,QAAU,SAAiBhF,EAAMiF,GAClC,MAAOH,GAAiBtQ,EAAQ,YAAawL,EAAMiF,IAGrD7N,EAAG8N,mBAAqB,SAAUC,GAChC,MAAIC,WAAUrL,YACP,WAAWsL,KAAKF,GAChBrO,EAAY+C,MAAMlC,OAASiH,OAAOuG,EAAInG,QAAQ,KAAM,KAD9BlI,EAAY+C,MAAMlC,OAAS,MAE1Cb,EAAY+C,MAAMlC,OAAS4D,EAAQ,UAAUzE,EAAY+C,MAAMlC,OAAQ,GAAK,IAG5FP,EAAGgM,WAAa,SAAoBtL,GAClChB,EAAYwH,cAAgBlH,EAAGzB,MAAMgC,QAAUP,EAAGzB,MAAMC,SAAWkB,EAAYwH,cAE1ExH,EAAYwH,eAIflH,EAAGzC,MAAQ,UACXyC,EAAG2N,WAAaF,EAChB/N,EAAY+C,MAAMlC,OAASP,EAAGzB,MAAMgC,QALpCS,EAAKN,IASTtD,EAAO6O,OAAO,WAAqB,MAAOjM,GAAGzB,OAAQ,SAAUA,GAC7DmB,EAAYmC,UAAYzE,EAAOyE,UAC3BtD,IACGA,EAAMgC,QAAWhC,EAAMC,QAC1BwC,EAAKtB,EAAYmC,cAGpB,GAjFL,GAAIrF,GAAMC,QAAQjB,OAAO,YACvB,UACA,4BAGFgB,GAAI4P,UAAU,UAAWf,GAEzBA,EAAiBrO,WAgBjBR,EAAIU,WAAW,6BAA8BsQ,GAE7CA,EAA2BxQ,SACzB,SACA,kBACA,UACA,mBACA,gBAyDG,SAASxB,EAAQD,EAASH,GAE/B,YAUA,SAAS8S,KACP,OACE5C,SAAU,IACVtM,YAAa5D,EAAoB,GAAG6D,SAAS,wCAC7CsM,OAAO,EACPrO,WAAY,qCAqBhB,QAASiR,GAAyB/Q,EAAQ+G,EAASuJ,EAAkBpO,EAAYyE,EAAcxE,EAC7DE,EAAoBC,EAAaF,EAAY4O,EAAQC,EAAWC,GAOhG,QAAStN,GAAKN,GAaZ,GAZAV,EAAGkD,kBACDqL,kBAAkB,EAClBC,gBAAgB,EAChBC,iBAAiB,GAEnBzO,EAAGzC,MAAQA,EACXyC,EAAGzB,MAAMuI,aAAc,EACvB9G,EAAGzB,MAAM0D,aAAc,EACvBjC,EAAG0O,UAAY,KACfhP,EAAY4C,OACZtC,EAAG2O,gBAAiB,EAEhBjO,EAAM,CACR,GAAIkO,IAAoB,kBAAmB,YAAa,sBACxDpP,GAAWkB,IAAQA,KAAMA,EAAMC,SAAUiO,MA0C7C,QAASC,KACP7O,EAAG0O,UAAUnO,OAASiH,OAAOxH,EAAG0O,UAAUnO,QAC1CP,EAAGzB,MAAM+D,IAAI/B,OAASP,EAAG0O,UAAUnO,OACnCP,EAAGzB,MAAM+D,IAAIwM,WAAa9O,EAAG0O,UAAUI,WACvC9O,EAAG0O,UAAUK,WAAa,GAAI5H,MAAKnH,EAAG0O,UAAUK,YAChD/O,EAAGzB,MAAM+D,IAAIyM,WAAa/O,EAAG0O,UAAUK,WACvC/O,EAAG0O,UAAUM,aAAehP,EAAG0O,UAAUM,aAAe,GAAI7H,MAAKnH,EAAG0O,UAAUM,cAAgB,KAC9FhP,EAAGzB,MAAM+D,IAAI0M,aAAehP,EAAG0O,UAAUM,aACzChP,EAAG0O,UAAU7E,SAAW7J,EAAG0O,UAAU7E,SAAW,GAAI1C,MAAKnH,EAAG0O,UAAU7E,UAAY,KAClF7J,EAAGzB,MAAM+D,IAAIuH,SAAW7J,EAAG0O,UAAU7E,SAGvC,QAASoF,GAAYC,GACnB,MAAOA,GAAQd,EAAOc,GAAOC,OAAO,eAAiB,KAGvD,QAASC,GAAgBC,GACvB,GAAI7G,GAAO8G,IAEX,KAAK9G,IAAS6G,GACZ,GAAIA,EAAW7G,GAAQ,CACrB,GAAIlG,GAAMiN,EAAa/G,EACnBlG,IAAKgN,EAAO5J,KAAKpD,GAIzB,MAAOgN,GA+CT,QAASE,GAAqBC,GAC5B,GAAIrO,GAAO,yBAA2BpB,EAAG0O,UAAUrJ,cAC/C1B,EAAMjE,EAAYU,SAASyI,IAsC/B,OApCK4G,GAAiBlP,SACpBa,GAAQ,mCACmBuC,EAAMQ,EAAQ,UAAUnE,EAAG0O,UAAUnO,OAAQ,GACtE,uBAAyBoD,EAAMQ,EAAQ,UAAUzE,EAAY4C,IAAI/B,OAAQ,IAGxEkP,EAAiBlN,oBACpBnB,GAAQ,0CACmBpB,EAAG0O,UAAUnM,kBACtC,uBAAyB7C,EAAY4C,IAAIC,mBAGxCkN,EAAiB5F,WACpBzI,GAAQ,iCACmB6N,EAAYjP,EAAG0O,UAAU7E,UAClD,uBAAyBoF,EAAYvP,EAAY4C,IAAIuH,WAGpD4F,EAAiBV,aACpB3N,GAAQ,qCACmB6N,EAAYjP,EAAG0O,UAAUK,YAClD,uBAAyBE,EAAYvP,EAAY4C,IAAIyM,aAGpDU,EAAiBT,eACpB5N,GAAQ,uCACmB6N,EAAYjP,EAAG0O,UAAUM,cAClD,uBAAyBC,EAAYvP,EAAY4C,IAAI0M,eAGpDS,EAAiBX,aACpB1N,GAAQ,mCACmBpB,EAAG0O,UAAUI,WACtC,uBAAyB9O,EAAGzB,MAAM+D,IAAIwM,YAGnC1N,EAqFT,QAASsO,KACP,OACEnP,OAAQP,EAAG0O,UAAUnO,SAAWb,EAAY4C,IAAI/B,OAChDgC,kBAAmBvC,EAAG0O,UAAUnM,oBAAsB7C,EAAY4C,IAAIC,kBACtEuM,WAAY9O,EAAG0O,UAAUI,aAAepP,EAAY4C,IAAIwM,WACxDC,WAAYtS,QAAQ8N,OAAOvK,EAAG0O,UAAUK,WAAYrP,EAAY4C,IAAIyM,YACpEC,aAAcvS,QAAQ8N,OAAOvK,EAAG0O,UAAUM,aAActP,EAAY4C,IAAI0M,cACxEnF,SAAUpN,QAAQ8N,OAAOvK,EAAG0O,UAAU7E,SAAUnK,EAAY4C,IAAIuH,WAIpE,QAAS0F,GAAa9T,GACpB,IAAK,GAAIkU,GAAW,EAAGA,EAAW3P,EAAGzB,MAAM0H,aAAatD,OAAQgN,IAAY,CAC1E,GAAIrN,GAAMtC,EAAGzB,MAAM0H,aAAa0J,EAEhC,IAAIrN,EAAI7G,MAAQA,EAAI,MAAO6G,GAG7B,MAAO,MAGT,QAASsN,GAAUC,GACjB7P,EAAG8P,gBAAkB,EAErBxQ,EAAWiH,KAAKsJ,EAAc,SAAUE,EAAStU,GAC3CsU,KAAW/P,EAAG8P,eAElB,IAAIxN,GAAMiN,EAAa9T,EACnB6G,KAAKA,EAAIyN,QAAUA,KAIrBrQ,EAAYuG,aAAatD,SAAW3C,EAAG8P,iBAAiB9O,IAG9D,QAASgP,KACPJ,EAAU5P,EAAG6P,cAzSf,GAAI7P,GAAKsB,IACTtB,GAAGzB,MAAQmB,CACX,IAAInC,GAAQ,iBACZyC,GAAG6P,gBAEH7O,IAoBAhB,EAAGmD,eAAiB,SAAwB8M,GAC1C3Q,EAAWiH,KAAKvG,EAAGkD,iBAAkB,SAAU6K,EAAKmC,GAClDlQ,EAAGkD,iBAAiBgN,GAAOD,IAASC,KAIxClQ,EAAG4N,QAAU,SAAUhF,EAAMiF,GAC3B,MAAOH,GAAiBtQ,EAAQ,UAAWwL,EAAMiF,IAGnD7N,EAAG8N,mBAAqB,SAAUC,GAChC,MAAIC,WAAUrL,YACP,WAAWsL,KAAKF,GAChB/N,EAAGzB,MAAM+D,IAAI/B,OAASiH,OAAOuG,EAAInG,QAAQ,KAAM,KADzB5H,EAAGzB,MAAM+D,IAAI/B,OAAS,MAGrCP,EAAGzB,MAAM+D,IAAI/B,OAAS4D,EAAQ,UAAUnE,EAAGzB,MAAM+D,IAAI/B,OAAQ,GAAK,MAGlFP,EAAGgM,WAAa,SAAoBtL,GAClCV,EAAGzB,MAAMuI,YAAc9G,EAAGzB,MAAMgC,QAAUP,EAAGzB,MAAMC,SAAWwB,EAAGzB,MAAMuI,YAElE9G,EAAGzB,MAAMuI,aAEZ9G,EAAG2O,gBAAiB,EACpB3O,EAAGzC,MAAQ,UACXmC,EAAY4C,IAAIC,kBAAoB7C,EAAY6C,kBAChDvC,EAAGzB,MAAM+D,IAAI/B,OAAUP,EAAGzB,MAAM0H,aAAatD,OAA8B,KAArBjD,EAAYa,QALzCS,EAAKN,IASlCV,EAAGmQ,eAAiB,SAAwBzP,GAC1C,MAAIpB,GAAWkD,QAAQxC,EAAG0O,YAAmB,EAEzChO,EAAKiB,UAAiB,EAEnBrC,EAAW+C,IAAIqN,MAgCxB1P,EAAGoQ,UAAY,SAAmBP,EAAcnP,GAC9C,GAAIrC,GAAO+Q,EAAgBS,EACP,KAAhBxR,EAAKsE,SACTjC,EAAKI,eACLd,EAAGzB,MAAM0D,aAAc,EACvBjC,EAAGzB,MAAMuI,aAAc,EACvB9G,EAAGgM,aACHhM,EAAG0O,UAAYjS,QAAQyO,KAAK7M,EAAK,IACjCwQ,MAGF7O,EAAGqQ,SAAW,SAAkBR,GAsB9B,QAASS,KACP7Q,EAAmB0B,YACjBC,KAAM,2BAA6BA,EACnC7D,MAAO,WAAauF,EAAK,wBACzBzB,UAAU,IAEZ3B,EAAYqG,UACZ/F,EAAG6P,gBA5BL,GAAIxR,GAAO+Q,EAAgBS,EAC3B,IAAoB,IAAhBxR,EAAKsE,OAAT,CACA3B,GACA,IAAIsB,GAAMjE,EAAK,GACX+C,EAAO,oBACWkB,EAAIjC,UACxB,kBAAoBiC,EAAI+C,cACxB,kBAAoB/C,EAAIlC,SAAW,IAAM+D,EAAQ,UAAU7B,EAAI/B,OAAQ,GAErEuC,EAAK,IAAMR,EAAI+C,cAAgB,GAEnC5F,GAAmB0B,YACjBC,KAAM,+BAAiCA,EAAM7D,MAAO,kBAAoBuF,IACvEQ,KAAK,SAAU6E,GACZA,GACFpE,EAAAA,UAAoBzB,GAAK0C,SAAS1B,KAAKgN,EAAkB,SAA0BxM,GACjFvE,EAAgBuE,SA2DxB9D,EAAGuQ,QAAU,WAcX,QAASC,KACP,GAAIlO,GAAM7F,QAAQyO,KAAKlL,EAAG0O,UAErBe,GAAiBlN,oBACpBD,EAAImO,0BAA2B,EAC/B/Q,EAAY6C,kBAAoB7C,EAAY4C,IAAIC,mBAGlDjD,EAAWiH,KAAK7G,EAAY4C,IAAK,SAAUyL,EAAKmC,IAClC,eAARA,GAAgC,iBAARA,GAAkC,aAARA,KAAoBnC,EAAMM,EAAUN,IAC1FzL,EAAI4N,GAAOnC,IAGbhK,EAAaqE,IAAI9F,GAAK0C,SAAS1B,KAAK,WAClC7D,EAAmB0B,YAAY5D,MAAOA,EAAO6D,KAAM,oBAAsBA,EAAMC,UAAU,IACzFL,IACAtB,EAAYqG,QAAQiK,IAEnB,SAAUlM,GACXvE,EAAgBuE,KAhCpB,GAAIvG,GAAQ,aAAeyC,EAAG0O,UAAUrJ,cAAgB,IACpDoK,EAAmBC,IACnBtO,EAAOoO,EAAqBC,EAGhChQ,GAAmB0B,YACjB5D,MAAOA,EACP6D,KAAM,qCAAuCA,IAC5CkC,KAAK,SAAU6E,GACZA,EAAQqI,IACP3B,OA2BT7O,EAAG0Q,cAAgB,SAAUb,GAC3B,GAAIxR,GAAO+Q,EAAgBS,EACP,KAAhBxR,EAAKsE,SACT3B,IACAsN,EAAcnN,YAAYmB,IAAKjE,EAAK,OAGtC2B,EAAG2Q,WAAa,SAAoBd,GAClC,GAAIxR,GAAO+Q,EAAgBS,EAC3B,IAAoB,IAAhBxR,EAAKsE,OAAT,CACA,GAAIL,GAAMjE,EAAK,EACf2B,GAAGzB,MAAMuI,aAAc,EACvB9G,EAAGzC,MAAQA,EAEXyC,EAAG4Q,iBACDxQ,SAAUV,EAAYU,SACtBsK,aAAcpI,EAAImF,OAClBkD,UAAWrI,EAAI7G,IAEjBuE,EAAG6Q,gBAAkB,eAAiB1M,EAAQ,UAAU7B,EAAI/B,OAAQ,GACpEP,EAAG2O,gBAAiB,IAGtB3O,EAAG8Q,cAAgB,SAAuBxB,GACxC,QAASyB,GAAUhD,GACjB,MAAOuB,GAAO/H,cAAcsB,KAAO,IAAM1E,EAAQ,UAAU4J,EAAK,GAGlE,GAAI3M,GAAO,uBACgBkO,EAAO0B,YAChC,uBAAyB7M,EAAQ,QAAQmL,EAAO2B,aAAc,eAC9D,uBAAyBF,EAAUzB,EAAO5I,kBAC1C,uBAAyBqK,EAAUzB,EAAO3I,iBAC1C,uBAAyBxC,EAAQ,QAAQmL,EAAO4B,YAAa,cAE/DzR,GAAmB0B,YAAY5D,MAAO,qBAAsB6D,KAAMA,EAAMC,UAAU,IAClFL,IACAtB,EAAYqG,QAAQiK,IAGtBhQ,EAAGmR,0BAA4B,WAC7BnR,EAAG2O,gBAAiB,GA0CtBvR,EAAO6O,OAAO,WAA2B,MAAOvM,IAAc,SAA8BnB,GAC1FmB,EAAYoC,QAAU1E,EAAO0E,QAEzBvD,IACGA,EAAMgC,QAAWhC,EAAMC,SAC1BwC,EAAKtB,EAAYoC,SACjB9B,EAAG6P,gBACH7P,EAAG8P,gBAAkB,MAGxB,GAEH1S,EAAO6O,OAAO,WAA4B,MAAOjM,GAAG6P,cAAe,SAA+BA,GAC5FA,GAAcD,EAAUC,KAC3B,GA5VL,GAAIrT,GAAMC,QAAQjB,OAAO,UAAW,oBAAqB,kBAEzDgB,GAAI4P,UAAU,QAAS8B,GAEvBA,EAAelR,WAWfR,EAAIU,WAAW,2BAA4BiR,GAE3CA,EAAyBnR,SACvB,SACA,UACA,mBACA,aACA,eACA,kBACA,qBACA,cACA,aACA,SACA,YACA,kBAqUG,SAASxB,EAAQD,EAASH,GAE/B,YAaA,SAASgW,KACP,OACE9F,SAAU,IACVtM,YAAa5D,EAAoB,GAAG6D,SAAS,0CAC7CsM,OAAO,EACPrO,WAAY,mDAehB,QAASmU,GAAgCjU,EAAQsQ,EAAkBpO,EAAYG,EAAoBC,EACjGF,GAOA,QAASwB,GAAKN,GACZV,EAAGzC,MAAQA,EACXyC,EAAGzB,MAAM2D,iBAAkB,EAC3BlC,EAAGzB,MAAMyI,iBAAkB,EAC3BhH,EAAGsR,cAAgB,KACnB5R,EAAYqH,YAAc,KAEtBrG,GAAMlB,EAAWkB,GAbvB,GAAIV,GAAKsB,IACTtB,GAAGzB,MAAQmB,CACX,IAAInC,GAAQ,cACRuI,EAA0B,EAE9B9E,KAWAhB,EAAG4N,QAAU,SAAUhF,EAAMiF,GAAY,MAAOH,GAAiBtQ,EAAQ,cAAewL,EAAMiF,IAE9F7N,EAAGgM,WAAa,SAAoBtL,GAClCV,EAAGzB,MAAM2D,gBAAkBxC,EAAY2H,MAAQrH,EAAGzB,MAAM2D,gBAEnDlC,EAAGzB,MAAM2D,gBACTlC,EAAGzC,MAAQ,UADeyD,EAAKN,IAItCV,EAAGuR,mBAAqB,SAA4B7Q,GAClD,MAAIpB,GAAWkD,QAAQxC,EAAGsR,gBAAkB5Q,EAAKiB,UAAiB,EAE3D3B,EAAGsR,cAAclQ,OAAS1B,EAAYqH,aAG/C/G,EAAGwR,kBAAoB,SAA2B1G,GAChD9K,EAAGzB,MAAMyI,iBAAkB,EAC3BhH,EAAGzB,MAAM2D,iBAAkB,EAC3BlC,EAAGgM,aACHhM,EAAGsR,cAAgB7U,QAAQyO,KAAKJ,GAChCpL,EAAYqH,YAAc/G,EAAGsR,cAAclQ,MAG7CpB,EAAGyR,YAAc,SAAqB3G,GACpCrL,EAAmB0B,YACjB5D,MAAO,iBAAmBuN,EAAQ1J,KAAKwJ,MAAM,EAAG9E,GAA2B,IAC3E1E,KAAM0J,EAAQ1J,KACdC,UAAU,KAIdrB,EAAGiL,YAAc,SAAqB7J,EAAMV,GAC1ChB,EAAYuL,YAAY7J,EAAMpB,EAAGsR,eAAehO,KAAK,WAAatC,EAAKN,MAGzEV,EAAGwK,WAAa,SAAoBpJ,EAAMV,GACxChB,EAAY8K,WAAWpJ,GAAMkC,KAAK,WAActC,EAAKN,MAGvDtD,EAAO6O,OAAO,WAAa,MAAOvM,IAAc,SAA8BnB,GAC5EmB,EAAYsC,YAAc5E,EAAO4E,YAE7BzD,IACGA,EAAMgC,QAAWhC,EAAMC,QAAQwC,EAAKtB,EAAYsC,gBAEtD,GA5FL,GAAIxF,GAAMC,QAAQjB,OAAO,kBACvB,UACA,mBAGFgB,GAAI4P,UAAU,eAAgBgF,GAE9BA,EAAsBpU,WAWtBR,EAAIU,WAAW,kCAAmCmU,GAElDA,EAAgCrU,SAC9B,SACA,mBACA,aACA,qBACA,cACA,eAwEG,SAASxB,EAAQD,EAASH,GAE/B,YAgBA,SAASsW,GAAa1V,GAEpBA,EACGG,MAAM,eAELE,YAAa,OAEb0C,OACEV,MACE/B,SAAUlB,EAAoB,IAE9B8B,WAAY,sCAkBtB,QAASyU,GAAqB5N,EAAc3G,EAAQwU,EAAOC,EAAWC,EAAMxS,EAAY4E,EAAY6N,EAAUzN,GAI5G,QAAS7D,KACPT,EAAG6P,gBACH7P,EAAGgS,0BAQHhS,EAAGiS,eACHjS,EAAGkS,mBAEElE,UAAUrL,QACboB,EAAaoO,UAAUnN,SAAS1B,KAAK,SAAUC,GAC7C6O,EAAW7O,KAkBjB,QAAS8O,GAAoBC,GAC3BV,EAAMW,IAAID,GAAShP,KAAK,SAAUkP,GAChCJ,EAAWI,EAASjP,QAoBxB,QAAS6O,GAAW7O,GAClBvD,EAAGiS,YAAc1O,EAAK6C,QACtBpG,EAAGkS,iBAAmBO,KAAMlP,EAAKkP,KAAMC,SAAUnP,EAAKmP,SAAUvM,MAAO5C,EAAK4C,OA2B9E,QAASwM,GAAsBC,GACzBA,IAAkBtT,EAAWkD,QAAQoQ,IACvCtT,EAAWiH,KAAKqM,EAAe,SAAU7C,EAAS8C,GAChD,GAAIvQ,GAAMiN,EAAasD,EAEnBvQ,IAAOA,EAAIwM,aAAY9O,EAAGgS,uBAAuBa,GAAS9C,KA2CpE,QAASR,GAAasD,GACpB,IAAK,GAAIrK,GAAQ,EAAGA,EAAQxI,EAAGiS,YAAYtP,OAAQ6F,IAAS,CAC1D,GAAIlG,GAAMtC,EAAGiS,YAAYzJ,EACzB,IAAIlG,EAAI7G,MAAQoX,EAAO,MAAOvQ,GAGhC,MAAO,MA7IT,GAAItC,GAAKsB,IAETb,KAyBAT,EAAG8S,cAAgB,SAAuBxQ,GACxClF,EAAOqB,UAAU6D,EAAI+C,gBAOvBrF,EAAGqS,oBAAsBA,EAOzBrS,EAAG+S,eAAiB,SAAwBzD,GAC1C7O,GAAW,GACX2R,EAAW9C,IAGblS,EAAO6O,OAAO,WAA8B,MAAOjM,GAAGgT,mBACpD,SAAkCA,GAC5BA,GACFZ,EAAWY,IAajB,IAAI5W,GAAMyV,EAAUC,EAAKmB,wBACzBjT,GAAGkT,YAAc,WACf,IAAK5T,EAAWkD,QAAQxC,EAAG6P,cAAe,CACxC,GAAIsD,KAMJ,OAJA7T,GAAWiH,KAAKvG,EAAG6P,aAAc,SAAUuD,EAAWP,GAChDO,KAAc,GAAMD,EAAOzN,KAAKmN,KAG/BM,EAAOxQ,OAASvG,EAAI+W,QAAQE,QAASF,IAASG,WAAa,KAGpE,MAAO,OAGTtT,EAAGuT,oBAAsB,WACvB,MAAIjU,GAAWkD,QAAQxC,EAAG6P,eAAsB,GAExCvQ,EAAWkU,IAAIxT,EAAG6P,aAAc,SAAU4D,GAChD,MAAOA,MAAiB,KAI5BzT,EAAG2S,sBAAwBA,EAW3B3S,EAAG0T,yBAA2B,WAC5B,GAAIpU,EAAWkD,QAAQxC,EAAGgS,wBAAyB,OAAO,CAE1D,KAAK,GAAIa,KAAS7S,GAAG6P,aACnB,KAAMgD,IAAS7S,GAAGgS,yBAA2BhS,EAAG6P,aAAagD,GAAQ,OAAO,CAG9E,QAAQvT,EAAWkU,IAAIxT,EAAGgS,uBAAwB,SAAUjC,GAC1D,MAAOA,MAAY,KAIvB/P,EAAG2T,cAAgB,WACjB,GAAIC,KAEJtU,GAAWiH,KAAKvG,EAAGgS,uBAAwB,SAAUjC,EAAS8C,GAC5D,GAAK9C,EAAL,CAEA,GAAIzN,GAAMiN,EAAasD,EACnBvQ,KACFA,EAAI0M,aAAe9K,EAAW,GAAIiD,OAClCyM,EAAWlO,KAAK3B,EAAaqE,IAAI9F,GAAK0C,cAItC4O,EAAWjR,QACb2B,EAAGjC,IAAIuR,GAAYtQ,KAAK,WACtB7C,OAKNT,EAAG6T,YAAc,WACV7T,EAAGuT,uBACNxB,EAAS,WAAatR,KAAe,MA7K3CrF,EAAoB,GAEpB,IAAIoB,GAAMC,QAAQjB,OAAO,eACvB,YACA,iBACA,UACA,aACA,eAGFgB,GAAIE,OAAOgV,GACXA,EAAa1U,SAAW,kBAkBxBR,EAAIU,WAAW,uBAAwByU,GACvCA,EAAqB3U,SACnB,eACA,SACA,QACA,YACA,OACA,aACA,aACA,WACA,MAoJF5B,EAAoB,KAKf,SAASI,EAAQD,EAASH,GAE/B,YAcA,SAAS0Y,KACP,OACExI,SAAU,KACVhP,SAAUlB,EAAoB,IAC9BmQ,OAAO,EACPC,kBACEuH,eAAgB,KAElB7V,WAAY,sCAahB,QAAS6W,GAAqBhQ,EAAczE,EAAYH,EAAsBC,EAAsBI,EAClG6O,GAKA,QAASrN,KACPhB,EAAGgU,cACD7B,SAAS,GANb,GAAInS,GAAKsB,IACTtB,GAAGiU,UAAW,EAEdjT,IAOAhB,EAAGgM,WAAa,SAAoBtL,GAClCV,EAAGiU,UAAYjU,EAAGiU,SAEbjU,EAAGiU,UAAUjU,EAAGkU,UAAUxT,IAGjCV,EAAGmU,YACD9T,WACE4N,KAAM,WACJ,MAAO3O,GAAW8U,SAASpU,EAAGgU,aAAa3T,aAI/CD,UACE6N,KAAM,WACJ,MAAO3O,GAAW8U,SAASpU,EAAGgU,aAAa5T,aAIjDJ,EAAGgD,YAAc5D,EACjBY,EAAG+C,aAAe5D,EAClBa,EAAGkD,kBAAmB,EACtBlD,EAAGmD,eAAiB,WAClBnD,EAAGkD,kBAAmB,GAGxBlD,EAAGkU,UAAY,SAAmBxT,GAChClB,EAAWkB,GACXM,KAGFhB,EAAGqU,WAAa,SAAoBL,GAClC,GAAInV,GAASpC,QAAQyO,KAAK8I,EAC1BnV,GAAOwB,UAAYxB,EAAOwB,UAAY,OAAO8I,KAAKtK,EAAOwB,UAAUjE,KAAK,GAAK,KAC7EyC,EAAOuB,SAAWvB,EAAOuB,SAAWvB,EAAOuB,SAASyI,KAAO,KAC3DhK,EAAOkQ,WAAalQ,EAAOkQ,WAAaV,EAAUxP,EAAOkQ,YAAc,KAElElQ,EAAOsT,eAAgBtT,GAAOsT,QAEnCpO,EAAamC,aAAarH,GAAQmG,SAAS1B,KAAK,SAAUC,GACxDvD,EAAG+S,gBAAgBuB,aAAc/Q,OAnFvC,GAAI/G,GAAMC,QAAQjB,OAAO,eACvB,WACA,iBACA,WAGFgB,GAAI4P,UAAU,aAAc0H,GAE5BA,EAAoB9W,WAcpBR,EAAIU,WAAW,uBAAwB6W,GACvCA,EAAqB/W,SACnB,eACA,aACA,uBACA,uBACA,aACA,cA8DG,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU,mwHAIZ,SAASC,EAAQD,GAEtBC,EAAOD,QAAU,sgCAIZ,SAASC,EAAQD,EAASH,GAE/B,YASA,SAASmZ,KACP,OACEjJ,SAAU,KAEVtM,YAAawV,EAAavV,SAAS,4DAEnCsM,OAAO,EAEPC,kBACEnN,KAAM,eAENoW,iBAAkB,IAElB9B,sBAAuB,IAEvB+B,MAAO,eAEPC,WAAY,iBAEZC,eAAgB,IAEhB/E,aAAc,KAGhB3S,WAAY,8CAYhB,QAAS2X,GAA+BC,EAAoBvJ,EAAOjM,GAKjE,QAASyV,GAAWtC,EAAMuC,EAAM7O,GAC9BnG,EAAGmG,MAAQA,CACX,IAAI8O,GAAWC,KAAKC,KAAKhP,EAAQnG,EAAG4U,gBAEhCQ,EAAiBN,EAAmBrC,EAAMuC,EAAMC,EAEpDjV,GAAGqV,aAAe5C,EAClBzS,EAAGsV,aAAeN,EAElBhV,EAAGuV,SAAWH,EAAeG,SAC7BvV,EAAGwV,YAAcJ,EAAeI,YAShCxV,EAAGyV,gBAAkBzV,EAAGwV,YAAc,GAAKxV,EAAG4U,eAIhD,QAASc,GAAmBpD,GAC1BtS,EAAGyU,kBAAkBnC,QAASA,IAShC,QAASqD,KACP3V,EAAG3B,KAAKiH,QAAQ,SAAUhD,GACxBA,EAAIsT,aAAc,IAKtB,QAASC,GAAgBC,GAClBA,EAAMhH,aACT6G,IAGAG,EAAMF,aAAetW,EAAWkU,IAAIxT,EAAG3B,KAAM,SAAUiE,GACrD,MAAOA,GAAIyN,WAlDjB,GAAI/P,GAAKsB,IAETtB,GAAG6P,gBAwBH7P,EAAG0V,mBAAqBA,EAKxBnK,EAAMU,OAAO,WAAqB,MAAOjM,GAAG0U,OAAQ,SAAsBA,GACpEA,IAAUpV,EAAWkD,QAAQkS,IAC/BK,EAAWL,EAAMjC,KAAMiC,EAAMhC,SAAUgC,EAAMvO,SAUjDnG,EAAG6V,gBAAkBA,EAYrB7V,EAAG+V,cAAgB,SAAuBzT,GACxCtC,EAAG2U,YAAYrS,IAAKA,KAGtBiJ,EAAMU,OAAO,WAA4B,MAAOjM,GAAG6P,cAAe,SAA6BA,GAC7F7P,EAAG2S,uBAAuBC,cAAe/C,IAErCA,IAAiBvQ,EAAWkD,QAAQqN,KAEtCvQ,EAAWiH,KAAKsJ,EAAc,SAAUE,EAAStU,GAE/C,IAAK,GAAIkU,GAAW,EAAGA,EAAW3P,EAAG3B,KAAKsE,OAAQgN,IAAY,CAC5D,GAAIrN,GAAMtC,EAAG3B,KAAKsR,EACdrN,GAAI7G,MAAQA,IACd6G,EAAIyN,QAAUA,MAMpB/P,EAAGgW,UAAY1W,EAAW+C,IAAIrC,EAAG3B,KAAM,SAAUiE,GAC/C,MAAOA,GAAIyN,WAAY,OAG1B,GAEH/P,EAAGgW,WAAY,EAEfhW,EAAGiW,iBAAmB,WACpBjW,EAAG3B,KAAKiH,QAAQ,SAAUhD,GACxBtC,EAAG6P,aAAavN,EAAI7G,KAAO6G,EAAI0M,cAAgBhP,EAAGgW,aA/HxD,GAAIxB,GAAepZ,EAAoB,GAEnCoB,EAAMC,QAAQjB,OAAO,cAEzBgB,GAAI4P,UAAU,oBAAqBmI,GA6BnC/X,EAAIU,WAAW,iCAAkC2X,GAEjDA,EAA+B7X,SAC7B,qBACA,SACA;EAiGG,SAASxB,EAAQD,EAASH,GAE/B,YAcA,SAAS8a,GAAmBla,GAE1BA,EACGG,MAAM,eACLE,YAAa,cAEb0C,OACEZ,WACE7B,SAAUlB,EAAoB,IAE9B8B,WAAY,uCAQtB,QAASiZ,GAAoB9R,EAAOkH,EAAO6K,EAAmBxE,GAkB5D,QAASyE,GAAa9S,GACpBvD,EAAGsW,OAAS/S,EAAK6C,QAEjBpG,EAAGkS,iBAAmBO,KAAMlP,EAAKkP,KAAMC,SAAUnP,EAAKmP,SAAUvM,MAAO5C,EAAK4C,OAiC9E,QAASoQ,GAA+BjE,GACtCV,EAAMW,IAAID,GAAShP,KAAK,SAAUkP,GAChC6D,EAAa7D,EAASjP,QAvD1B,GAAIvD,GAAKsB,IAOTtB,GAAGwW,aAAeJ,EAElBpW,EAAGyW,iBAAmB,SAA0BlY,GAC9CgN,EAAM9M,UAAUF,EAAMC,SAaxBwB,EAAGqW,aAAeA,EAMlBrW,EAAGkS,mBAQHlS,EAAGsW,UACHjS,EAAMqS,kBAAkB1R,SAAS1B,KAAK,SAAUC,GAC9C8S,EAAa9S,KAOfvD,EAAG2W,aAAe,SAElB3W,EAAGuW,+BAAiCA,EAepCvW,EAAG4W,oBAAsB,KAEzBrL,EAAMU,OAAO,WAAwB,MAAOjM,GAAG4W,qBAAsB,SAAUA,GACzEA,GAAqBP,EAAaO,KAjG1C,GAAIpa,GAAMC,QAAQjB,OAAO,eACtB,UACA,YACA,iBACA,gBACA,cACA,WACA,cAGHgB,GAAIE,OAAOwZ,GACXA,EAAmBlZ,SAAW,kBAiB9BR,EAAIU,WAAW,sBAAuBiZ,GACtCA,EAAoBnZ,SAAW,QAAS,SAAU,oBAAqB,UA2ElE,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU,yjBAIZ,SAASC,EAAQD,EAASH,GAE/B,YAkBA,SAASiE,GAAqCwX,EAAatX,EAAiBuX,EAAcxX,EAAYgF,EAAID,GAExG,QAASpD,GAAY8V,GAYnB,QAASC,GAAmBzT,GAC1BkG,EAASC,SAASjG,gBAAiBF,IAGrC,QAAS0T,GAAiBnT,GACxBvE,EAAgBuE,GAChB2F,EAASG,OAAO9F,GAjBlB,GAAI2F,GAAWnF,EAAGyF,QACdjH,EAAKiU,EAAsBjU,GAAGD,MAmBlC,OAjBAwB,GAAM6B,cAAc1H,OAAQsE,IAAKkC,SAAS1B,KAAK,SAAUC,GACpC,IAAfA,EAAK4C,MACPsD,EAASC,SAASlL,OAAQ+E,EAAK6C,QAAQ,GAAG5H,SAErCqY,EAAYnS,OAAO5B,GAAIA,IAAKkC,SAAS1B,KAAK0T,EAAoBC,IAEpEA,GAWIxN,EAASU,QAGlB,QAAS+M,KAIP,QAAS7T,KACP,GAAIoG,GAAWnF,EAAGyF,OA0BlB,OAxBA+M,GAAaK,WACXnY,YAAa5D,EAAoB,GAAG6D,SAClC,2FAEF/B,WAAY,8EACXoG,KAAK,SAAU8T,GAChBA,EAAMC,QAAQC,QACZC,YAAa,WACbH,OAAO,EACPI,SAAU,IACVja,MAAO,gBAEPka,MAAO,WACLL,EAAMla,WAAWua,WAIrBL,EAAMK,MAAMnU,KAAK,SAAUyT,GACrBA,GAAyBta,QAAQ2X,SAAS2C,KAA2BzX,EAAWkD,QAAQuU,IAC1FtN,EAASC,QAAQzI,EAAY8V,QAK5BtN,EAASU,QA9BlB,GAAIuN,GAAUpW,IAEdoW,GAAQrU,gBAAkBA,EAgC5B,MAAO,IAAI6T,GASb,QAASS,GAA8CF,EAAOG,EAAWP,GAIvE,QAASQ,KACP7X,EAAGgU,gBAML,QAASzS,GAAMb,GACbkX,EAAUlX,EAAM2W,EAAS,gBAAiBQ,GAC1CnX,EAAKiB,UAAW,EAChBjB,EAAKoX,UAbP,GAAI9X,GAAKsB,IAETuW,KAKA7X,EAAGyX,MAAQA,EAEXzX,EAAGuB,MAAQA,EA/Fb,GAAI/E,GAAMC,QAAQjB,OAAO,sCACvB,wBACA,qBACA,kBAGFgB,GAAI4O,QAAQ,uCAAwC/L,GACpDA,EAAqCrC,SACnC,cACA,kBACA,eACA,aACA,KACA,SAkEFR,EAAIU,WAAW,gDAAiDya,GAChEA,EAA8C3a,SAC5C,QACA,YACA,aAuBG,SAASxB,EAAQD,EAASH,GAE/B,YAeE,SAAS2c,KACT,OACEzM,SAAU,KACVhP,SAAUlB,EAAoB,IAC9BmQ,OAAO,EACPC,kBACEwM,WAAY,KAEd9a,WAAY,qCAahB,QAAS+a,GAAsB5T,EAAO/E,EAAYH,EAAsBC,EAAsBI,EAC5F6O,GAKA,QAASrN,KACPhB,EAAGgU,cACDkE,WAAW,GANf,GAAIlY,GAAKsB,IACTtB,GAAGiU,UAAW,EAEdjT,IAOAhB,EAAGgM,WAAa,SAAoBtL,GAClCV,EAAGiU,UAAYjU,EAAGiU,SAEbjU,EAAGiU,UAAUjU,EAAGkU,UAAUxT,IAGjCV,EAAGgD,YAAc5D,EACjBY,EAAG+C,aAAe5D,EAClBa,EAAGkD,kBAAmB,EACtBlD,EAAGmD,eAAiB,WAClBnD,EAAGkD,kBAAmB,GAGxBlD,EAAGkU,UAAY,SAAmBxT,GAChClB,EAAWkB,GACXM,KAGFhB,EAAGmY,SAAW,SAAkBnE,GAC9B,GAAInV,GAASpC,QAAQyO,KAAK8I,EAC1BnV,GAAOuZ,aAAevZ,EAAOwZ,aAAe,OAAOlP,KAAKtK,EAAOwZ,aAAajc,KAAK,GAAK,KACtFyC,EAAOuB,SAAWvB,EAAOuB,SAAWvB,EAAOuB,SAASyI,KAAO,KAC3DhK,EAAOkQ,WAAalQ,EAAOkQ,WAAaV,EAAUxP,EAAOkQ,YAAc,KAElElQ,EAAOqZ,iBAAkBrZ,GAAOqZ,UAErC7T,EAAM6B,aAAarH,GAAQmG,SAAS1B,KAAK,SAAUC,GACjDvD,EAAGgY,YAAY1D,aAAc/Q,OAvEnC,GAAI/G,GAAMC,QAAQjB,OAAO,iBACvB,WACA,iBACA,UACA,4BAGFgB,GAAI4P,UAAU,WAAY2L,GAE1BA,EAAkB/a,WAclBR,EAAIU,WAAW,wBAAyB+a,GACxCA,EAAsBjb,SACpB,QACA,aACA,uBACA,uBACA,aACA,cAiDG,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU,+oHAIZ,SAASC,EAAQD,EAASH,GAE/B,YAmBA,SAASkd,GAAqBtc,GAE5BA,EACGG,MAAM,iBACLE,YAAa,gBAEb0C,OACEwZ,aACEjc,SAAUlB,EAAoB,IAE9B8B,WAAY,2CAStB,QAASsb,GAAsB3B,EAAatX,EAAiBkZ,EAAkBrb,GAK7E,QAASsb,GAAQhY,GACfV,EAAG2Y,oBAAqB,EACxB3Y,EAAG4Y,eAAgB,EACnB5Y,EAAG6Y,kBAAmB,EACtB7Y,EAAG8Y,qBAAuB,wCAC1B9Y,EAAG+Y,gBAAkB,GAEjBrY,IACFA,EAAKI,eACLJ,EAAKK,iBAIT,QAASiY,KACPhZ,EAAG2Y,oBAAqB,EACpB3Y,EAAG6Y,kBAAkBH,EAAQtb,EAAO6b,iBAnB1C,GAAIjZ,GAAKsB,IACTtB,GAAGkZ,WAAa,mDAEhBR,IAmBA1Y,EAAGmZ,iBAAmB,WACpBH,KAGFhZ,EAAGuY,YAAc,SAAqBnX,GAUpC,QAASgY,GAAUC,GACjB,GAAIC,GAAS,8BACTnQ,EAAOmQ,EAAOnQ,KAAKkQ,EAEvB,KAAKlQ,EAAM,MAAO,KAElB,IAAIoQ,IAASpQ,EAAK,GAAGtG,MAErB,OAAI0W,GAAQ,GAAW,KAEhBpQ,EAAK,GAAK,IAAMoQ,EAAQ,IAAMpQ,EAAK,GAkD5C,QAASqQ,GAAoBjW,GAC3B,GAAIkW,GAAiBlW,EAAKmW,aACxBC,EAAgBF,EAAe9W,OAC/BiX,EAAuBC,EAAUlX,OAASgX,CAE5C3Z,GAAG8Y,qBAAuB,8EACQa,EAAgB,KAC9CC,IACF5Z,EAAG8Y,sBAAyB,4CAA8Cc,GAI9E,QAASE,GAAkBhW,GACzB9D,EAAG6Y,kBAAmB,EACtB7Y,EAAG4Y,eAAgB,EACnB5Y,EAAG8Y,qBAAuB,wBAC1BvZ,EAAgBuE,GArFlB9D,EAAG6Y,kBAAmB,EACtB7Y,EAAG2Y,oBAAqB,CACxB,IACIoB,GACAjX,EACAvE,EACAyb,EACAX,EALAY,IAoBJ,KACEC,KAAKC,MAAM/Y,GACTgZ,UAAW,IACXzR,QAAQ,EACR0R,KAAM,SAAU9W,GAMd,GALAwW,EAAMxW,EAAKA,KAAK,GAChBT,EAAKiX,EAAI,UAAUlX,OACnBmX,EAAKD,EAAI,UAAUlX,OACnBwW,EAAKD,EAAUW,EAAI,oBAEdV,EAAI,KAAM,IAAIiB,OAAM,0BAA4BxX,EAAK,MAAQ9C,EAAGkZ,WAErE3a,IACEyb,GAAIA,EACJlX,GAAIA,EACJa,IAAKoW,EAAIQ,SAAS1X,OAClBxC,UAAW0Z,EAAI,kBAAkBlX,OACjC2X,IAAKT,EAAIU,IAAI7S,QAAQ,SAAU,IAC/BlE,aAAcqW,EAAI,oBAAoBnS,QAAQ,SAAU,IACxD8S,aAAcrB,EACdsB,aAActB,EACd9W,kBAAmBwX,EAAIa,MAAM/X,QAG3B4V,EAAiB7W,IAAIqY,EAAUnX,GACT,cAApBiX,EAAIc,KAAKhY,QACXtE,EAAMmc,aAAeT,EAASnX,GAAI4X,aAClCT,EAASnX,GAAMvE,GAEc,cAApBwb,EAAIc,KAAKhY,SAAwBoX,EAASnX,GAAI4X,aAAenc,EAAMmc,cAG5D,KAAdV,EAAGrX,SAAesX,EAASnX,GAAMvE,MAI3C,MAAOuc,GAIP,MAHA9a,GAAG6Y,kBAAmB,EACtB7Y,EAAG4Y,eAAgB,OACnB5Y,EAAG8Y,qBAAuBgC,EAAEC,SAI9B,GAAIlB,GAAYpB,EAAiBuC,OAAOf,EACxCpD,GAAYpM,MAAMwP,SAAUJ,EAAWoB,mBAAmB,IACvDjW,SAAS1B,KAAKkW,EAAqBM,IAjI1C1e,EAAoB,GAEpB,IAAImB,GAAcnB,EAAoB,GAElCoB,EAAMC,QAAQjB,OAAO,iBACtB,UACC,YACA,wBACA,qBAGJgB,GAAIE,OAAOH,EAAYI,2BAEvBH,EAAIE,OAAO4b,GACXA,EAAqBtb,SAAW,kBAiBhCR,EAAIU,WAAW,wBAAyBsb,GACxCA,EAAsBxb,SAAW,cAAe,kBAAmB,mBAAoB,WA2HlF,SAASxB,EAAQD,EAASH,GAE/B,YAiBA,SAAS8f,GAA2BrE,EAAatX,EAAiBuX,EAAc2B,EAAkBnU,GAEhG,QAASrD,GAAY8V,GASnB,QAASC,GAAmBzT,GAC1BkG,EAASC,QAAQnG,GAGnB,QAAS0T,GAAiBnT,GACxBvE,EAAgBuE,GAChB2F,EAASG,OAAO9F,GAdlB,GAAI2F,GAAWnF,EAAGyF,QACdiK,EAAevX,QAAQyO,KAAK6L,EAgBhC,OAdI/C,GAAa3T,YAAW2T,EAAa3T,UAAY2T,EAAa3T,UAAUuI,MACxEoL,EAAa5T,WAAU4T,EAAa5T,SAAW4T,EAAa5T,SAASyI,MAEzEgO,EAAYnS,MAAMsP,GAAchP,SAAS1B,KAAK0T,EAAoBC,GAW3DxN,EAASU,QAGlB,QAAS+M,KAIP,QAAS7T,KACP,GAAIoG,GAAWnF,EAAGyF,OA2BlB,OAzBA+M,GAAaK,WACXnY,YAAa5D,EAAoB,GAAG6D,SAClC,iFAEF/B,WAAY,oEACXoG,KAAK,SAAS8T,GACfA,EAAMC,QAAQC,QACZC,YAAa,WACbH,OAAO,EACPI,SAAU,IACV2D,UAAW,IACX5d,MAAO,yBAEPka,MAAO,WACLL,EAAMK,MAAMnU,UAIhB8T,EAAMK,MAAMnU,KAAK,SAASyT,GACpBA,GAAyBta,QAAQ2X,SAAS2C,KAA2B0B,EAAiBjW,QAAQuU,IAChGtN,EAASC,QAAQzI,EAAY8V,QAK5BtN,EAASU,QA/BlB,GAAIuN,GAAUpW,IAEdoW,GAAQrU,gBAAkBA,EAiC5B,MAAO,IAAI6T,GASb,QAASkE,GAAoC3D,EAAOG,EAAWP,GAI7D,QAASQ,KACP7X,EAAGgU,gBAML,QAASzS,GAAMb,GACbkX,EAAUlX,EAAM2W,EAAS,gBAAiBQ,GAC1CnX,EAAKiB,UAAW,EAChBjB,EAAKoX,UAIP,QAASuD,GAAmBrH,GAC1ByD,EAAMzD,GAlBR,GAAIhU,GAAKsB,IAETuW,KAKA7X,EAAGyX,MAAQA,EAEXzX,EAAGuB,MAAQA,EAOXvB,EAAGqb,mBAAqBA,EAnG1B,GAAI7e,GAAMC,QAAQjB,OAAO,0BACvB,oBACA,wBACA,sBAGFgB,GAAI4O,QAAQ,6BAA8B8P,GAC1CA,EAA2Ble,SACzB,cACA,kBACA,eACA,mBACA,MAgEFR,EAAIU,WAAW,sCAAuCke,GACtDA,EAAoCpe,SAClC,QACA,YACA,aA4BG,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU,mpCAIZ,SAASC,EAAQD,EAASH,GAE/B,YAWA,SAASyE,GAA0ByE,EAAIwS,GACrC,QAASwE,KAGP,QAAS9X,GAAQ+X,GACf,GAAI9R,GAAWnF,EAAGyF,OAyBlB,OAvBA+M,GAAaK,WACX7a,SAAUlB,EAAoB,IAC9B8B,WAAY,6DACZse,QAASD,SAAUA,KAClBjY,KAAK,SAAU8T,GAChB,GAAI3K,GAAO2K,EAAMla,UAEjBka,GAAMC,QAAQC,QACZC,YAAa,WACbH,OAAO,EACPI,SAAU,IACVja,MAAOkP,EAAKkK,aAEZc,MAAO,WACLhL,EAAKgL,WAITL,EAAMK,MAAMnU,KAAK,SAAU/E,GACzBkL,EAASC,QAAQnL,OAIdkL,EAASU,QA5BlB7I,KAAKkC,QAAUA,EAgCjB,MAAO,IAAI8X,GASb,QAASG,GAA8BhE,EAAO8D,EAAUG,GACtD,GAAI1b,GAAKsB,IAETtB,GAAGub,SAAWA,EACdvb,EAAG2W,aAAe,wBAClB3W,EAAGwW,aAAekF,EAClB1b,EAAGyX,MAAQA,EAzDb,GAAIjb,GAAMC,QAAQjB,OAAO,2BACvB,UACA,cACA,yBAGFgB,GAAI4O,QAAQ,4BAA6BvL,GACzCA,EAA0B7C,SAAW,KAAM,gBAsC3CR,EAAIU,WAAW,gCAAiCue,GAChDA,EAA8Bze,SAC5B,QACA,WACA,8BAcG,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU,gWAIZ,SAASC,EAAQD,GAEtBC,EAAOD,QAAU,yQAIZ,SAASC,EAAQD,EAASH,GAE/B,YAkBA,SAASsW,GAAa1V,GACpBA,EACGG,MAAM,MACLC,IAAK,MAELC,YAAa,mBAEb2C,YAAa5D,EAAoB,GAAG6D,SAAS,cAE7C/B,WAAY,uCAMlB,QAASye,GAAyBC,EAAU9e,GAC1C,GAAIkD,GAAKsB,IAETtB,GAAG6b,SAAW,WACZD,EAASvY,kBAAkBC,KAAK,SAASC,GACvC,GAAI6C,GAAU7C,EAAK6C,OAEnB,IAAIA,EAAQzD,QACa,IAAnByD,EAAQzD,OAAc,CACxB,GAAI+E,GAAKtB,EAAQ,EACjBtJ,GAAOa,GAAG,aAAcuC,UAAWwH,EAAGxH,UAAWwH,GAAIA,QAvC/D,GAAInL,GAAcnB,EAAoB,GAElCoB,EAAMC,QAAQjB,OAAO,MACvB,YACA,cACA,UACA,YACA,aAGFgB,GAAIE,OAAOH,EAAYI,2BAEvBH,EAAIE,OAAOgV,GACXA,EAAa1U,SAAW,kBAcxBR,EAAIU,WAAW,2BAA4Bye,GAC3CA,EAAyB3e,SAAW,WAAY,UAmBhD5B,EAAoB,IACpBA,EAAoB,KAKf,SAASI,EAAQD,EAASH,GAE/B,YAqBA,SAASsW,GAAa1V,GACpBA,EACGG,MAAM,aACLC,IAAK,iBAELyC,QAAS6I,GAAI,MAEbrL,YAAa,mBAEb2C,YAAa5D,EAAoB,GAAG6D,SAAS,+BAE7C/B,WAAY,+CAqBlB,QAAS4e,GAA+B/e,EAAcgf,EAAgBjf,EAAQqC,EAAsBgF,EAClGC,EAAqBJ,EAAiByU,EAAkBlZ,EAAiB2E,EAAY8X,EACrFrc,GAKA,QAASc,KAqBP,QAASwb,GAAmB3T,GAC1B,MAAKA,GAEEA,EAAO4T,OAAO,SAAS3W,GAC5B,OAAQA,EAAMC,eAxBdzI,EAAa2K,IACf1H,EAAG0H,GAAK3K,EAAa2K,GACrB1H,EAAGmc,SAAWF,EAAmBjc,EAAG0H,GAAGY,SAIvCyT,EAAe7V,cAAchG,UAAWnD,EAAamD,YAAY8E,SAAS1B,KAAK,SAASC,GAClFA,EAAK4C,OACPnG,EAAG0H,GAAKnE,EAAK6C,QAAQ,GACrBpG,EAAGmc,SAAWF,EAAmBjc,EAAG0H,GAAGY,SAGpCxL,EAAOa,GAAG,QAInBqC,EAAGoc,UACHpc,EAAGqc,cAAe,EAClBrc,EAAGuF,SAvBL,GAAIvF,GAAKsB,IAETb,KAgCAT,EAAGsc,sBAAwB,WACzB,MAAItc,GAAG0H,IAAM1H,EAAG0H,GAAG6U,UAAkBpY,EAAQ,QAAQnE,EAAG0H,GAAG6U,UAAW,eAAtE,QAGFvc,EAAGwc,uBAAyB,WAC1B,MAAIxc,GAAG0H,IAAM1H,EAAG0H,GAAG+U,YAAoBtY,EAAQ,QAAQnE,EAAG0H,GAAG+U,YAAa,eAA1E,QAGFzc,EAAG0c,UAAY,SAAmBnX,EAAO7E,GAyBvC,QAASic,GAAYpZ,GACnBvD,EAAGmc,SAASS,SACV5U,WAAYzE,EAAKyE,WACjBzC,MAAOhC,EAAKgC,MACZ9J,GAAI8H,EAAK9H,GACTqH,GAAIS,EAAKT,KAGX9C,EAAGuF,SAEEvF,EAAG0H,GAAGJ,iBAAkBtH,EAAG0H,GAAGJ,eAAiBjH,GACpDK,EAAKI,eACLJ,EAAKK,gBAGP,QAAS8b,GAAU/Y,GACjB,GAAIgZ,GAAY,IACZhZ,GAAIP,KAAKwZ,yBACXD,EAAYnd,QACLmE,GAAIP,KAAKwZ,wBAElBxd,EAAgBuE,EAAKgZ,GA7CvB,GAAIvX,IAAUkT,EAAiBjW,QAAQ+C,GAAQ,CAC7C,GAAIyX,IACFzX,MAAOA,EAAMA,MAAMnJ,IACnB0G,GAAI9C,EAAG0H,GAAG5E,GACV5C,UAAWF,EAAG0H,GAAGxH,UACjB+c,sBAAsB,GAGpB5c,EAAYkF,EAAMlF,SAElBA,KAAcoY,EAAiBjW,QAAQnC,KACzC2c,EAASE,aACP7c,UAAWA,EAAUjE,IACrBgE,SAAUJ,EAAG0H,GAAGyV,SAAS/gB,IACzBmE,OAAQP,EAAG0H,GAAG0V,eACd1V,GAAI1H,EAAG0H,GAAGtL,IACVoC,OAAQwB,EAAG0H,GAAG5E,KAKlBkB,EAAgByG,KAAKuS,GAAUhY,SAAS1B,KAAKqZ,EAAaE,KA6B9D7c,EAAG6H,WAAa,SAAoBtC,GAClCA,EAAMC,UAAYtB,EAAW,GAAIiD,OACjCnD,EAAgBoE,IAAI7C,GAAOP,SAAS1B,KAAK,WAEvCtD,EAAGmc,SAAWnc,EAAGmc,SAASD,OAAO,SAASmB,GACxC,MAAOA,GAAQ5hB,KAAO8J,EAAM9J,MAG7B,SAASqI,GACVvE,EAAgBuE,MAIpB9D,EAAGsd,UAAY,SAAmBC,GAChCxB,EAAe7V,cAAchG,UAAWqd,IAAcvY,SAAS1B,KAAK,SAASC,GAC3E,GAAIA,EAAK4C,MAAO,CACd,GAAIuB,GAAKnE,EAAK6C,QAAQ,EAEtBtJ,GAAOa,GAAG,KAAMuC,UAAWwH,EAAGxH,UAAWwH,GAAIA,QAExC1H,GAAGqc,cAAe,KAI7Brc,EAAGwd,qBAAuB,SAA8BC,EAAaF,GACnE,MAAOE,IAAoF,KAArEzd,EAAG0H,GAAGxH,UAAUwd,cAAcC,QAAQJ,EAAYG,gBAG1E1d,EAAG4d,cAAgB,SAAuBC,GACxC7d,EAAGuF,MAAMlF,UAAYwd,GAGvB7d,EAAG+C,aAAe5D,EAElBa,EAAG8d,SAAW,SAAkB1c,GAC9B,MAAOgD,IAAqBhD,KAAMA,EAAM2c,sBAAuB/d,EAAG0H,GAAG5E,MAGvE9C,EAAGge,YAAc,WACfhC,EAASvR,MAAM7B,KAAM5I,EAAG0H,GAAGrH,YAAY2E,SAAS1B,KAAK,SAASC,GAC5DvD,EAAGuF,MAAMlF,UAAYkD,EACrBvD,EAAG0H,GAAGJ,eAAiB/D,KAI3BvD,EAAGie,WAAa,WACdje,EAAGqc,cAAe,GA/LtB,GAAI9f,GAAcnB,EAAoB,GAElCoB,EAAMC,QAAQjB,OAAO,aACvB,YACA,UACA,aACA,mBACA,oBACA,YAGFgB,GAAIE,OAAOH,EAAYI,2BAEvBH,EAAIE,OAAOgV,GAEXA,EAAa1U,SAAW,kBAiBxBR,EAAIU,WAAW,iCAAkC4e,GAEjDA,EAA+B9e,SAC7B,eACA,iBACA,SACA,uBACA,UACA,sBACA,kBACA,mBACA,kBACA,aACA,WACA,gCAwJG,SAASxB,EAAQD,EAASH,GAE/B,YAmBA,SAASwgB,GAASrc,EAAiBuX,EAAc2B,EAAkBnU,EAAI4Z,EAAkBnC,GAEvF,QAASF,GAAS9E,GAShB,QAASoH,GAAgB5a,GACvBkG,EAASC,QAAQnG,GAGnB,QAAS6a,GAActa,GACrBvE,EAAgBuE,GAChB2F,EAASG,OAAO9F,GAdlB,GAAI2F,GAAWnF,EAAGyF,QACdiK,EAAevX,QAAQyO,KAAK6L,EAgBhC,OAdI/C,GAAa3T,YAAW2T,EAAa3T,UAAY2T,EAAa3T,UAAUuI,MACxEoL,EAAa5T,WAAU4T,EAAa5T,SAAW4T,EAAa5T,SAASyI,MAEzEkT,EAAe7V,aAAa8N,GAAchP,SAAS1B,KAAK6a,EAAiBC,GAWlE3U,EAASU,QAGlB,QAAS+M,KAIP,QAAS7T,GAAgB3G,GACvB,GAAI+M,GAAWnF,EAAGyF,OAoClB,OAnCArN,GAASA,MAEToa,EAAaK,WACXnY,YAAa5D,EAAoB,GAAG6D,SAAS,+BAC7C/B,WAAY,qCACZse,QACE6C,UAAW3hB,EAAO2hB,aAGnB/a,KAAK,SAAS8T,GACfA,EAAMC,QAAQC,QACZC,YAAa,WACbH,OAAO,EACPI,SAAU,IACV2D,UAAW,IACX5d,MAAO,0BAEP+gB,KAAM,WACJ5hB,EAAO6hB,KAAOL,EAAiBK,IAAI7hB,EAAO8hB,OAAQ9hB,EAAO+hB,QAG3DhH,MAAO,WACL/a,EAAO6hB,KAAOL,EAAiBQ,MAAMhiB,EAAO8hB,OAAQ9hB,EAAOiiB,YAI/DvH,EAAMK,MAAMnU,KAAK,SAASyT,GACpBA,GAAyBta,QAAQ2X,SAAS2C,KAA2B0B,EAAiBjW,QAAQuU,IAChGtN,EAASC,QAAQmS,EAAS9E,IAG5Bra,EAAO6hB,KAAOL,EAAiBQ,MAAMhiB,EAAO8hB,OAAQ9hB,EAAOiiB,aAIxDlV,EAASU,QAxClB,GAAIuN,GAAUpW,IAEdoW,GAAQrU,gBAAkBA,EA0C5B,MAAO,IAAI6T,GAWb,QAAS0H,GAAkBnH,EAAOG,EAAWP,EAASlY,EAAsBC,GAI1E,QAASyY,KACP7X,EAAGgU,gBAML,QAASzS,GAAMb,GACbkX,EAAUlX,EAAM2W,EAAS,gBAAiBQ,GAC1CnX,EAAKiB,UAAW,EAChBjB,EAAKoX,UAIP,QAASuD,GAAmBrH,GAC1ByD,EAAMzD,GAlBR,GAAIhU,GAAKsB,IAETuW,KAKA7X,EAAGyX,MAAQA,EAEXzX,EAAGuB,MAAQA,EAOXvB,EAAGqb,mBAAqBA,EAKxBrb,EAAG+C,aAAe5D,EAClBa,EAAGgD,YAAc5D,EAtHnB,GAAI5C,GAAMC,QAAQjB,OAAO,aACvB,oBACA,qBACA,iBACA,cAGFgB,GAAI4O,QAAQ,WAAYwQ,GACxBA,EAAS5e,SACP,kBACA,eACA,mBACA,KACA,mBACA,kBAyEFR,EAAIU,WAAW,oBAAqB0hB,GACpCA,EAAkB5hB,SAChB,QACA,YACA,WACA,uBACA,yBA+BG,SAASxB,EAAQD,GAEtBC,EAAOD,QAAU","file":"letter_of_credit/static/letter_of_credit/js/app/app.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t__webpack_require__(1)\r\n\t__webpack_require__(27)\r\n\r\n\tvar rootCommons = __webpack_require__(7)\r\n\r\n\tvar app = angular.module('lc-root-app',\r\n\t  ['rootApp',\r\n\t   'ui.router',\r\n\t   'form-m',\r\n\t   'lc'\r\n\t  ])\r\n\r\n\tapp.config(rootCommons.interpolateProviderConfig)\r\n\r\n\tapp.run(['$rootScope', '$state', '$stateParams', function($rootScope, $state, $stateParams) {\r\n\t  $rootScope.$state = $state\r\n\t  $rootScope.$stateParams = $stateParams\r\n\t}])\r\n\r\n\tapp.config(formMRootAppURLConfig)\r\n\tformMRootAppURLConfig.$inject = ['$stateProvider', '$urlRouterProvider']\r\n\tfunction formMRootAppURLConfig($stateProvider, $urlRouterProvider) {\r\n\t  $urlRouterProvider\r\n\t    .otherwise('/')\r\n\r\n\t  $stateProvider\r\n\t    .state('home', {\r\n\t      url: '/',\r\n\r\n\t      kanmiiTitle: 'Home',\r\n\r\n\t      template: __webpack_require__(30)\r\n\t    })\r\n\t}\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\"\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\t__webpack_require__(2)\r\n\t__webpack_require__(11)\r\n\t__webpack_require__(16)\r\n\t__webpack_require__(18)\r\n\t__webpack_require__(19)\r\n\t__webpack_require__(21)\r\n\t__webpack_require__(24)\r\n\r\n\tvar app = angular.module('form-m',\r\n\t  ['rootApp',\r\n\t   'ui.router',\r\n\t   'list-form-m',\r\n\t   'upload-form-m',\r\n\t   'add-form-m',\r\n\t   'form-m-bids'\r\n\t  ])\r\n\r\n\tapp.config(formMURLConfig)\r\n\tformMURLConfig.$inject = ['$stateProvider']\r\n\tfunction formMURLConfig($stateProvider) {\r\n\r\n\t  $stateProvider\r\n\t    .state('form_m', {\r\n\t      url: '/form-m',\r\n\r\n\t      kanmiiTitle: 'Form M',\r\n\r\n\t      template: __webpack_require__(26),\r\n\r\n\t      controller: 'FormMController as formMHome'\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('FormMController', FormMController)\r\n\tFormMController.$inject = ['$state', '$scope']\r\n\tfunction FormMController($state, $scope) {\r\n\r\n\t  var listFormMTab = {\r\n\t    className: 'list-form-m-tab-ctrl',\r\n\t    title: 'List Form M',\r\n\t    viewName: 'listFormM',\r\n\t    select: function () {\r\n\t      $scope.updateAddFormMTitle()\r\n\t      $state.go('form_m.list')\r\n\t    }\r\n\t  }\r\n\r\n\t  var addFormMTitle = 'Form M'\r\n\t  /** Angular uib tab executes 'select' function which invokes $state.go. However, if we are transiting to this state\r\n\t   from a place outside angular uib tab, this will result in the state transition function been called twice (see\r\n\t   \"$scope.goToFormM\" function below for example) - one for the calling position and another for angular uib tab. This\r\n\t   flag keeps track of whether state transition function had been called and thus helps to avoid duplicate call. A\r\n\t   consequence of the duplicate call is that the controller for the addFormMTab is called twice with all sorts of\r\n\t   unintended consequences.\r\n\t   */\r\n\t  var addFormMGoTo = true\r\n\t  var addFormMTab = {\r\n\t    className: 'add-form-tab-ctrl',\r\n\t    title: addFormMTitle,\r\n\t    active: true,\r\n\t    viewName: 'addFormM',\r\n\t    select: function () {\r\n\t      if (addFormMGoTo) $state.go('form_m.add')\r\n\t      addFormMGoTo = true\r\n\t    }\r\n\t  }\r\n\r\n\t  var reportsTab = {\r\n\t    title: 'Reports',\r\n\t    active: false,\r\n\t    viewName: 'formMReports',\r\n\t    select: function () {\r\n\t      $scope.updateAddFormMTitle()\r\n\t      $state.go('form_m.add')\r\n\t    }\r\n\t  }\r\n\r\n\t  var bidsTab = {\r\n\t    className: 'bid-list-tab-ctrl',\r\n\t    title: 'Bids',\r\n\t    active: false,\r\n\t    viewName: 'bids',\r\n\t    select: function () {\r\n\t      $scope.updateAddFormMTitle()\r\n\t      $state.go('form_m.bids')\r\n\t    }\r\n\t  }\r\n\r\n\t  $scope.tabs = {\r\n\t    listFormM: listFormMTab,\r\n\t    addFormM: addFormMTab,\r\n\t    bids: bidsTab,\r\n\t    reports: reportsTab\r\n\t  }\r\n\r\n\t  $scope.updateAddFormMTitle = function (formM) {\r\n\t    $scope.tabs.addFormM.title = formM ? 'Details of \"' + formM.number + '\"' : addFormMTitle\r\n\t  }\r\n\r\n\t  $scope.goToFormM = function goToFormM(formMNumber) {\r\n\t    addFormMGoTo = false\r\n\t    $state.transitionTo('form_m.add', {formM: formMNumber})\r\n\t    $scope.tabs.addFormM.active = true\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\t__webpack_require__(3)\r\n\t__webpack_require__(4)\r\n\t__webpack_require__(8)\r\n\t__webpack_require__(9)\r\n\t__webpack_require__(10)\r\n\r\n\tvar app = angular.module('add-form-m', [\r\n\t  'ui.router',\r\n\t  'rootApp',\r\n\t  'customer',\r\n\t  'search-detailed-or-uploaded-form-m',\r\n\t  'form-m-service',\r\n\t  'lc-cover',\r\n\t  'lc-issue',\r\n\t  'lc-bid',\r\n\t  'form-m-comment',\r\n\t  'lc-bid-request',\r\n\t  'confirmation-dialog',\r\n\t  'add-form-m-form-m-object',\r\n\t  'lc-service',\r\n\t  'complex-object-validator',\r\n\t  'display-uploaded-form-m'\r\n\t])\r\n\r\n\tapp.config(formMStateConfig)\r\n\r\n\tformMStateConfig.$inject = ['$stateProvider']\r\n\r\n\tfunction formMStateConfig($stateProvider) {\r\n\t  $stateProvider\r\n\t    .state('form_m.add', {\r\n\t      kanmiiTitle: 'Add form M',\r\n\r\n\t      params: {showSummary: null, formM: null},\r\n\r\n\t      views: {\r\n\t        addFormM: {\r\n\t          templateUrl: __webpack_require__(5).buildUrl('form-m/add-form-m/add-form-m.html'),\r\n\r\n\t          controller: 'AddFormMStateController as addFormMState'\r\n\t        }\r\n\t      }\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('AddFormMStateController', AddFormMStateController)\r\n\r\n\tAddFormMStateController.$inject = [\r\n\t  'getTypeAheadCustomer',\r\n\t  'getTypeAheadCurrency',\r\n\t  'SearchDetailedOrUploadedFormMService',\r\n\t  'underscore',\r\n\t  'xhrErrorDisplay',\r\n\t  '$stateParams',\r\n\t  'resetForm2',\r\n\t  '$state',\r\n\t  '$scope',\r\n\t  'confirmationDialog',\r\n\t  'formMObject',\r\n\t  'formMAttributesVerboseNames',\r\n\t  'getTypeAheadLetterOfCredit',\r\n\t  'DisplayUploadedFormMModal'\r\n\t]\r\n\r\n\tfunction AddFormMStateController(getTypeAheadCustomer, getTypeAheadCurrency, SearchDetailedOrUploadedFormMService,\r\n\t  underscore, xhrErrorDisplay, $stateParams, resetForm2, $state, $scope, confirmationDialog, formMObject,\r\n\t  formMAttributesVerboseNames, getTypeAheadLetterOfCredit, DisplayUploadedFormMModal) {\r\n\t  var vm = this\r\n\r\n\t  function initFormMCb(formM, detailedFormM) {\r\n\t    $stateParams.formM = null\r\n\t    vm.formM = formM\r\n\t    vm.formM.lcRef = {lc_number: null}\r\n\t    vm.detailedFormM = detailedFormM\r\n\r\n\t    if (detailedFormM) {\r\n\t      vm.fieldIsEditable = {\r\n\t        number: false,\r\n\t        currency: false,\r\n\t        applicant: false,\r\n\t        date_received: false,\r\n\t        amount: false,\r\n\t        lcRef: false\r\n\t      }\r\n\t    }\r\n\r\n\t    $scope.updateAddFormMTitle(detailedFormM)\r\n\t    formMSavedSuccessMessage()\r\n\t  }\r\n\r\n\t  initialize()\r\n\t  function initialize(form, formMNumber) {\r\n\r\n\t    if (form) {\r\n\t      var elements = ['applicant', 'currency'].concat($scope.newFormMForm.lcRef ? ['lcRef'] : [])\r\n\r\n\t      resetForm2(form, [{form: $scope.newFormMForm, elements: elements}])\r\n\r\n\t      form.$setPristine()\r\n\t      form.$setUntouched()\r\n\t    }\r\n\r\n\t    vm.detailedFormM = null\r\n\t    vm.fieldIsEditable = {\r\n\t      number: true,\r\n\t      currency: true,\r\n\t      applicant: true,\r\n\t      date_received: true,\r\n\t      amount: true,\r\n\t      lcRef: true\r\n\t    }\r\n\r\n\t    formMObject.init(formMNumber || $stateParams.formM, initFormMCb)\r\n\r\n\t    vm.searchFormM = {}\r\n\t  }\r\n\r\n\t  vm.reset = initialize\r\n\r\n\t  function formMSavedSuccessMessage() {\r\n\t    var summary = $stateParams.showSummary\r\n\t    $stateParams.showSummary = null\r\n\r\n\t    if (summary) {\r\n\t      confirmationDialog.showDialog({\r\n\t        title: '\"' + vm.formM.number + '\" successfully saved',\r\n\t        text: summary,\r\n\t        infoOnly: true\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.enableFieldEdit = function enableFieldEdit(field) {\r\n\t    vm.fieldIsEditable[field] = vm.detailedFormM ? !vm.fieldIsEditable[field] : true\r\n\t  }\r\n\r\n\t  vm.disableSubmitBtn = function disableSubmitBtn() {\r\n\t    if ($scope.newFormMForm.$invalid) return true\r\n\r\n\t    if (underscore.has(vm.formM.coverForm, '$invalid') && vm.formM.coverForm.$invalid) return true\r\n\r\n\t    if (underscore.has(vm.formM.bidForm, '$invalid') && vm.formM.bidForm.$invalid) return true\r\n\r\n\t    if (underscore.has(vm.formM.issuesForm, '$invalid') && vm.formM.issuesForm.$invalid) return true\r\n\r\n\t    if (underscore.has(vm.formM.commentForm, '$invalid') && vm.formM.commentForm.$invalid) return true\r\n\r\n\t    if (formMObject.showEditBid || formMObject.showCommentForm) return true\r\n\r\n\t    var compared = formMObject.compareFormMs(vm.detailedFormM)\r\n\r\n\t    if (!compared) return false\r\n\r\n\t    if (underscore.all(compared)) {\r\n\t      if (formMObject.bid.goods_description && formMObject.bid.amount) return false\r\n\t      if (!underscore.isEmpty(vm.formM.cover)) return false\r\n\t      if (vm.formM.lcRef.lc_number) return false\r\n\t      return !vm.formM.selectedIssues.length\r\n\t    }\r\n\r\n\t    return false\r\n\t  }\r\n\r\n\t  vm.getLc = function (lcRef) {\r\n\t    return getTypeAheadLetterOfCredit({lc_number: lcRef.trim(), mf: vm.formM.number})\r\n\t  }\r\n\t  vm.getApplicant = getTypeAheadCustomer\r\n\t  vm.getCurrency = getTypeAheadCurrency\r\n\t  vm.datePickerFormat = 'dd-MMM-yyyy'\r\n\t  vm.datePickerIsOpen = false\r\n\t  vm.openDatePicker = function openDatePicker() {\r\n\t    vm.datePickerIsOpen = true\r\n\t  }\r\n\r\n\t  vm.getUploadedFormM = function getUploadedFormM() {\r\n\t    vm.detailedFormM = null\r\n\t    initialize()\r\n\r\n\t    SearchDetailedOrUploadedFormMService.searchWithModal().then(function (data) {\r\n\t      if (data.number) {\r\n\t        initialize(null, data.number)\r\n\r\n\t      } else {\r\n\t        DisplayUploadedFormMModal.display(data.singleWinFormMs).then(function (formM) {\r\n\t          if (formM) {\r\n\t            vm.searchFormM = formM\r\n\t            vm.formM.number = formM.mf\r\n\t            vm.formM.amount = formM.cost_freight\r\n\t            vm.formM.goods_description = formM.goods_description\r\n\r\n\t            getTypeAheadCurrency(formM.ccy).then(function (ccy) {\r\n\t              vm.formM.currency = ccy[0]\r\n\t            })\r\n\t          }\r\n\t        })\r\n\t      }\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.submit = function submit(formM) {\r\n\t    formMObject.saveFormM(formM, vm.detailedFormM).then(function saveFormMSuccess(data) {\r\n\t      $state.go('form_m.add', data)\r\n\r\n\t    }, function saveFormMError(xhr) {\r\n\t      xhrErrorDisplay(xhr, formMAttributesVerboseNames)\r\n\t    })\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\"\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('add-form-m-form-m-object', [\r\n\t  'rootApp',\r\n\t  'lc-issue-service',\r\n\t  'lc-cover-service',\r\n\t  'form-m-service',\r\n\t  'comment-service'\r\n\t])\r\n\r\n\tapp.factory('formMObject', formMObject)\r\n\r\n\tformMObject.$inject = [\r\n\t  'LcBidRequest',\r\n\t  'LCIssueConcrete',\r\n\t  'FormMCover',\r\n\t  'confirmationDialog',\r\n\t  'formatDate',\r\n\t  'xhrErrorDisplay',\r\n\t  'underscore',\r\n\t  '$filter',\r\n\t  'getTypeAheadLCIssue',\r\n\t  'FormM',\r\n\t  '$q',\r\n\t  'Comment'\r\n\t]\r\n\r\n\tfunction formMObject(LcBidRequest, LCIssueConcrete, FormMCover, confirmationDialog, formatDate, xhrErrorDisplay,\r\n\t  underscore, $filter, getTypeAheadLCIssue, FormM, $q, Comment) {\r\n\t  function Factory() {\r\n\t    var self = this\r\n\t    self.datePickerFormat = 'dd-MMM-yyyy'\r\n\t    var confirmationTitleLength = 40\r\n\r\n\t    self.setBids = function setBids(cb) {\r\n\t      self.existingBids = []\r\n\t      LcBidRequest.getPaginated({mf: self.number}).$promise.then(function (data) {\r\n\r\n\t        if (data.count) {\r\n\t          var results = data.results\r\n\r\n\t          if (results.length) {\r\n\t            results.forEach(function (bid) {\r\n\t              var total_allocation = 0\r\n\t              var total_utilization = 0\r\n\r\n\t              underscore.each(bid.allocations, function (allocation) {\r\n\t                total_allocation += allocation.amount_allocated\r\n\t                total_utilization += allocation.amount_utilized\r\n\t              })\r\n\r\n\t              bid.total_allocation = total_allocation\r\n\t              bid.total_utilization = total_utilization\r\n\t              bid.unallocated = bid.amount - total_allocation\r\n\r\n\t              self.existingBids.push(bid)\r\n\t            })\r\n\r\n\t            if (cb) cb(self.existingBids)\r\n\t          }\r\n\t        }\r\n\r\n\t      }, function (xhr) {\r\n\t        console.log('xhr = ', xhr)\r\n\t      })\r\n\t    }\r\n\r\n\t    function setComments(id) {\r\n\t      Comment.query({ct: self.ct_id, pk: id, not_deleted: true}).$promise.then(function (data) {\r\n\t        self.comments = data\r\n\r\n\t      }, function (xhr) {\r\n\t        console.log('xhr = ', xhr)\r\n\t      })\r\n\t    }\r\n\r\n\t    function setIssues() {\r\n\t      LCIssueConcrete.query({form_m_number: self.number}).$promise.then(function (data) {\r\n\t        data.forEach(function (issue) {\r\n\t          if (!issue.closed_at) self.nonClosedIssues.push(issue)\r\n\t          else self.closedIssues.push(issue)\r\n\t        })\r\n\t      })\r\n\t    }\r\n\r\n\t    function setCovers() {\r\n\t      FormMCover.query({form_m_number: self.number}).$promise.then(function (data) {\r\n\t        self.covers = data\r\n\t      }, function (xhr) {\r\n\t        console.log(xhr)\r\n\t      })\r\n\t    }\r\n\r\n\t    self.init = function init(formMNumber, cb) {\r\n\t      setInitialProperties()\r\n\t      function setInitialProperties() {\r\n\t        /*\r\n\t         *@param {angular.form.model} will hold data for bid we wish to create or edit\r\n\t         */\r\n\t        self.bid = {}\r\n\r\n\t        /**\r\n\t         * Flag that determines whether we are editing bid and will show an edit bid button.\r\n\t         * @type {boolean}\r\n\t         */\r\n\t        self.showEditBid = false\r\n\r\n\t        /**\r\n\t         * Flag that controls whether to show bid form\r\n\t         * @type {boolean}\r\n\t         */\r\n\t        self.showBidForm = false\r\n\r\n\t        /**\r\n\t         * Bids that already exist for this form M. These bids can be edited.\r\n\t         * @type {Array}\r\n\t         */\r\n\t        self.existingBids = []\r\n\r\n\t        /**\r\n\t         * Issues already created for this form M that user has closed. They are merely for display.\r\n\t         * @type {Array}\r\n\t         */\r\n\t        self.closedIssues = []\r\n\r\n\t        /*\r\n\t         *@param {angular.form.model} will hold text of comment we wish to create or edit\r\n\t         */\r\n\t        self.commentText = null\r\n\r\n\t        /**\r\n\t         * Flag that determines whether we are editing comment and will show an edit comment button.\r\n\t         * @type {boolean}\r\n\t         */\r\n\t        self.showEditComment = false\r\n\r\n\t        /**\r\n\t         * Flag that controls whether to show comment form\r\n\t         * @type {boolean}\r\n\t         */\r\n\t        self.showCommentForm = false\r\n\r\n\t        /**\r\n\t         * Comments already created for this form M.\r\n\t         * @type {Array}\r\n\t         */\r\n\t        self.comments = []\r\n\r\n\t        /**\r\n\t         * Issues already created for this form M that are open. User can use this interface to close them\r\n\t         * @type {Array}\r\n\t         */\r\n\t        self.nonClosedIssues = []\r\n\r\n\t        /**\r\n\t         * Fresh issues that user wishes to create. Will be appended to open issues when created.\r\n\t         * @type {Array}\r\n\t         */\r\n\t        self.selectedIssues = []\r\n\r\n\t        /**\r\n\t         * The issue that user is currently selecting. Will be pushed into self.selectedIssues\r\n\t         * @type {null|{}}\r\n\t         */\r\n\t        self.issue = null\r\n\r\n\t        /**\r\n\t         * Flag that controls whether issue form is displayed or hidden.\r\n\t         * @type {boolean}\r\n\t         */\r\n\t        self.showIssueForm = false\r\n\r\n\t        self.covers = []\r\n\t        self.cover = {}\r\n\t        self.showCoverForm = false\r\n\r\n\t        self.date_received = new Date()\r\n\t        self.number = null\r\n\t        self.applicant = null\r\n\t        self.currency = null\r\n\t        self.amount = null\r\n\t        self.goods_description = null\r\n\t        self.form_m_issues = null\r\n\t        self.url = null\r\n\t        self.ct_id = null\r\n\t        self._id = null\r\n\t        self.lc_number = null\r\n\t      }\r\n\r\n\t      var formM\r\n\r\n\t      if (formMNumber) {\r\n\t        FormM.getPaginated({number: formMNumber}).$promise.then(function (data) {\r\n\t          if (data.count) {\r\n\t            formM = data.results[0]\r\n\t            self.date_received = new Date(formM.date_received)\r\n\t            self.number = formM.number\r\n\t            self.applicant = formM.applicant_data\r\n\t            self.currency = formM.currency_data\r\n\t            self.amount = Number(formM.amount)\r\n\t            self.goods_description = formM.goods_description\r\n\t            self.form_m_issues = formM.form_m_issues\r\n\t            self.url = formM.url\r\n\t            self.ct_id = formM.ct_id\r\n\t            self.ct_url = formM.ct_url\r\n\t            self._id = formM.id\r\n\t            self.lc_number = formM.lc\r\n\r\n\t            self.setBids()\r\n\t            setIssues()\r\n\t            setCovers()\r\n\t            setComments(self._id)\r\n\t          }\r\n\r\n\t          cb(self, formM)\r\n\t        })\r\n\r\n\t      } else {\r\n\t        cb(self)\r\n\t      }\r\n\r\n\t    }\r\n\r\n\t    self.formatIssueText = function formatIssueText(text) {return text.replace(/:ISSUE$/i, '')}\r\n\r\n\t    self.closeIssue = function closeIssue(issue, $index) {\r\n\t      var text = 'Sure you want to close issue:\\n\"' + self.formatIssueText(issue.issue_text) + '\"?'\r\n\t      confirmationDialog.showDialog({title: 'Close issue', text: text}).then(function (answer) {\r\n\t        if (answer) {\r\n\t          issue.closed_at = formatDate(new Date())\r\n\t          LCIssueConcrete.put(issue).$promise.then(issueClosedSuccess, issueClosedError)\r\n\t        }\r\n\t      })\r\n\r\n\t      function issueClosedSuccess() {\r\n\t        var text = 'Issue closed successfully:\\n' + self.formatIssueText(issue.issue_text)\r\n\t        confirmationDialog.showDialog({title: 'Close issue', text: text, infoOnly: true})\r\n\t        self.nonClosedIssues.splice($index, 1)\r\n\t        self.closedIssues.push(issue)\r\n\t      }\r\n\r\n\t      function issueClosedError(xhr) {xhrErrorDisplay(xhr)}\r\n\t    }\r\n\r\n\t    self.createIssuesMessage = function createIssuesMessage(issues) {\r\n\t      issues = self.nonClosedIssues.concat((issues && issues.length) ? issues : [])\r\n\r\n\t      if (!issues.length) return ''\r\n\r\n\t      var issuesText = '\\n\\n\\nPlease note the following issues which must be regularized before the LC ' +\r\n\t        'request can be treated:\\n'\r\n\r\n\t      underscore.each(issues, function (issue, index) {\r\n\t        ++index\r\n\t        issuesText += ('(' + index + ') ' + self.formatIssueText(issue.issue_text) + '\\n')\r\n\t      })\r\n\r\n\t      return issuesText\r\n\t    }\r\n\r\n\t    self.createFormMMessage = function createFormMMessage() {\r\n\t      var amount = $filter('number')(self.amount, 2)\r\n\t      var ref = self.lc_number ? self.lc_number + '/' : ''\r\n\t      var header = self.applicant.name + ' - ' + ref + self.number + ' - ' + self.currency.code + ' ' + amount\r\n\t      return header + '\\n\\nForm M Number : ' + self.number + '\\n' +\r\n\t        'Value         : ' + self.currency.code + ' ' +\r\n\t        amount + '\\n' +\r\n\t        'Applicant     : ' + self.applicant.name\r\n\t    }\r\n\r\n\t    self.showSummary = function showSummary() {\r\n\t      confirmationDialog.showDialog({\r\n\t        title: self.number,\r\n\t        text: self.createFormMMessage() + self.createIssuesMessage(),\r\n\t        infoOnly: true\r\n\t      })\r\n\t    }\r\n\r\n\t    /**\r\n\t     * Fresh in the sense that they have not been attached to this form M either has newly selected issues or closed\r\n\t     * issues or non-closed issues\r\n\t     * @param {string} text - the text of the issue to get\r\n\t     * @returns {[]} - an array of fresh issues for this form M\r\n\t     */\r\n\t    self.getFreshIssues = function getFreshIssues(text) {\r\n\t      var _ids = []\r\n\r\n\t      self.selectedIssues.forEach(function (issue) {\r\n\t        _ids.push(issue.id)\r\n\t      })\r\n\r\n\t      var x = []\r\n\t      var URL_REGEXP = new RegExp(\".+/(\\\\d+)$\")\r\n\r\n\t      x.concat(self.nonClosedIssues).concat(self.closedIssues).forEach(function (issue) {\r\n\t        _ids.push(URL_REGEXP.exec(issue.issue)[1])\r\n\t      })\r\n\r\n\t      return getTypeAheadLCIssue({text: text, exclude_issue_ids: _ids.join(',')})\r\n\t    }\r\n\r\n\t    self.saveFormM = function saveFormM(formM, detailedFormM) {\r\n\t      var formMToSave = {\r\n\t        applicant: formM.applicant.url,\r\n\t        currency: formM.currency.url,\r\n\t        date_received: formatDate(formM.date_received),\r\n\t        amount: formM.amount,\r\n\t        number: formM.number,\r\n\t        goods_description: formM.goods_description\r\n\t      }\r\n\r\n\t      if (formM.lcRef.lc_number) formMToSave.lc = formM.lcRef.lc_number\r\n\r\n\t      if (formM.bid.amount && formM.bid.goods_description) {\r\n\t        formMToSave.goods_description = self.goods_description = formM.bid.goods_description\r\n\t        formMToSave.bid = {amount: Number(formM.bid.amount), maturity: formatDate(formM.bid.maturity)}\r\n\t      }\r\n\r\n\t      if (formM.selectedIssues.length) formMToSave.issues = formM.selectedIssues\r\n\r\n\t      if (!underscore.isEmpty(formM.cover)) {\r\n\t        formMToSave.cover = {amount: formM.cover.amount, cover_type: formM.cover.cover_type[0]}\r\n\t      }\r\n\r\n\t      var deferred = $q.defer()\r\n\r\n\t      if (!detailedFormM) new FormM(formMToSave).$save(formMSavedSuccess, formMSavedError)\r\n\r\n\t      else {\r\n\t        //if we did not edit the main form M i.e detailedFormM = formM, then there is no need for database update\r\n\t        if (underscore.all(self.compareFormMs(detailedFormM, formM))) {\r\n\t          if (!formM.lcRef.lc_number) formMToSave.do_not_update = 'do_not_update'\r\n\t          formMToSave.url = formM.url //needed for bid, cover, issues and comments\r\n\t        }\r\n\r\n\t        formMToSave.id = detailedFormM.id\r\n\t        new FormM(formMToSave).$put(formMSavedSuccess, formMSavedError)\r\n\t      }\r\n\r\n\t      function formMSavedSuccess(data) {\r\n\t        var summary = self.createFormMMessage() + self.createIssuesMessage(data.new_issues)\r\n\r\n\t        if (formMToSave.bid) {\r\n\t          summary += '\\n\\nBid Amount     : ' + formM.currency.code + ' ' + $filter('number')(formMToSave.bid.amount, 2)\r\n\t        }\r\n\r\n\t        delete data.new_issues\r\n\t        deferred.resolve({showSummary: summary, formM: data.number})\r\n\t      }\r\n\r\n\t      function formMSavedError(xhr) {\r\n\t        deferred.reject(xhr)\r\n\t      }\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\r\n\t    self.editFormM = function editFormM(formM) {\r\n\t      formM.id = self._id\r\n\t      return FormM.put(formM).$promise\r\n\t    }\r\n\r\n\t    /**\r\n\t     * Compare attributes of pristine form M (form M obtained from server un-edited) and another form and returns an\r\n\t     * object with the attribute as key and equalities of the values of the attributes in the two form Ms as values.\r\n\t     *\r\n\t     * @param {{}} pristineFormM - form M obtained from server un-edited. If this is null, then there is no point doing\r\n\t     *   comparison\r\n\t     * @param {null|{}} otherFormM - optional second form M to compare. If this is not given, then we compare first\r\n\t     *   form M with self\r\n\t     * @returns {{}} - an object of form Ms attributes' values equalities\r\n\t     */\r\n\t    self.compareFormMs = function compareFormMs(pristineFormM, otherFormM) {\r\n\t      if (!pristineFormM) return {all: false}\r\n\r\n\t      var formM = otherFormM ? otherFormM : self\r\n\r\n\t      return {\r\n\t        number: formM.number && formM.number === pristineFormM.number,\r\n\t        date_received: angular.equals(formM.date_received, new Date(pristineFormM.date_received)),\r\n\t        amount: self.amount && formM.amount === Number(pristineFormM.amount),\r\n\t        currency: formM.currency && (formM.currency.code === pristineFormM.currency_data.code),\r\n\t        applicant: formM.applicant && (formM.applicant.name === pristineFormM.applicant_data.name),\r\n\t        goods_description: formM.goods_description === pristineFormM.goods_description\r\n\t      }\r\n\t    }\r\n\r\n\t    self.addComment = function addComment(text) {\r\n\t      var deferred = $q.defer()\r\n\r\n\t      Comment.save({content_type: self.ct_url, object_id: self._id, text: text})\r\n\t        .$promise.then(function commentFormMSaveSuccess(data) {\r\n\t        var text = data.text\r\n\r\n\t        confirmationDialog.showDialog({\r\n\t          title: 'Comment successfully created \"' + text.slice(0, confirmationTitleLength) + '\"',\r\n\t          text: text,\r\n\t          infoOnly: true\r\n\t        })\r\n\r\n\t        self.comments.push(data)\r\n\t        deferred.resolve(data)\r\n\r\n\t      }, function (xhr) {\r\n\t        xhrErrorDisplay(xhr)\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\r\n\t    self.closeComment = function closeComment(comment) {\r\n\t      var deferred = $q.defer()\r\n\t      var text = comment.text\r\n\r\n\t      confirmationDialog.showDialog({\r\n\t        title: 'Close comment \"' + text.slice(0, confirmationTitleLength) + '\"',\r\n\t        text: 'Sure you want to close comment:\\n===============================\\n' + text\r\n\t      }).then(function (answer) {\r\n\t        if (answer) {\r\n\t          comment.deleted_at = (new Date()).toJSON()\r\n\r\n\t          Comment.put(comment).$promise.then(function formMCommentCloseSuccess(data) {\r\n\t            confirmationDialog.showDialog({\r\n\t              title: 'Comment successfully closed \"' + text.slice(0, confirmationTitleLength) + '\"',\r\n\t              text: text,\r\n\t              infoOnly: true\r\n\t            })\r\n\r\n\t            deferred.resolve(data)\r\n\t            var comments = []\r\n\r\n\t            self.comments.forEach(function (comment) {\r\n\t              if (comment.id === data.id) return\r\n\t              comments.push(comment)\r\n\t            })\r\n\r\n\t            self.comments = comments\r\n\r\n\t          }, function (xhr) {\r\n\t            xhrErrorDisplay(xhr)\r\n\t          })\r\n\t        }\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\r\n\t    self.editComment = function editComment(text, comment) {\r\n\t      var deferred = $q.defer()\r\n\r\n\t      confirmationDialog.showDialog({\r\n\t        title: 'Edit comment \"' + comment.text.slice(0, confirmationTitleLength) + '\"',\r\n\t        text: 'Are you sure you want to edit comment:\\n======================================\\n' + comment.text\r\n\r\n\t      }).then(function (answer) {\r\n\t        if (answer) {\r\n\t          comment.text = text\r\n\r\n\t          Comment.put(comment).$promise.then(function formMCommentEditedSuccess(data) {\r\n\t            confirmationDialog.showDialog({\r\n\t              title: 'Comment successfully changed \"' + text.slice(0, confirmationTitleLength) + '\"',\r\n\t              text: text,\r\n\t              infoOnly: true\r\n\t            })\r\n\r\n\t            deferred.resolve(data)\r\n\t            var comments = angular.copy(self.comments)\r\n\r\n\t            for (var index = 0, len = comments.length; index < len; index++) {\r\n\t              if (data.id === comments[index].id) {\r\n\t                comments[index] = data\r\n\t                break\r\n\t              }\r\n\t            }\r\n\r\n\t            self.comments = comments\r\n\r\n\t          }, function (xhr) {\r\n\t            xhrErrorDisplay(xhr)\r\n\t          })\r\n\t        }\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\t  }\r\n\r\n\t  return new Factory()\r\n\t}\r\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('lc-issue', [\r\n\t  'rootApp',\r\n\t  'add-form-m-form-m-object'\r\n\t])\r\n\r\n\tapp.directive('lcIssue', lcIssueDirective)\r\n\r\n\tlcIssueDirective.$inject = []\r\n\r\n\tfunction lcIssueDirective() {\r\n\t  return {\r\n\t    restrict: 'A',\r\n\t    templateUrl: __webpack_require__(5).buildUrl('form-m/add-form-m/lc-issue/lc-issue.html'),\r\n\t    scope: true,\r\n\t    bindToController: {\r\n\t      onIssuesChanged: '&'\r\n\t    },\r\n\t    controller: 'LcIssueDirectiveController as lcIssue'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('LcIssueDirectiveController', LcIssueDirectiveController)\r\n\r\n\tLcIssueDirectiveController.$inject = [\r\n\t  '$scope',\r\n\t  'resetForm2',\r\n\t  'clearFormField',\r\n\t  'formMObject'\r\n\t]\r\n\r\n\tfunction LcIssueDirectiveController($scope, resetForm2, clearFormField, formMObject) {\r\n\t  var vm = this\r\n\t  vm.formM = formMObject\r\n\t  var title = 'Add Letter Of Credit Issues'\r\n\r\n\t  init()\r\n\t  function init(form) {\r\n\t    vm.title = title\r\n\t    formMObject.selectedIssues = []\r\n\t    formMObject.issue = null\r\n\r\n\t    if (form) resetForm2(form, [\r\n\t      {form: form, elements: ['issue']}\r\n\t    ])\r\n\t  }\r\n\r\n\t  vm.issueSelected = function issueSelected($item, $model) {\r\n\t    formMObject.selectedIssues.push($model)\r\n\t    formMObject.issue = null\r\n\t    clearFormField($scope.issuesForm, 'issue')\r\n\t  }\r\n\r\n\t  vm.deleteIssue = function deleteIssue(index) {\r\n\t    vm.formM.selectedIssues.splice(index, 1)\r\n\t  }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    formMObject.showIssueForm = vm.formM.amount && vm.formM.number && !formMObject.showIssueForm\r\n\r\n\t    if (!formMObject.showIssueForm) init(form)\r\n\t    else vm.title = 'Dismiss'\r\n\t  }\r\n\r\n\t  $scope.$watch(function getFormM() {return vm.formM}, function (formM) {\r\n\t    vm.formM.issuesForm = $scope.issuesForm\r\n\r\n\t    if (formM) {\r\n\t      if (!formM.amount || !formM.number) {\r\n\t        init(formMObject.issueForm)\r\n\t      }\r\n\t    }\r\n\t  }, true)\r\n\r\n\t  $scope.$watch(function getShowContainer() {return formMObject.showIssueForm}, function onUpdateShowContainer() {\r\n\t    $scope.issuesForm.issue.$validate()\r\n\t  })\r\n\t}\r\n\r\n\tapp.directive('validateIssues', function validateIssues() {\r\n\t  return {\r\n\t    restrict: 'A',\r\n\t    require: 'ngModel',\r\n\t    link: function ($scope, elm, attributes, ctrl) {\r\n\t      var vm = $scope.lcIssue\r\n\t      ctrl.$validators.issues = function () {\r\n\t        return !vm.formM.showIssueForm || Boolean(vm.formM.selectedIssues.length)\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t})\r\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\tvar lcCommons = __webpack_require__(6)\r\n\r\n\t/**\r\n\t * @description\r\n\t *\r\n\t * @param {String} fsPath - the path relative to the form-m directory\r\n\t * @returns {*|string}\r\n\t */\r\n\tfunction buildUrl(fsPath) {\r\n\t  return lcCommons.buildUrl('app') + '/' + fsPath\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t  buildUrl: buildUrl\r\n\t}\r\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\tvar rootCommons = __webpack_require__(7)\r\n\r\n\tvar appName = 'letter_of_credit'\r\n\r\n\tfunction buildUrl(fsPath) {\r\n\t  return rootCommons.buildUrl(appName, fsPath)\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t  buildUrl: buildUrl,\r\n\t  appName: appName\r\n\t}\r\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\r\n\tvar interpolateProviderConfig = ['$interpolateProvider', function ($interpolateProvider) {\r\n\t  $interpolateProvider.startSymbol('{$');\r\n\t  $interpolateProvider.endSymbol('$}');\r\n\t}];\r\n\r\n\t/**\r\n\t * Takes a file system path to a file (most likely a template path) and returns the server compatible path\r\n\t *\r\n\t * @param {string} appName - the name of the django app\r\n\t * @param {string} fsPath - relative path to a file resource on disk. The path must be relative to appName/js directory\r\n\t *   path\r\n\t * @returns {string} - a server compatible path\r\n\t */\r\n\tfunction buildUrl(appName, fsPath) {\r\n\t  return staticPrefix + appName + '/js/' + fsPath\r\n\t}\r\n\r\n\t/**\r\n\t * sets the static root on an angular app - so we can use a variable in our views rather hard-coding the static root\r\n\t * value\r\n\t * @param {angular.module} app the angular module on which we wish to set the static root\r\n\t */\r\n\tfunction setStaticPrefix(app) {\r\n\t  app.run(['$rootScope', function ($rootScope) {\r\n\t    $rootScope.staticPrefix = staticPrefix\r\n\t    $rootScope.addIconSrc = staticPrefix + 'core_recons/css/images/icon_addposting.gif'\r\n\t  }])\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t  interpolateProviderConfig: interpolateProviderConfig,\r\n\r\n\t  buildUrl: buildUrl,\r\n\r\n\t  rootAppName: 'core_recons',\r\n\r\n\t  setStaticPrefix: setStaticPrefix\r\n\t}\r\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\tvar app = angular.module('lc-cover', [\r\n\t  'rootApp',\r\n\t  'add-form-m-form-m-object'\r\n\t])\r\n\r\n\tapp.directive('lcCover', lcIssueDirective)\r\n\r\n\tlcIssueDirective.$inject = []\r\n\r\n\tfunction lcIssueDirective() {\r\n\t  return {\r\n\t    restrict: 'A',\r\n\t    templateUrl: __webpack_require__(5).buildUrl('form-m/add-form-m/lc-cover/lc-cover.html'),\r\n\t    scope: true,\r\n\t    bindToController: {\r\n\t      formM: '=mfContext',\r\n\t      cover: '=',\r\n\t      onCoverChanged: '&'\r\n\t    },\r\n\t    controller: 'LcCoverDirectiveController as lcCover'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('LcCoverDirectiveController', LcCoverDirectiveController)\r\n\r\n\tLcCoverDirectiveController.$inject = [\r\n\t  '$scope',\r\n\t  'formMCoverTypes',\r\n\t  '$filter',\r\n\t  'formFieldIsValid',\r\n\t  'formMObject'\r\n\t]\r\n\r\n\tfunction LcCoverDirectiveController($scope, formMCoverTypes, $filter, formFieldIsValid, formMObject) {\r\n\t  var vm = this\r\n\t  vm.formM = formMObject\r\n\t  var title = 'Register Cover'\r\n\t  init()\r\n\r\n\t  function init(form) {\r\n\t    vm.title = title\r\n\t    vm.coverTypes = null\r\n\t    formMObject.cover = {}\r\n\r\n\t    if (form) {\r\n\t      form.$setPristine()\r\n\t      form.$setUntouched()\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.isValid = function isValid(name, validity) {\r\n\t    return formFieldIsValid($scope, 'coverForm', name, validity)\r\n\t  }\r\n\r\n\t  vm.amountGetterSetter = function (val) {\r\n\t    if (arguments.length) {\r\n\t      if (!/[\\d,\\.]+/.test(val)) formMObject.cover.amount = null\r\n\t      else formMObject.cover.amount = Number(val.replace(/,/g, ''))\r\n\t    } else return formMObject.cover.amount ? $filter('number')(formMObject.cover.amount, 2) : ''\r\n\t  }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    formMObject.showCoverForm = vm.formM.amount && vm.formM.number && !formMObject.showCoverForm\r\n\r\n\t    if (!formMObject.showCoverForm) {\r\n\t      init(form)\r\n\t    }\r\n\t    else {\r\n\t      vm.title = 'Dismiss'\r\n\t      vm.coverTypes = formMCoverTypes\r\n\t      formMObject.cover.amount = vm.formM.amount\r\n\t    }\r\n\t  }\r\n\r\n\t  $scope.$watch(function getFormM() {return vm.formM}, function (formM) {\r\n\t    formMObject.coverForm = $scope.coverForm\r\n\t    if (formM) {\r\n\t      if (!formM.amount || !formM.number) {\r\n\t        init(formMObject.coverForm)\r\n\t      }\r\n\t    }\r\n\t  }, true)\r\n\t}\r\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('lc-bid', ['add-fx-allocation', 'lc-bid-request'])\r\n\r\n\tapp.directive('lcBid', lcBidDirective)\r\n\r\n\tlcBidDirective.$inject = []\r\n\r\n\tfunction lcBidDirective() {\r\n\t  return {\r\n\t    restrict: 'A',\r\n\t    templateUrl: __webpack_require__(5).buildUrl('form-m/add-form-m/lc-bid/lc-bid.html'),\r\n\t    scope: true,\r\n\t    controller: 'LcBidDirectiveController as lcBid'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('LcBidDirectiveController', LcBidDirectiveController)\r\n\r\n\tLcBidDirectiveController.$inject = [\r\n\t  '$scope',\r\n\t  '$filter',\r\n\t  'formFieldIsValid',\r\n\t  'underscore',\r\n\t  'LcBidRequest',\r\n\t  'xhrErrorDisplay',\r\n\t  'confirmationDialog',\r\n\t  'formMObject',\r\n\t  'resetForm2',\r\n\t  'moment',\r\n\t  'toISODate',\r\n\t  'ViewBidDetail'\r\n\t]\r\n\r\n\tfunction LcBidDirectiveController($scope, $filter, formFieldIsValid, underscore, LcBidRequest, xhrErrorDisplay,\r\n\t                                  confirmationDialog, formMObject, resetForm2, moment, toISODate, ViewBidDetail) {\r\n\t  var vm = this\r\n\t  vm.formM = formMObject\r\n\t  var title = 'New Bid Request'\r\n\t  vm.selectedBids = {}\r\n\r\n\t  init()\r\n\t  function init(form) {\r\n\t    vm.datePickerIsOpen = {\r\n\t      bidRequestedDate: false,\r\n\t      bidCreatedDate: false,\r\n\t      bidMaturityDate: false\r\n\t    }\r\n\t    vm.title = title\r\n\t    vm.formM.showBidForm = false\r\n\t    vm.formM.showEditBid = false\r\n\t    vm.bidToEdit = null\r\n\t    formMObject.bid = {}\r\n\t    vm.showAllocateFx = false\r\n\r\n\t    if (form) {\r\n\t      var bidFormCtrlNames = ['bidMaturityDate', 'bidAmount', 'bidGoodsDescription']\r\n\t      resetForm2(form, [{form: form, elements: bidFormCtrlNames}])\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.openDatePicker = function openDatePicker(prop) {\r\n\t    underscore.each(vm.datePickerIsOpen, function (val, key) {\r\n\t      vm.datePickerIsOpen[key] = prop === key\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.isValid = function (name, validity) {\r\n\t    return formFieldIsValid($scope, 'bidForm', name, validity)\r\n\t  }\r\n\r\n\t  vm.amountGetterSetter = function (val) {\r\n\t    if (arguments.length) {\r\n\t      if (!/[\\d,\\.]+/.test(val)) vm.formM.bid.amount = null\r\n\t      else vm.formM.bid.amount = Number(val.replace(/,/g, ''))\r\n\r\n\t    } else return vm.formM.bid.amount ? $filter('number')(vm.formM.bid.amount, 2) : null\r\n\t  }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    vm.formM.showBidForm = vm.formM.amount && vm.formM.number && !vm.formM.showBidForm\r\n\r\n\t    if (!vm.formM.showBidForm) init(form)\r\n\t    else {\r\n\t      vm.showAllocateFx = false\r\n\t      vm.title = 'Dismiss'\r\n\t      formMObject.bid.goods_description = formMObject.goods_description\r\n\t      vm.formM.bid.amount = !vm.formM.existingBids.length ? formMObject.amount : null\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.editBidInvalid = function editBidInvalid(form) {\r\n\t    if (underscore.isEmpty(vm.bidToEdit)) return true\r\n\r\n\t    if (form.$invalid) return true\r\n\r\n\t    return underscore.all(bidNotModified())\r\n\t  }\r\n\r\n\t  function copyBidForEdit() {\r\n\t    vm.bidToEdit.amount = Number(vm.bidToEdit.amount)\r\n\t    vm.formM.bid.amount = vm.bidToEdit.amount\r\n\t    vm.formM.bid.downloaded = vm.bidToEdit.downloaded\r\n\t    vm.bidToEdit.created_at = new Date(vm.bidToEdit.created_at)\r\n\t    vm.formM.bid.created_at = vm.bidToEdit.created_at\r\n\t    vm.bidToEdit.requested_at = vm.bidToEdit.requested_at ? new Date(vm.bidToEdit.requested_at) : null\r\n\t    vm.formM.bid.requested_at = vm.bidToEdit.requested_at\r\n\t    vm.bidToEdit.maturity = vm.bidToEdit.maturity ? new Date(vm.bidToEdit.maturity) : null\r\n\t    vm.formM.bid.maturity = vm.bidToEdit.maturity\r\n\t  }\r\n\r\n\t  function toHumanDate(dtObj) {\r\n\t    return dtObj ? moment(dtObj).format('DD-MMM-YYYY') : null\r\n\t  }\r\n\r\n\t  function getSelectedBids(selections) {\r\n\t    var index, result = []\r\n\r\n\t    for (index in selections) {\r\n\t      if (selections[index]) {\r\n\t        var bid = getBidFromId(index)\r\n\t        if (bid) result.push(bid)\r\n\t      }\r\n\t    }\r\n\r\n\t    return result\r\n\t  }\r\n\r\n\t  vm.onEditBid = function onEditBid(selectedBids, form) {\r\n\t    var bids = getSelectedBids(selectedBids)\r\n\t    if (bids.length !== 1) return\r\n\t    form.$setPristine()\r\n\t    vm.formM.showEditBid = true\r\n\t    vm.formM.showBidForm = false\r\n\t    vm.toggleShow()\r\n\t    vm.bidToEdit = angular.copy(bids[0])\r\n\t    copyBidForEdit()\r\n\t  }\r\n\r\n\t  vm.trashBid = function trashBid(selectedBids) {\r\n\t    var bids = getSelectedBids(selectedBids)\r\n\t    if (bids.length !== 1) return\r\n\t    init()\r\n\t    var bid = bids[0]\r\n\t    var text = '\\n' +\r\n\t      '\\nApplicant  : ' + bid.applicant +\r\n\t      '\\nForm M     : ' + bid.form_m_number +\r\n\t      '\\nBid Amount : ' + bid.currency + ' ' + $filter('number')(bid.amount, 2)\r\n\r\n\t    var mf = '\"' + bid.form_m_number + '\"'\r\n\r\n\t    confirmationDialog.showDialog({\r\n\t      text: 'Sure you want to delete bid:' + text, title: 'Delete bid for ' + mf\r\n\t    }).then(function (answer) {\r\n\t      if (answer) {\r\n\t        LcBidRequest.delete(bid).$promise.then(bidDeleteSuccess, function bidDeleteFailure(xhr) {\r\n\t          xhrErrorDisplay(xhr)\r\n\t        })\r\n\t      }\r\n\t    })\r\n\r\n\t    function bidDeleteSuccess() {\r\n\t      confirmationDialog.showDialog({\r\n\t        text: 'Bid delete successfully:' + text,\r\n\t        title: 'Bid for ' + mf + ' deleted successfully',\r\n\t        infoOnly: true\r\n\t      })\r\n\t      formMObject.setBids()\r\n\t      vm.selectedBids = {}\r\n\t    }\r\n\t  }\r\n\r\n\t  function createEditBidMessage(bidIsNotModified) {\r\n\t    var text = '\\n\\nForm M:           ' + vm.bidToEdit.form_m_number\r\n\t    var ccy = formMObject.currency.code\r\n\r\n\t    if (!bidIsNotModified.amount) {\r\n\t      text += '\\nBid Amount' +\r\n\t        '\\n  before edit:    ' + ccy + $filter('number')(vm.bidToEdit.amount, 2) +\r\n\t        '\\n  after edit:     ' + ccy + $filter('number')(formMObject.bid.amount, 2)\r\n\t    }\r\n\r\n\t    if (!bidIsNotModified.goods_description) {\r\n\t      text += '\\nGoods description' +\r\n\t        '\\n  before edit:    ' + vm.bidToEdit.goods_description +\r\n\t        '\\n  after edit:     ' + formMObject.bid.goods_description\r\n\t    }\r\n\r\n\t    if (!bidIsNotModified.maturity) {\r\n\t      text += '\\nMaturity' +\r\n\t        '\\n  before edit:    ' + toHumanDate(vm.bidToEdit.maturity) +\r\n\t        '\\n  after edit:     ' + toHumanDate(formMObject.bid.maturity)\r\n\t    }\r\n\r\n\t    if (!bidIsNotModified.created_at) {\r\n\t      text += '\\nDate created' +\r\n\t        '\\n  before edit:    ' + toHumanDate(vm.bidToEdit.created_at) +\r\n\t        '\\n  after edit:     ' + toHumanDate(formMObject.bid.created_at)\r\n\t    }\r\n\r\n\t    if (!bidIsNotModified.requested_at) {\r\n\t      text += '\\nDate requested' +\r\n\t        '\\n  before edit:    ' + toHumanDate(vm.bidToEdit.requested_at) +\r\n\t        '\\n  after edit:     ' + toHumanDate(formMObject.bid.requested_at)\r\n\t    }\r\n\r\n\t    if (!bidIsNotModified.downloaded) {\r\n\t      text += '\\nDownloaded' +\r\n\t        '\\n  before edit:    ' + vm.bidToEdit.downloaded +\r\n\t        '\\n  after edit:     ' + vm.formM.bid.downloaded\r\n\t    }\r\n\r\n\t    return text\r\n\t  }\r\n\r\n\t  vm.editBid = function editBid() {\r\n\t    var title = 'Edit bid \"' + vm.bidToEdit.form_m_number + '\"'\r\n\t    var bidIsNotModified = bidNotModified()\r\n\t    var text = createEditBidMessage(bidIsNotModified)\r\n\r\n\r\n\t    confirmationDialog.showDialog({\r\n\t      title: title,\r\n\t      text: 'Are you sure you want to edit Bid:' + text\r\n\t    }).then(function (answer) {\r\n\t      if (answer) doEdit()\r\n\t      else copyBidForEdit()\r\n\t    })\r\n\r\n\t    function doEdit() {\r\n\t      var bid = angular.copy(vm.bidToEdit)\r\n\r\n\t      if (!bidIsNotModified.goods_description) {\r\n\t        bid.update_goods_description = true\r\n\t        formMObject.goods_description = formMObject.bid.goods_description\r\n\t      }\r\n\r\n\t      underscore.each(formMObject.bid, function (val, key) {\r\n\t        if (key === 'created_at' || key === 'requested_at' || key === 'maturity') val = toISODate(val)\r\n\t        bid[key] = val\r\n\t      })\r\n\r\n\t      LcBidRequest.put(bid).$promise.then(function () {\r\n\t        confirmationDialog.showDialog({title: title, text: 'Edit successful: ' + text, infoOnly: true})\r\n\t        init()\r\n\t        formMObject.setBids(bidsNewlySetCb)\r\n\r\n\t      }, function (xhr) {\r\n\t        xhrErrorDisplay(xhr)\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.viewBidDetail = function (selectedBids) {\r\n\t    var bids = getSelectedBids(selectedBids)\r\n\t    if (bids.length !== 1) return\r\n\t    init()\r\n\t    ViewBidDetail.showDialog({bid: bids[0]})\r\n\t  }\r\n\r\n\t  vm.allocateFx = function allocateFx(selectedBids) {\r\n\t    var bids = getSelectedBids(selectedBids)\r\n\t    if (bids.length !== 1) return\r\n\t    var bid = bids[0]\r\n\t    vm.formM.showBidForm = false\r\n\t    vm.title = title\r\n\r\n\t    vm.initialBidProps = {\r\n\t      currency: formMObject.currency,\r\n\t      content_type: bid.ct_url,\r\n\t      object_id: bid.id\r\n\t    }\r\n\t    vm.allocationTitle = 'bid amount: ' + $filter('number')(bid.amount, 2)\r\n\t    vm.showAllocateFx = true\r\n\t  }\r\n\r\n\t  vm.onFxAllocated = function onFxAllocated(result) {\r\n\t    function getAmount(val) {\r\n\t      return result.currency_data.code + ' ' + $filter('number')(val, 2)\r\n\t    }\r\n\r\n\t    var text = '' +\r\n\t      '\\nDeal number     : ' + result.deal_number +\r\n\t      '\\nDeal date       : ' + $filter('date')(result.allocated_on, 'dd-MMM-yyyy') +\r\n\t      '\\nAmount allocated: ' + getAmount(result.amount_allocated) +\r\n\t      '\\nAmount utilized : ' + getAmount(result.amount_utilized) +\r\n\t      '\\nDate utilized   : ' + $filter('date')(result.utilized_on, 'dd-MMM-yyyy')\r\n\r\n\t    confirmationDialog.showDialog({title: 'Allocation success', text: text, infoOnly: true})\r\n\t    init()\r\n\t    formMObject.setBids(bidsNewlySetCb)\r\n\t  }\r\n\r\n\t  vm.dismissShowAllocateFxForm = function dismissShowAllocateFxForm() {\r\n\t    vm.showAllocateFx = false\r\n\t  }\r\n\r\n\t  function bidNotModified() {\r\n\t    return {\r\n\t      amount: vm.bidToEdit.amount === formMObject.bid.amount,\r\n\t      goods_description: vm.bidToEdit.goods_description === formMObject.bid.goods_description,\r\n\t      downloaded: vm.bidToEdit.downloaded === formMObject.bid.downloaded,\r\n\t      created_at: angular.equals(vm.bidToEdit.created_at, formMObject.bid.created_at),\r\n\t      requested_at: angular.equals(vm.bidToEdit.requested_at, formMObject.bid.requested_at),\r\n\t      maturity: angular.equals(vm.bidToEdit.maturity, formMObject.bid.maturity)\r\n\t    }\r\n\t  }\r\n\r\n\t  function getBidFromId(id) {\r\n\t    for (var bidIndex = 0; bidIndex < vm.formM.existingBids.length; bidIndex++) {\r\n\t      var bid = vm.formM.existingBids[bidIndex]\r\n\r\n\t      if (bid.id === +id) return bid\r\n\t    }\r\n\r\n\t    return null\r\n\t  }\r\n\r\n\t  function checkBids(selectedBids) {\r\n\t    vm.selectedBidsLen = 0\r\n\r\n\t    underscore.each(selectedBids, function (checked, id) {\r\n\t      if (checked) ++vm.selectedBidsLen\r\n\r\n\t      var bid = getBidFromId(id)\r\n\t      if (bid) bid.checked = checked\r\n\r\n\t    })\r\n\r\n\t    if (formMObject.existingBids.length && !vm.selectedBidsLen) init()\r\n\t  }\r\n\r\n\t  function bidsNewlySetCb() {\r\n\t    checkBids(vm.selectedBids)\r\n\t  }\r\n\r\n\t  $scope.$watch(function getFormMObject() {return formMObject}, function onFormMObjectChanged(formM) {\r\n\t    formMObject.bidForm = $scope.bidForm\r\n\r\n\t    if (formM) {\r\n\t      if (!formM.amount || !formM.number) {\r\n\t        init(formMObject.bidForm)\r\n\t        vm.selectedBids = {}\r\n\t        vm.selectedBidsLen = 0\r\n\t      }\r\n\t    }\r\n\t  }, true)\r\n\r\n\t  $scope.$watch(function getSelectedBids() {return vm.selectedBids}, function onSelectedBidsChanged(selectedBids) {\r\n\t    if (selectedBids) checkBids(selectedBids)\r\n\t  }, true)\r\n\t}\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('form-m-comment', [\r\n\t  'rootApp',\r\n\t  'comment-service'\r\n\t])\r\n\r\n\tapp.directive('formMComment', formMCommentDirective)\r\n\r\n\tformMCommentDirective.$inject = []\r\n\r\n\tfunction formMCommentDirective() {\r\n\t  return {\r\n\t    restrict: 'A',\r\n\t    templateUrl: __webpack_require__(5).buildUrl('form-m/add-form-m/comment/comment.html'),\r\n\t    scope: true,\r\n\t    controller: 'FormMCommentDirectiveController as formMComment'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('FormMCommentDirectiveController', FormMCommentDirectiveController)\r\n\r\n\tFormMCommentDirectiveController.$inject = [\r\n\t  '$scope',\r\n\t  'formFieldIsValid',\r\n\t  'underscore',\r\n\t  'confirmationDialog',\r\n\t  'formMObject',\r\n\t  'resetForm2'\r\n\t]\r\n\r\n\tfunction FormMCommentDirectiveController($scope, formFieldIsValid, underscore, confirmationDialog, formMObject,\r\n\t  resetForm2) {\r\n\t  var vm = this\r\n\t  vm.formM = formMObject\r\n\t  var title = 'Add comment'\r\n\t  var confirmationTitleLength = 40\r\n\r\n\t  init()\r\n\t  function init(form) {\r\n\t    vm.title = title\r\n\t    vm.formM.showCommentForm = false\r\n\t    vm.formM.showEditComment = false\r\n\t    vm.commentToEdit = null\r\n\t    formMObject.commentText = null\r\n\r\n\t    if (form) resetForm2(form)\r\n\t  }\r\n\r\n\t  vm.isValid = function (name, validity) { return formFieldIsValid($scope, 'commentForm', name, validity) }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    vm.formM.showCommentForm = formMObject._id && !vm.formM.showCommentForm\r\n\r\n\t    if (!vm.formM.showCommentForm) init(form)\r\n\t    else vm.title = 'Dismiss'\r\n\t  }\r\n\r\n\t  vm.editCommentInvalid = function editCommentInvalid(form) {\r\n\t    if (underscore.isEmpty(vm.commentToEdit) || form.$invalid) return true\r\n\r\n\t    return vm.commentToEdit.text === formMObject.commentText\r\n\t  }\r\n\r\n\t  vm.onCommentDblClick = function onCommentDblClick(comment) {\r\n\t    vm.formM.showEditComment = true\r\n\t    vm.formM.showCommentForm = false\r\n\t    vm.toggleShow()\r\n\t    vm.commentToEdit = angular.copy(comment)\r\n\t    formMObject.commentText = vm.commentToEdit.text\r\n\t  }\r\n\r\n\t  vm.viewComment = function viewComment(comment) {\r\n\t    confirmationDialog.showDialog({\r\n\t      title: 'View comment \"' + comment.text.slice(0, confirmationTitleLength) + '\"',\r\n\t      text: comment.text,\r\n\t      infoOnly: true\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.editComment = function editComment(text, form) {\r\n\t    formMObject.editComment(text, vm.commentToEdit).then(function () {init(form)})\r\n\t  }\r\n\r\n\t  vm.addComment = function addComment(text, form) {\r\n\t    formMObject.addComment(text).then(function () { init(form) })\r\n\t  }\r\n\r\n\t  $scope.$watch(function () {return formMObject}, function onFormMObjectChanged(formM) {\r\n\t    formMObject.commentForm = $scope.commentForm\r\n\r\n\t    if (formM) {\r\n\t      if (!formM.amount || !formM.number) init(formMObject.commentForm)\r\n\t    }\r\n\t  }, true)\r\n\t}\r\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\t__webpack_require__(12)\r\n\r\n\tvar app = angular.module('form-m-bids', [\r\n\t  'ui.router',\r\n\t  'lc-bid-request',\r\n\t  'rootApp',\r\n\t  'kanmii-URI',\r\n\t  'search-bids'\r\n\t])\r\n\r\n\tapp.config(bidURLConfig)\r\n\tbidURLConfig.$inject = ['$stateProvider']\r\n\tfunction bidURLConfig($stateProvider) {\r\n\r\n\t  $stateProvider\r\n\t    .state('form_m.bids', {\r\n\r\n\t      kanmiiTitle: 'Bids',\r\n\r\n\t      views: {\r\n\t        bids: {\r\n\t          template: __webpack_require__(14),\r\n\r\n\t          controller: 'BidRequestController as bidHome'\r\n\t        }\r\n\t      }\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('BidRequestController', BidRequestController)\r\n\tBidRequestController.$inject = [\r\n\t  'LcBidRequest',\r\n\t  '$scope',\r\n\t  '$http',\r\n\t  'kanmiiUri',\r\n\t  'urls',\r\n\t  'underscore',\r\n\t  'formatDate',\r\n\t  '$timeout',\r\n\t  '$q'\r\n\t]\r\n\tfunction BidRequestController(LcBidRequest, $scope, $http, kanmiiUri, urls, underscore, formatDate, $timeout, $q) {\r\n\t  var vm = this;\r\n\r\n\t  initialize()\r\n\t  function initialize() {\r\n\t    vm.selectedBids = {}\r\n\t    vm.selectedDownloadedBids = {}\r\n\r\n\t    /**\r\n\t     * The bids retrieved from backend. Will contain a list of bids and pagination hooks for\r\n\t     * retrieving the next and previous sets of bids. This model is used by the display directive\r\n\t     * to display the bids in a table\r\n\t     * @type {object}\r\n\t     */\r\n\t    vm.bidRequests = []\r\n\t    vm.paginationHooks = {}\r\n\r\n\t    if (!arguments.length) {\r\n\t      LcBidRequest.pending().$promise.then(function (data) {\r\n\t        updateBids(data)\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  /**\r\n\t   * When a row of the pending bids table is clicked, this function is invoked with the bid at that row\r\n\t   * @param {{}} bid - the bid object at the row that was double clicked\r\n\t   */\r\n\t  vm.rowDblClickCb = function rowDblClickCb(bid) {\r\n\t    $scope.goToFormM(bid.form_m_number)\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Will be invoked when any of the pager links is clicked in other to get the bids at the pager url\r\n\t   * @type {getBidsOnNavigation}\r\n\t   */\r\n\t  vm.getBidsOnNavigation = getBidsOnNavigation\r\n\t  function getBidsOnNavigation(linkUrl) {\r\n\t    $http.get(linkUrl).then(function (response) {\r\n\t      updateBids(response.data)\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.onBidsSearched = function onBidsSearched(result) {\r\n\t    initialize(false)\r\n\t    updateBids(result)\r\n\t  }\r\n\r\n\t  $scope.$watch(function searchedBidResult() {return vm.searchedBidResult},\r\n\t    function searchedBidResultChanged(searchedBidResult) {\r\n\t      if (searchedBidResult) {\r\n\t        updateBids(searchedBidResult)\r\n\t      }\r\n\t    })\r\n\r\n\t  /**\r\n\t   * Update the bid collection and pagination hooks\r\n\t   * @param {object} data\r\n\t   */\r\n\t  function updateBids(data) {\r\n\t    vm.bidRequests = data.results\r\n\t    vm.paginationHooks = {next: data.next, previous: data.previous, count: data.count}\r\n\t  }\r\n\r\n\t  var url = kanmiiUri(urls.lcBidRequestDownloadUrl)\r\n\t  vm.downloadUrl = function downloadUrl() {\r\n\t    if (!underscore.isEmpty(vm.selectedBids)) {\r\n\t      var search = []\r\n\r\n\t      underscore.each(vm.selectedBids, function (selection, bidId) {\r\n\t        if (selection === true) search.push(bidId)\r\n\t      })\r\n\r\n\t      return search.length ? url.search({bid_ids: search}).toString() : null\r\n\t    }\r\n\r\n\t    return null\r\n\t  }\r\n\r\n\t  vm.downloadBtnDisabled = function downloadBtnDisabled() {\r\n\t    if (underscore.isEmpty(vm.selectedBids)) return true\r\n\r\n\t    return !underscore.any(vm.selectedBids, function (selectionVal) {\r\n\t      return selectionVal === true\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.onSelectedBidsChanged = onSelectedBidsChanged\r\n\t  function onSelectedBidsChanged(newSelections) {\r\n\t    if (newSelections && !underscore.isEmpty(newSelections)) {\r\n\t      underscore.each(newSelections, function (checked, bidId) {\r\n\t        var bid = getBidFromId(bidId)\r\n\r\n\t        if (bid && bid.downloaded) vm.selectedDownloadedBids[bidId] = checked\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.markRequestedBtnDisabled = function markRequestedBtnDisabled() {\r\n\t    if (underscore.isEmpty(vm.selectedDownloadedBids)) return true\r\n\r\n\t    for (var bidId in vm.selectedBids) {\r\n\t      if (!(bidId in vm.selectedDownloadedBids) && vm.selectedBids[bidId]) return true\r\n\t    }\r\n\r\n\t    return !underscore.any(vm.selectedDownloadedBids, function (checked) {\r\n\t      return checked === true\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.markRequested = function markRequested() {\r\n\t    var editedBids = []\r\n\r\n\t    underscore.each(vm.selectedDownloadedBids, function (checked, bidId) {\r\n\t      if (!checked) return\r\n\r\n\t      var bid = getBidFromId(bidId)\r\n\t      if (bid) {\r\n\t        bid.requested_at = formatDate(new Date())\r\n\t        editedBids.push(LcBidRequest.put(bid).$promise)\r\n\t      }\r\n\t    })\r\n\r\n\t    if (editedBids.length) {\r\n\t      $q.all(editedBids).then(function () {\r\n\t        initialize()\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.refreshPage = function refreshPage() {\r\n\t    if (!vm.downloadBtnDisabled()) {\r\n\t      $timeout(function () {initialize()}, 3000)\r\n\t    }\r\n\t  }\r\n\r\n\t  function getBidFromId(bidId) {\r\n\t    for (var index = 0; index < vm.bidRequests.length; index++) {\r\n\t      var bid = vm.bidRequests[index]\r\n\t      if (bid.id === +bidId) return bid\r\n\t    }\r\n\r\n\t    return null\r\n\t  }\r\n\t}\r\n\r\n\t__webpack_require__(15)\r\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('search-bids', [\r\n\t  'customer',\r\n\t  'lc-bid-request',\r\n\t  'rootApp'\r\n\t])\r\n\r\n\tapp.directive('searchBids', searchBidsDirective)\r\n\r\n\tsearchBidsDirective.$inject = []\r\n\r\n\tfunction searchBidsDirective() {\r\n\t  return {\r\n\t    restrict: 'AE',\r\n\t    template: __webpack_require__(13),\r\n\t    scope: true,\r\n\t    bindToController: {\r\n\t      onBidsSearched: '&'\r\n\t    },\r\n\t    controller: 'searchBidsController as searchBids'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('searchBidsController', searchBidsController)\r\n\tsearchBidsController.$inject = [\r\n\t  'LcBidRequest',\r\n\t  'underscore',\r\n\t  'getTypeAheadCustomer',\r\n\t  'getTypeAheadCurrency',\r\n\t  'resetForm2',\r\n\t  'toISODate'\r\n\t]\r\n\tfunction searchBidsController(LcBidRequest, underscore, getTypeAheadCustomer, getTypeAheadCurrency, resetForm2,\r\n\t  toISODate) {\r\n\t  var vm = this //jshint -W040\r\n\t  vm.showForm = true\r\n\r\n\t  init()\r\n\t  function init() {\r\n\t    vm.searchParams = {\r\n\t      pending: false\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    vm.showForm = !vm.showForm\r\n\r\n\t    if (!vm.showForm) vm.clearForm(form)\r\n\t  }\r\n\r\n\t  vm.validators = {\r\n\t    applicant: {\r\n\t      test: function () {\r\n\t        return underscore.isObject(vm.searchParams.applicant)\r\n\t      }\r\n\t    },\r\n\r\n\t    currency: {\r\n\t      test: function () {\r\n\t        return underscore.isObject(vm.searchParams.currency)\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t  vm.getCurrency = getTypeAheadCurrency\r\n\t  vm.getApplicant = getTypeAheadCustomer\r\n\t  vm.datePickerIsOpen = false\r\n\t  vm.openDatePicker = function openDatePicker() {\r\n\t    vm.datePickerIsOpen = true\r\n\t  }\r\n\r\n\t  vm.clearForm = function clearForm(form) {\r\n\t    resetForm2(form)\r\n\t    init()\r\n\t  }\r\n\r\n\t  vm.searchBids = function searchBids(searchParams) {\r\n\t    var params = angular.copy(searchParams)\r\n\t    params.applicant = params.applicant ? /\\d+$/.exec(params.applicant.url)[0] : null\r\n\t    params.currency = params.currency ? params.currency.code : null\r\n\t    params.created_at = params.created_at ? toISODate(params.created_at) : null\r\n\r\n\t    if (!params.pending) delete params.pending\r\n\r\n\t    LcBidRequest.getPaginated(params).$promise.then(function (data) {\r\n\t      vm.onBidsSearched({searchResult: data})\r\n\t    })\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"search-bids-directive\\\"><div class=\\\"search-bid-toggle-show\\\"><div ng-click=\\\"searchBids.toggleShow(searchBidsForm)\\\" class=\\\"form-m-add-on-toggle clearfix\\\"><span class=\\\"form-m-add-on-show-helper\\\" ng-if=\\\"searchBids.showForm\\\"></span><div class=\\\"form-m-add-on-show-icon form-m-bid-add-on-show-icon\\\"><span ng-class=\\\"['glyphicon', {'glyphicon-chevron-down': !searchBids.showForm, 'glyphicon-chevron-up': searchBids.showForm}]\\\"></span> Search Bids</div></div></div><form class=\\\"form-horizontal\\\" name=\\\"searchBidsForm\\\" role=\\\"form\\\" autocomplete=\\\"off\\\" ng-show=\\\"searchBids.showForm\\\" ng-submit=\\\"searchBids.searchBids(searchBids.searchParams)\\\"><div class=\\\"form-group form-m-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"form-m-number\\\" class=\\\"control-label col-sm-3\\\">Form M Number</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"formMNumber\\\" ng-model=\\\"searchBids.searchParams.mf\\\" id=\\\"form-m-number\\\" to-upper=\\\"\\\" ng-pattern=\\\"/(?:mf)?\\\\d{3,}/i\\\" maxlength=\\\"13\\\"></div></div><div class=\\\"form-group applicant-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"applicant\\\" class=\\\"control-label col-sm-3\\\">Applicant</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"applicant\\\" ng-model=\\\"searchBids.searchParams.applicant\\\" id=\\\"applicant\\\" ng-minlength=\\\"3\\\" ng-pattern=\\\"searchBids.validators.applicant\\\" typeahead-min-length=\\\"3\\\" uib-typeahead=\\\"applicant as applicant.name for applicant in searchBids.getApplicant($viewValue)\\\" typeahead-select-on-blur=\\\"true\\\" typeahead-select-on-exact=\\\"true\\\"></div></div><div class=\\\"form-group currency-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"currency\\\" class=\\\"control-label col-sm-3\\\">Currency</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"currency\\\" ng-model=\\\"searchBids.searchParams.currency\\\" id=\\\"currency\\\" maxlength=\\\"3\\\" ng-pattern=\\\"searchBids.validators.currency\\\" autocomplete=\\\"off\\\" uib-typeahead=\\\"currency as currency.code for currency in searchBids.getCurrency($viewValue)\\\" typeahead-select-on-blur=\\\"true\\\" typeahead-select-on-exact=\\\"true\\\"></div></div><div class=\\\"form-group amount-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"amount\\\" class=\\\"control-label col-sm-3\\\">Amount</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"amount\\\" ng-model=\\\"searchBids.searchParams.amount\\\" id=\\\"amount\\\" number-format=\\\"\\\"></div></div><div class=\\\"form-group created-date-group\\\" control-has-feedback=\\\"\\\" feedback-after=\\\".input-group-addon\\\"><label for=\\\"created-at\\\" class=\\\"control-label col-sm-3\\\">Created At</label><div class=\\\"col-sm-9\\\"><div class=\\\"input-group\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"createdAt\\\" ng-model=\\\"searchBids.searchParams.created_at\\\" id=\\\"created-at\\\" uib-datepicker-popup=\\\"dd-MMM-yyyy\\\" is-open=\\\"searchBids.datePickerIsOpen\\\"> <span class=\\\"input-group-addon\\\" ng-click=\\\"searchBids.openDatePicker($event)\\\"><i class=\\\"glyphicon glyphicon-calendar\\\"></i></span></div></div></div><div class=\\\"form-group lc-number-group\\\"><label for=\\\"lc-number\\\" class=\\\"control-label col-sm-3\\\">LC Number</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"lcNumber\\\" ng-model=\\\"searchBids.searchParams.lc_number\\\" id=\\\"lc-number\\\" to-upper=\\\"\\\" maxlength=\\\"16\\\"></div></div><div class=\\\"form-group pending-group\\\"><label for=\\\"pending\\\" class=\\\"control-label col-sm-3\\\">Pending only</label><div class=\\\"col-sm-9\\\"><input type=\\\"checkbox\\\" name=\\\"pending\\\" ng-model=\\\"searchBids.searchParams.pending\\\" id=\\\"pending\\\"></div></div><div class=\\\"form-group submit-group\\\"><div class=\\\"col-sm-9 col-sm-offset-3\\\"><div class=\\\"clearfix\\\"><div class=\\\"pull-left\\\"><input type=\\\"submit\\\" class=\\\"btn btn-info\\\" value=\\\"Search Bids\\\" ng-disabled=\\\"searchBidsForm.$invalid\\\"></div><div class=\\\"pull-right\\\" style=\\\"text-align: right\\\"><input type=\\\"button\\\" class=\\\"btn btn-warning\\\" value=\\\"Clear All\\\" ng-click=\\\"searchBids.clearForm(searchBidsForm)\\\"></div></div></div></div></form></div>\";\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"list-bid-view\\\"><div class=\\\"row\\\" style=\\\"margin-bottom: 30px; margin-top: 10px\\\"><div class=\\\"col-sm-6\\\"><div search-bids=\\\"\\\" on-bids-searched=\\\"bidHome.onBidsSearched(searchResult)\\\"></div></div><div class=\\\"col-sm-6\\\"><div class=\\\"action-buttons\\\" style=\\\"text-align: right;\\\"><a class=\\\"btn btn-success\\\" ng-href=\\\"{$bidHome.downloadUrl()$}\\\" ng-disabled=\\\"bidHome.downloadBtnDisabled()\\\" ng-click=\\\"bidHome.refreshPage()\\\">Download</a> <button type=\\\"button\\\" name=\\\"bid-home-mark-as-requested-btn\\\" class=\\\"btn btn-success\\\" ng-click=\\\"bidHome.markRequested()\\\" ng-disabled=\\\"bidHome.markRequestedBtnDisabled()\\\">Mark as requested</button></div></div></div><div display-pending-bid=\\\"\\\" pending-bids=\\\"bidHome.bidRequests\\\" pager-object=\\\"bidHome.paginationHooks\\\" update-collection=\\\"bidHome.getBidsOnNavigation(linkUrl)\\\" pagination-size=\\\"20\\\" selected-bids=\\\"bidHome.selectedBids\\\" on-selected-bids-changed=\\\"bidHome.onSelectedBidsChanged(newSelections)\\\" on-row-dbl-click=\\\"bidHome.rowDblClickCb(bid)\\\" table-caption=\\\"bidHome.tableCaption\\\"></div></div>\";\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar lcAppCommons = __webpack_require__(5)\r\n\r\n\tvar app = angular.module('form-m-bids')\r\n\r\n\tapp.directive('displayPendingBid', displayPendingBidDirective)\r\n\tfunction displayPendingBidDirective() {\r\n\t  return {\r\n\t    restrict: 'EA',\r\n\r\n\t    templateUrl: lcAppCommons.buildUrl('form-m/bids/display-pending-bid/display-pending-bid.html'),\r\n\r\n\t    scope: true,\r\n\r\n\t    bindToController: {\r\n\t      bids: '=pendingBids',\r\n\r\n\t      updateCollection: '&',\r\n\r\n\t      onSelectedBidsChanged: '&',\r\n\r\n\t      pager: '=pagerObject',\r\n\r\n\t      onDblClick: '&onRowDblClick',\r\n\r\n\t      paginationSize: '=',\r\n\r\n\t      selectedBids: '='\r\n\t    },\r\n\r\n\t    controller: 'displayPendingBidDirectiveCtrl as bidTable'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('displayPendingBidDirectiveCtrl', displayPendingBidDirectiveCtrl)\r\n\r\n\tdisplayPendingBidDirectiveCtrl.$inject = [\r\n\t  'pagerNavSetUpLinks',\r\n\t  '$scope',\r\n\t  'underscore'\r\n\t]\r\n\r\n\tfunction displayPendingBidDirectiveCtrl(pagerNavSetUpLinks, scope, underscore) {\r\n\t  var vm = this //jshint -W040\r\n\r\n\t  vm.selectedBids = {}\r\n\r\n\t  function setUpLinks(next, prev, count) {\r\n\t    vm.count = count\r\n\t    var numLinks = Math.ceil(count / vm.paginationSize)\r\n\r\n\t    var linkProperties = pagerNavSetUpLinks(next, prev, numLinks)\r\n\r\n\t    vm.nextPageLink = next\r\n\t    vm.prevPageLink = prev\r\n\r\n\t    vm.linkUrls = linkProperties.linkUrls\r\n\t    vm.currentLink = linkProperties.currentLink\r\n\r\n\t    /**\r\n\t     * The row index offset. The row begin at one so in the view, we do `$index + 1` for row number. However, as we\r\n\t     * move from page to page, the `$index` view value is reset back to zero, so that row number always begin at 1.\r\n\t     * Since we know what the page number is (this.currentLink), we calculate the offset for the row (as an arithmetic\r\n\t     * progression)\r\n\t     * @type {number}\r\n\t     */\r\n\t    vm.rowIndexOffset = (vm.currentLink - 1) * vm.paginationSize\r\n\t  }\r\n\r\n\t  vm.onUpdateCollection = onUpdateCollection\r\n\t  function onUpdateCollection(linkUrl) {\r\n\t    vm.updateCollection({linkUrl: linkUrl})\r\n\t  }\r\n\r\n\t  scope.$watch(function getPager() {return vm.pager}, function updatedPager(pager) {\r\n\t    if (pager && !underscore.isEmpty(pager)) {\r\n\t      setUpLinks(pager.next, pager.previous, pager.count)\r\n\t    }\r\n\t  })\r\n\r\n\t  function deselectAllBids() {\r\n\t    vm.bids.forEach(function (bid) {\r\n\t      bid.highlighted = false\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.modelRowClicked = modelRowClicked\r\n\t  function modelRowClicked(model) {\r\n\t    if (!model.downloaded) {\r\n\t      deselectAllBids()\r\n\r\n\t      //only highlight a row if no row is checked and the row model is not downloaded previously\r\n\t      model.highlighted = !underscore.any(vm.bids, function (bid) {\r\n\t        return bid.checked\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.onRowDblClick = function onRowDblClick(bid) {\r\n\t    vm.onDblClick({bid: bid})\r\n\t  }\r\n\r\n\t  scope.$watch(function getSelectedBids() {return vm.selectedBids}, function updatedSelectedBids(selectedBids) {\r\n\t    vm.onSelectedBidsChanged({newSelections: selectedBids})\r\n\r\n\t    if (selectedBids && !underscore.isEmpty(selectedBids)) {\r\n\r\n\t      underscore.each(selectedBids, function (checked, id) {\r\n\r\n\t        for (var bidIndex = 0; bidIndex < vm.bids.length; bidIndex++) {\r\n\t          var bid = vm.bids[bidIndex]\r\n\t          if (bid.id === +id) {\r\n\t            bid.checked = checked\r\n\t          }\r\n\t        }\r\n\r\n\t      })\r\n\r\n\t      vm.toggleAll = underscore.all(vm.bids, function (bid) {\r\n\t        return bid.checked === true\r\n\t      })\r\n\t    }\r\n\t  }, true)\r\n\r\n\t  vm.toggleAll = false\r\n\r\n\t  vm.toggleAllClicked = function toggleAllClicked() {\r\n\t    vm.bids.forEach(function (bid) {\r\n\t      vm.selectedBids[bid.id] = !bid.requested_at && vm.toggleAll\r\n\t    })\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\"\r\n\r\n\tvar app = angular.module('list-form-m',\r\n\t  ['rootApp',\r\n\t   'ui.router',\r\n\t   'form-m-service',\r\n\t   'search-form-m',\r\n\t   'model-table',\r\n\t   'customer',\r\n\t   'add-form-m'\r\n\t  ])\r\n\r\n\tapp.config(formMListURLConfig)\r\n\tformMListURLConfig.$inject = ['$stateProvider']\r\n\tfunction formMListURLConfig($stateProvider) {\r\n\r\n\t  $stateProvider\r\n\t    .state('form_m.list', {\r\n\t      kanmiiTitle: 'Form M List',\r\n\r\n\t      views: {\r\n\t        'listFormM': {\r\n\t          template: __webpack_require__(17),\r\n\r\n\t          controller: 'FormMListController as formMList'\r\n\t        }\r\n\t      }\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('FormMListController', FormMListController)\r\n\tFormMListController.$inject = ['FormM', '$scope', 'formMModelManager', '$http']\r\n\tfunction FormMListController(FormM, scope, formMModelManager, $http) {\r\n\t  var vm = this\r\n\r\n\t  /**\r\n\t   * The model manager will be used by the 'model-table' directive to manage the collection of form Ms retrieved\r\n\t   * from the server\r\n\t   * @type {[]}\r\n\t   */\r\n\t  vm.modelManager = formMModelManager\r\n\r\n\t  vm.modelRowDblClick = function modelRowDblClick(formM) {\r\n\t    scope.goToFormM(formM.number)\r\n\t  }\r\n\r\n\t  /**\r\n\t   * Update the form Ms collection and pagination hooks\r\n\t   * @param {object} data\r\n\t   */\r\n\t  function updateFormMs(data) {\r\n\t    vm.formMs = data.results\r\n\r\n\t    vm.paginationHooks = {next: data.next, previous: data.previous, count: data.count}\r\n\t  }\r\n\r\n\t  vm.updateFormMs = updateFormMs\r\n\r\n\t  /**\r\n\t   * The object containing the hooks for paging through the form Ms collection\r\n\t   * @type {Array}\r\n\t   */\r\n\t  vm.paginationHooks = []\r\n\r\n\t  /**\r\n\t   * The form Ms retrieved from backend. Will contain a list of form Ms and pagination hooks for\r\n\t   * retrieving the next and previous sets of form Ms. This model is used by the display directive\r\n\t   * to display the form Ms in a table\r\n\t   * @type {[]}\r\n\t   */\r\n\t  vm.formMs = []\r\n\t  FormM.getNoLcAttached().$promise.then(function (data) {\r\n\t    updateFormMs(data)\r\n\t  })\r\n\r\n\t  /**\r\n\t   * The table caption for the 'model-table' directive\r\n\t   * @type {string}\r\n\t   */\r\n\t  vm.tableCaption = 'Form M'\r\n\r\n\t  vm.getFormMCollectionOnNavigation = getFormMCollectionOnNavigation\r\n\t  /**\r\n\t   * when we navigate through the form Ms, we make an http request to the link contained in the navigation ui\r\n\t   * @param {string} linkUrl - the url (href) of the link clicked by user\r\n\t   */\r\n\t  function getFormMCollectionOnNavigation(linkUrl) {\r\n\t    $http.get(linkUrl).then(function (response) {\r\n\t      updateFormMs(response.data)\r\n\t    })\r\n\t  }\r\n\r\n\t  /**\r\n\t   * When the search-form-m directive returns, the result is propagated into this model\r\n\t   * @type {null|object}\r\n\t   */\r\n\t  vm.searchedFormMResult = null\r\n\r\n\t  scope.$watch(function getNewFormM() {return vm.searchedFormMResult}, function (searchedFormMResult) {\r\n\t    if (searchedFormMResult) updateFormMs(searchedFormMResult)\r\n\t  })\r\n\t}\r\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"manage-form-m-tab-content\\\"><div class=\\\"row\\\" style=\\\"margin-bottom: 30px; margin-top: 10px\\\"><div class=\\\"col-sm-6\\\"><div search-mf=\\\"\\\" on-mf-search=\\\"formMList.updateFormMs(searchResult)\\\"></div></div></div><div model-table=\\\"\\\" model-collection=\\\"formMList.formMs\\\" table-model-manager=\\\"::formMList.modelManager\\\" table-caption=\\\"::formMList.tableCaption\\\" pagination-size=\\\"20\\\" update-collection=\\\"formMList.getFormMCollectionOnNavigation(linkUrl)\\\" pager-object=\\\"formMList.paginationHooks\\\" on-row-dbl-click-callback=\\\"formMList.modelRowDblClick(rowModel)\\\"></div></div>\";\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('search-detailed-or-uploaded-form-m', [\r\n\t  'upload-form-m-service',\r\n\t  'toggle-dim-element',\r\n\t  'form-m-service'\r\n\t])\r\n\r\n\tapp.factory('SearchDetailedOrUploadedFormMService', SearchDetailedOrUploadedFormMService)\r\n\tSearchDetailedOrUploadedFormMService.$inject = [\r\n\t  'UploadFormM',\r\n\t  'xhrErrorDisplay',\r\n\t  'ModalService',\r\n\t  'underscore',\r\n\t  '$q',\r\n\t  'FormM'\r\n\t]\r\n\tfunction SearchDetailedOrUploadedFormMService(UploadFormM, xhrErrorDisplay, ModalService, underscore, $q, FormM) {\r\n\r\n\t  function searchFormM(submittedSearchParams) {\r\n\t    var deferred = $q.defer()\r\n\t    var mf = submittedSearchParams.mf.trim()\r\n\r\n\t    FormM.getPaginated({number: mf}).$promise.then(function (data) {\r\n\t      if (data.count === 1) {\r\n\t        deferred.resolve({number: data.results[0].number})\r\n\r\n\t      } else UploadFormM.query({mf: mf}).$promise.then(searchFormMSuccess, searchFormMError)\r\n\r\n\t    }, searchFormMError)\r\n\r\n\t    function searchFormMSuccess(data) {\r\n\t      deferred.resolve({singleWinFormMs: data})\r\n\t    }\r\n\r\n\t    function searchFormMError(xhr) {\r\n\t      xhrErrorDisplay(xhr)\r\n\t      deferred.reject(xhr)\r\n\t    }\r\n\r\n\t    return deferred.promise\r\n\t  }\r\n\r\n\t  function SearchService() {\r\n\t    var service = this\r\n\r\n\t    service.searchWithModal = searchWithModal\r\n\t    function searchWithModal() {\r\n\t      var deferred = $q.defer()\r\n\r\n\t      ModalService.showModal({\r\n\t        templateUrl: __webpack_require__(5).buildUrl(\r\n\t          'form-m/search-detailed-or-uploaded-form-m/search-detailed-or-uploaded-form-m-modal.html'),\r\n\r\n\t        controller: 'SearchDetailedOrUploadedFormMServiceModalCtrl as searchUploadedFormMModal'\r\n\t      }).then(function (modal) {\r\n\t        modal.element.dialog({\r\n\t          dialogClass: 'no-close',\r\n\t          modal: true,\r\n\t          minWidth: 500,\r\n\t          title: 'Search Form M',\r\n\r\n\t          close: function () {\r\n\t            modal.controller.close()\r\n\t          }\r\n\t        })\r\n\r\n\t        modal.close.then(function (submittedSearchParams) {\r\n\t          if (submittedSearchParams && angular.isObject(submittedSearchParams) && !underscore.isEmpty(submittedSearchParams)) {\r\n\t            deferred.resolve(searchFormM(submittedSearchParams))\r\n\t          }\r\n\t        })\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\t  }\r\n\r\n\t  return new SearchService()\r\n\t}\r\n\r\n\tapp.controller('SearchDetailedOrUploadedFormMServiceModalCtrl', SearchDetailedOrUploadedFormMServiceModalCtrl)\r\n\tSearchDetailedOrUploadedFormMServiceModalCtrl.$inject = [\r\n\t  'close',\r\n\t  'resetForm',\r\n\t  '$element'\r\n\t]\r\n\tfunction SearchDetailedOrUploadedFormMServiceModalCtrl(close, resetForm, element) {\r\n\t  var vm = this\r\n\r\n\t  initForm()\r\n\t  function initForm() {\r\n\t    vm.searchParams = {}\r\n\t  }\r\n\r\n\t  vm.close = close\r\n\r\n\t  vm.reset = reset\r\n\t  function reset(form) {\r\n\t    resetForm(form, element, '.form-control', initForm)\r\n\t    form.$invalid = false\r\n\t    form.$error = {}\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('search-form-m', [\r\n\t  'customer',\r\n\t  'form-m-service',\r\n\t  'rootApp',\r\n\t  'complex-object-validator'\r\n\t])\r\n\r\n\tapp.directive('searchMf', searchMfDirective)\r\n\r\n\tsearchMfDirective.$inject = []\r\n\r\n\t  function searchMfDirective() {\r\n\t  return {\r\n\t    restrict: 'AE',\r\n\t    template: __webpack_require__(20),\r\n\t    scope: true,\r\n\t    bindToController: {\r\n\t      onMfSearch: '&'\r\n\t    },\r\n\t    controller: 'searchFormMController as searchMf'\r\n\t  }\r\n\t}\r\n\r\n\tapp.controller('searchFormMController', searchFormMController)\r\n\tsearchFormMController.$inject = [\r\n\t  'FormM',\r\n\t  'underscore',\r\n\t  'getTypeAheadCustomer',\r\n\t  'getTypeAheadCurrency',\r\n\t  'resetForm2',\r\n\t  'toISODate'\r\n\t]\r\n\tfunction searchFormMController(FormM, underscore, getTypeAheadCustomer, getTypeAheadCurrency, resetForm2,\r\n\t  toISODate) {\r\n\t  var vm = this //jshint -W040\r\n\t  vm.showForm = true\r\n\r\n\t  init()\r\n\t  function init() {\r\n\t    vm.searchParams = {\r\n\t      cancelled: false\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.toggleShow = function toggleShow(form) {\r\n\t    vm.showForm = !vm.showForm\r\n\r\n\t    if (!vm.showForm) vm.clearForm(form)\r\n\t  }\r\n\r\n\t  vm.getCurrency = getTypeAheadCurrency\r\n\t  vm.getApplicant = getTypeAheadCustomer\r\n\t  vm.datePickerIsOpen = false\r\n\t  vm.openDatePicker = function openDatePicker() {\r\n\t    vm.datePickerIsOpen = true\r\n\t  }\r\n\r\n\t  vm.clearForm = function clearForm(form) {\r\n\t    resetForm2(form)\r\n\t    init()\r\n\t  }\r\n\r\n\t  vm.searchMf = function searchMf(searchParams) {\r\n\t    var params = angular.copy(searchParams)\r\n\t    params.applicant_id = params.applicantObj ? /\\d+$/.exec(params.applicantObj.url)[0] : null\r\n\t    params.currency = params.currency ? params.currency.code : null\r\n\t    params.created_at = params.created_at ? toISODate(params.created_at) : null\r\n\r\n\t    if (!params.cancelled) delete params.cancelled\r\n\r\n\t    FormM.getPaginated(params).$promise.then(function (data) {\r\n\t      vm.onMfSearch({searchResult: data})\r\n\t    })\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"search-mf-directive\\\"><div class=\\\"search-mf-toggle-show\\\"><div ng-click=\\\"searchMf.toggleShow(searchMfForm)\\\" class=\\\"form-m-add-on-toggle clearfix\\\"><span class=\\\"form-m-add-on-show-helper\\\" ng-if=\\\"searchMf.showForm\\\"></span><div class=\\\"form-m-add-on-show-icon\\\"><span ng-class=\\\"['glyphicon', {'glyphicon-chevron-down': !searchMf.showForm, 'glyphicon-chevron-up': searchMf.showForm}]\\\"></span> Search Form M</div></div></div><form class=\\\"form-horizontal\\\" name=\\\"searchMfForm\\\" role=\\\"form\\\" autocomplete=\\\"off\\\" ng-show=\\\"searchMf.showForm\\\" ng-submit=\\\"searchMf.searchMf(searchMf.searchParams)\\\"><div class=\\\"form-group form-m-number-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"form-m-number\\\" class=\\\"control-label col-sm-3\\\">Form M Number</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"formMNumber\\\" ng-model=\\\"searchMf.searchParams.number\\\" id=\\\"form-m-number\\\" to-upper=\\\"\\\" ng-pattern=\\\"/(?:mf)?\\\\d{3,}/i\\\" maxlength=\\\"13\\\"></div></div><div class=\\\"form-group applicant-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"applicant\\\" class=\\\"control-label col-sm-3\\\">Applicant</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"applicant\\\" ng-model=\\\"searchMf.searchParams.applicantObj\\\" id=\\\"applicant\\\" ng-minlength=\\\"3\\\" autocomplete=\\\"off\\\" typeahead-min-length=\\\"3\\\" uib-typeahead=\\\"applicant as applicant.name for applicant in searchMf.getApplicant($viewValue)\\\" typeahead-select-on-blur=\\\"true\\\" typeahead-select-on-exact=\\\"true\\\"></div></div><div class=\\\"form-group currency-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"currency\\\" class=\\\"control-label col-sm-3\\\">Currency</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"currency\\\" ng-model=\\\"searchMf.searchParams.currency\\\" id=\\\"currency\\\" maxlength=\\\"3\\\" autocomplete=\\\"off\\\" uib-typeahead=\\\"currency as currency.code for currency in searchMf.getCurrency($viewValue)\\\" typeahead-select-on-blur=\\\"true\\\" typeahead-select-on-exact=\\\"true\\\"></div></div><div class=\\\"form-group amount-group\\\" control-has-feedback=\\\"\\\"><label for=\\\"amount\\\" class=\\\"control-label col-sm-3\\\">Amount</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"amount\\\" ng-model=\\\"searchMf.searchParams.amount\\\" id=\\\"amount\\\" number-format=\\\"\\\"></div></div><div class=\\\"form-group created-date-group\\\" control-has-feedback=\\\"\\\" feedback-after=\\\".input-group-addon\\\"><label for=\\\"created-at\\\" class=\\\"control-label col-sm-3\\\">Created At</label><div class=\\\"col-sm-9\\\"><div class=\\\"input-group\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"createdAt\\\" ng-model=\\\"searchMf.searchParams.created_at\\\" id=\\\"created-at\\\" uib-datepicker-popup=\\\"dd-MMM-yyyy\\\" is-open=\\\"searchMf.datePickerIsOpen\\\"> <span class=\\\"input-group-addon\\\" ng-click=\\\"searchMf.openDatePicker($event)\\\"><i class=\\\"glyphicon glyphicon-calendar\\\"></i></span></div></div></div><div class=\\\"form-group lc-number-group\\\"><label for=\\\"lc-number\\\" class=\\\"control-label col-sm-3\\\">LC Number</label><div class=\\\"col-sm-9\\\"><input type=\\\"text\\\" class=\\\"form-control\\\" name=\\\"lcNumber\\\" ng-model=\\\"searchMf.searchParams.lc_number\\\" id=\\\"lc-number\\\" to-upper=\\\"\\\" maxlength=\\\"16\\\"></div></div><div class=\\\"form-group cancelled-group\\\"><label for=\\\"cancelled\\\" class=\\\"control-label col-sm-3\\\">Include cancelled</label><div class=\\\"col-sm-9\\\"><input type=\\\"checkbox\\\" name=\\\"cancelled\\\" ng-model=\\\"searchMf.searchParams.cancelled\\\" id=\\\"cancelled\\\"></div></div><div class=\\\"form-group submit-group\\\"><div class=\\\"col-sm-9 col-sm-offset-3\\\"><div class=\\\"clearfix\\\"><div class=\\\"pull-left\\\"><input type=\\\"submit\\\" class=\\\"btn btn-info\\\" value=\\\"Search Form M\\\" ng-disabled=\\\"searchMfForm.$invalid\\\"></div><div class=\\\"pull-right\\\" style=\\\"text-align: right\\\"><input type=\\\"button\\\" class=\\\"btn btn-warning\\\" value=\\\"Clear All\\\" ng-click=\\\"searchMf.clearForm(searchMfForm)\\\"></div></div></div></div></form></div>\";\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\"\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\t__webpack_require__(22)\r\n\r\n\tvar rootCommons = __webpack_require__(7)\r\n\r\n\tvar app = angular.module('upload-form-m',\r\n\t  ['rootApp',\r\n\t    'ui.router',\r\n\t    'upload-form-m-service',\r\n\t    'kanmii-underscore'\r\n\t  ])\r\n\r\n\tapp.config(rootCommons.interpolateProviderConfig)\r\n\r\n\tapp.config(uploadFormMURLConfig)\r\n\tuploadFormMURLConfig.$inject = ['$stateProvider']\r\n\tfunction uploadFormMURLConfig($stateProvider) {\r\n\r\n\t  $stateProvider\r\n\t    .state('form_m.upload', {\r\n\t      kanmiiTitle: 'Form M Upload',\r\n\r\n\t      views: {\r\n\t        'uploadFormM': {\r\n\t          template: __webpack_require__(23),\r\n\r\n\t          controller: 'UploadFormMController as uploadFormM'\r\n\t        }\r\n\t      }\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('UploadFormMController', UploadFormMController)\r\n\tUploadFormMController.$inject = ['UploadFormM', 'xhrErrorDisplay', 'kanmiiUnderscore', '$scope']\r\n\r\n\tfunction UploadFormMController(UploadFormM, xhrErrorDisplay, kanmiiUnderscore, $scope) {\r\n\t  var vm = this\r\n\t  vm.datePrompt = 'Date must be in format dd-mm-yyyy e.g 31-01-2015'\r\n\r\n\t  initial()\r\n\t  function initial(form) {\r\n\t    vm.formMShowIndicator = false\r\n\t    vm.indicateError = false\r\n\t    vm.formMIsUploading = false\r\n\t    vm.uploadIndicationText = 'Uploading Form Ms.........please wait'\r\n\t    vm.uploadFormMText = ''\r\n\r\n\t    if (form) {\r\n\t      form.$setPristine()\r\n\t      form.$setUntouched()\r\n\t    }\r\n\t  }\r\n\r\n\t  function doDismiss() {\r\n\t    vm.formMShowIndicator = false\r\n\t    if (vm.formMIsUploading) initial($scope.uploadFormMForm)\r\n\t  }\r\n\r\n\t  vm.dismissIndicator = function dismissIndicator() {\r\n\t    doDismiss()\r\n\t  }\r\n\r\n\t  vm.uploadFormM = function uploadFormM(text) {\r\n\t    vm.formMIsUploading = true\r\n\t    vm.formMShowIndicator = true\r\n\t    var uploaded = {}\r\n\t    var row\r\n\t    var mf\r\n\t    var formM\r\n\t    var ba\r\n\t    var dt\r\n\r\n\t    function parseDate(dt) {\r\n\t      var regExp = /(\\d{2})\\D(\\d{1,2})\\D(\\d{4})/\r\n\t      var exec = regExp.exec(dt)\r\n\r\n\t      if (!exec) return null\r\n\r\n\t      var month = +exec[2].trim()\r\n\r\n\t      if (month > 12) return null\r\n\r\n\t      return exec[3] + '-' + month + '-' + exec[1]\r\n\t    }\r\n\r\n\t    try {\r\n\t      Papa.parse(text, {\r\n\t        delimiter: '\\t',\r\n\t        header: true,\r\n\t        step: function (data) {\r\n\t          row = data.data[0]\r\n\t          mf = row['MF NUM'].trim()\r\n\t          ba = row['BA NUM'].trim()\r\n\t          dt = parseDate(row['DATE SUBMITTED'])\r\n\r\n\t          if (!dt) throw new Error('Error in form M date: \"' + mf + '\"\\n' + vm.datePrompt)\r\n\r\n\t          formM = {\r\n\t            ba: ba,\r\n\t            mf: mf,\r\n\t            ccy: row.CURRENCY.trim(),\r\n\t            applicant: row['APPLICANT NAME'].trim(),\r\n\t            fob: row.FOB.replace(/[,\\s]/g, ''),\r\n\t            cost_freight: row['COST AND FREIGHT'].replace(/[,\\s]/g, ''),\r\n\t            submitted_at: dt,\r\n\t            validated_at: dt,\r\n\t            goods_description: row.DESCS.trim()\r\n\t          }\r\n\r\n\t          if (kanmiiUnderscore.has(uploaded, mf)) {\r\n\t            if (row.STAX.trim() === 'Validated') {\r\n\t              formM.submitted_at = uploaded[mf].submitted_at\r\n\t              uploaded[mf] = formM\r\n\r\n\t            } else if (row.STAX.trim() === 'Submitted') uploaded[mf].submitted_at = formM.submitted_at\r\n\r\n\t          } else {\r\n\t            if (ba.length === 16) uploaded[mf] = formM\r\n\t          }\r\n\t        }\r\n\t      })\r\n\t    } catch (e) {\r\n\t      vm.formMIsUploading = false\r\n\t      vm.indicateError = true\r\n\t      vm.uploadIndicationText = e.message\r\n\t      return\r\n\t    }\r\n\r\n\t    var uploaded1 = kanmiiUnderscore.values(uploaded)\r\n\t    UploadFormM.save({uploaded: uploaded1, likely_duplicates: true})\r\n\t      .$promise.then(formMCreatedSuccess, formMCreatedError)\r\n\r\n\t    function formMCreatedSuccess(data) {\r\n\t      var creationResult = data.created_data,\r\n\t        numCreatedNow = creationResult.length,\r\n\t        numCreatedPreviously = uploaded1.length - numCreatedNow\r\n\r\n\t      vm.uploadIndicationText = 'Done Uploading form Ms\\n======================\\n' +\r\n\t        'Total new form Ms created: ' + numCreatedNow + '\\n'\r\n\t      if (numCreatedPreviously) {\r\n\t        vm.uploadIndicationText += ('Total not created (uploaded previously): ' + numCreatedPreviously)\r\n\t      }\r\n\t    }\r\n\r\n\t    function formMCreatedError(xhr) {\r\n\t      vm.formMIsUploading = false\r\n\t      vm.indicateError = true\r\n\t      vm.uploadIndicationText = 'Error uploading form!'\r\n\t      xhrErrorDisplay(xhr)\r\n\t    }\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('search-uploaded-form-m', [\r\n\t  'kanmii-underscore',\r\n\t  'upload-form-m-service',\r\n\t  'toggle-dim-element'\r\n\t])\r\n\r\n\tapp.factory('SearchUploadedFormMService', SearchUploadedFormMService)\r\n\tSearchUploadedFormMService.$inject = [\r\n\t  'UploadFormM',\r\n\t  'xhrErrorDisplay',\r\n\t  'ModalService',\r\n\t  'kanmiiUnderscore',\r\n\t  '$q'\r\n\t]\r\n\tfunction SearchUploadedFormMService(UploadFormM, xhrErrorDisplay, ModalService, kanmiiUnderscore, $q) {\r\n\r\n\t  function searchFormM(submittedSearchParams) {\r\n\t    var deferred = $q.defer()\r\n\t    var searchParams = angular.copy(submittedSearchParams)\r\n\r\n\t    if (searchParams.applicant) searchParams.applicant = searchParams.applicant.name\r\n\t    if (searchParams.currency) searchParams.currency = searchParams.currency.code\r\n\r\n\t    UploadFormM.query(searchParams).$promise.then(searchFormMSuccess, searchFormMError)\r\n\r\n\t    function searchFormMSuccess(data) {\r\n\t      deferred.resolve(data)\r\n\t    }\r\n\r\n\t    function searchFormMError(xhr) {\r\n\t      xhrErrorDisplay(xhr)\r\n\t      deferred.reject(xhr)\r\n\t    }\r\n\r\n\t    return deferred.promise\r\n\t  }\r\n\r\n\t  function SearchService() {\r\n\t    var service = this\r\n\r\n\t    service.searchWithModal = searchWithModal\r\n\t    function searchWithModal() {\r\n\t      var deferred = $q.defer()\r\n\r\n\t      ModalService.showModal({\r\n\t        templateUrl: __webpack_require__(5).buildUrl(\r\n\t          'form-m/upload-form-m/search-uploaded-form-m/search-uploaded-form-m-modal.html'),\r\n\r\n\t        controller: 'SearchUploadedFormMServiceModalCtrl as searchUploadedFormMModal'\r\n\t      }).then(function(modal) {\r\n\t        modal.element.dialog({\r\n\t          dialogClass: 'no-close',\r\n\t          modal: true,\r\n\t          minWidth: 600,\r\n\t          minHeight: 250,\r\n\t          title: 'Search Uploaded Form M',\r\n\r\n\t          close: function() {\r\n\t            modal.close.then()\r\n\t          }\r\n\t        })\r\n\r\n\t        modal.close.then(function(submittedSearchParams) {\r\n\t          if (submittedSearchParams && angular.isObject(submittedSearchParams) && !kanmiiUnderscore.isEmpty(submittedSearchParams)) {\r\n\t            deferred.resolve(searchFormM(submittedSearchParams))\r\n\t          }\r\n\t        })\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\t  }\r\n\r\n\t  return new SearchService()\r\n\t}\r\n\r\n\tapp.controller('SearchUploadedFormMServiceModalCtrl', SearchUploadedFormMServiceModalCtrl)\r\n\tSearchUploadedFormMServiceModalCtrl.$inject = [\r\n\t  'close',\r\n\t  'resetForm',\r\n\t  '$element'\r\n\t]\r\n\tfunction SearchUploadedFormMServiceModalCtrl(close, resetForm, element) {\r\n\t  var vm = this\r\n\r\n\t  initForm()\r\n\t  function initForm() {\r\n\t    vm.searchParams = {}\r\n\t  }\r\n\r\n\t  vm.close = close\r\n\r\n\t  vm.reset = reset\r\n\t  function reset(form) {\r\n\t    resetForm(form, element, '.form-control', initForm)\r\n\t    form.$invalid = false\r\n\t    form.$error = {}\r\n\t  }\r\n\r\n\t  vm.submitSearchParams = submitSearchParams\r\n\t  function submitSearchParams(searchParams) {\r\n\t    close(searchParams)\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"upload-form-m-tab-content\\\" ng-keypress=\\\"uploadFormM.dismissIndicatorEvent($event)\\\"><form class=\\\"upload-form-m-form\\\" role=\\\"form\\\" name=\\\"uploadFormMForm\\\" ng-submit=\\\"uploadFormM.uploadFormM(uploadFormM.uploadFormMText, uploadFormMForm)\\\"><div class=\\\"form-group upload-form-m-text-group\\\"><pre ng-class=\\\"['upload-form-m-indicator', {'error-indicator': uploadFormM.indicateError}]\\\" ng-show=\\\"uploadFormM.formMShowIndicator\\\">{$uploadFormM.uploadIndicationText$}\\r\\n        <span class=\\\"dismiss\\\" data-toggle=\\\"tooltip\\\" title=\\\"Dismiss\\\" ng-click=\\\"uploadFormM.dismissIndicator()\\\">x</span>\\r\\n      </pre><label for=\\\"upload-form-m\\\" class=\\\"control-label\\\">{$uploadFormM.datePrompt$}</label> <textarea name=\\\"upload-form-m\\\" id=\\\"upload-form-m\\\" required=\\\"\\\" ng-model=\\\"uploadFormM.uploadFormMText\\\" ng-class=\\\"['form-control', 'upload-form-m', {'form-m-is-uploading':uploadFormM.formMIsUploading}]\\\" ng-readonly=\\\"uploadFormM.formMIsUploading\\\"></textarea></div><div class=\\\"upload-form-m-submit\\\" style=\\\"text-align: center\\\"><button type=\\\"submit\\\" class=\\\"btn btn-success\\\" ng-disabled=\\\"uploadFormMForm.$invalid || uploadFormM.formMIsUploading\\\">Upload</button></div></form></div>\";\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('display-uploaded-form-m', [\r\n\t  'rootApp',\r\n\t  'model-table',\r\n\t  'upload-form-m-service'\r\n\t])\r\n\r\n\tapp.factory('DisplayUploadedFormMModal', DisplayUploadedFormMModal)\r\n\tDisplayUploadedFormMModal.$inject = ['$q', 'ModalService']\r\n\tfunction DisplayUploadedFormMModal($q, ModalService) {\r\n\t  function DisplayService() {\r\n\t    this.display = display\r\n\r\n\t    function display(forMData) {\r\n\t      var deferred = $q.defer()\r\n\r\n\t      ModalService.showModal({\r\n\t        template: __webpack_require__(25),\r\n\t        controller: 'DisplayUploadedFormMModalCtrl as displayUploadedFormMModal',\r\n\t        inputs: {forMData: forMData}\r\n\t      }).then(function (modal) {\r\n\t        var ctrl = modal.controller\r\n\r\n\t        modal.element.dialog({\r\n\t          dialogClass: 'no-close',\r\n\t          modal: true,\r\n\t          minWidth: 750,\r\n\t          title: ctrl.tableCaption,\r\n\r\n\t          close: function () {\r\n\t            ctrl.close()\r\n\t          }\r\n\t        })\r\n\r\n\t        modal.close.then(function (formM) {\r\n\t          deferred.resolve(formM)\r\n\t        })\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\t  }\r\n\r\n\t  return new DisplayService()\r\n\t}\r\n\r\n\tapp.controller('DisplayUploadedFormMModalCtrl', DisplayUploadedFormMModalCtrl)\r\n\tDisplayUploadedFormMModalCtrl.$inject = [\r\n\t  'close',\r\n\t  'forMData',\r\n\t  'uploadedFormMModelManager'\r\n\t]\r\n\tfunction DisplayUploadedFormMModalCtrl(close, forMData, uploadedFormMModelManager) {\r\n\t  var vm = this\r\n\r\n\t  vm.forMData = forMData\r\n\t  vm.tableCaption = 'Single Window Forms M'\r\n\t  vm.modelManager = uploadedFormMModelManager\r\n\t  vm.close = close\r\n\t}\r\n\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"display-uploaded-form-m-modal-root\\\"><div model-table=\\\"\\\" model-collection=\\\"displayUploadedFormMModal.forMData\\\" table-model-manager=\\\"::displayUploadedFormMModal.modelManager\\\" table-caption=\\\"::displayUploadedFormMModal.tableCaption\\\" on-row-dbl-click-callback=\\\"displayUploadedFormMModal.close(rowModel)\\\" show-pagination=\\\"false\\\"></div></div>\";\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"form-m-home-view\\\"><div uib-tabset=\\\"\\\"><div uib-tab=\\\"\\\" ng-repeat=\\\"(key, tab) in tabs\\\" heading=\\\"{$tab.title$}\\\" active=\\\"tab.active\\\" select=\\\"tab.select()\\\" ng-attr-class=\\\"{$tab.className$}\\\"><div class=\\\"\\\" ui-view=\\\"{$tab.viewName$}\\\"></div></div></div></div>\";\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar rootCommons = __webpack_require__(7)\r\n\r\n\tvar app = angular.module('lc', [\r\n\t  'ui.router',\r\n\t  'model-table',\r\n\t  'rootApp',\r\n\t  'search-lc',\r\n\t  'lc-detail'\r\n\t])\r\n\r\n\tapp.config(rootCommons.interpolateProviderConfig)\r\n\r\n\tapp.config(bidURLConfig)\r\n\tbidURLConfig.$inject = ['$stateProvider']\r\n\tfunction bidURLConfig($stateProvider) {\r\n\t  $stateProvider\r\n\t    .state('lc', {\r\n\t      url: '/lc',\r\n\r\n\t      kanmiiTitle: 'Letter of credit',\r\n\r\n\t      templateUrl: __webpack_require__(5).buildUrl('lc/lc.html'),\r\n\r\n\t      controller: 'LetterOfCreditController as lcHome'\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('LetterOfCreditController', LetterOfCreditController)\r\n\tLetterOfCreditController.$inject = ['SearchLc', '$state']\r\n\tfunction LetterOfCreditController(SearchLc, $state) {\r\n\t  var vm = this\r\n\r\n\t  vm.searchLc = function searchLc() {\r\n\t    SearchLc.searchWithModal().then(function(data) {\r\n\t      var results = data.results\r\n\r\n\t      if (results.length) {\r\n\t        if (results.length === 1) {\r\n\t          var lc = results[0]\r\n\t          $state.go('lc_detail', {lc_number: lc.lc_number, lc: lc})\r\n\t        }\r\n\t      }\r\n\t    })\r\n\t  }\r\n\t}\r\n\r\n\r\n\t__webpack_require__(28)\r\n\t__webpack_require__(29)\r\n\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar rootCommons = __webpack_require__(7)\r\n\r\n\tvar app = angular.module('lc-detail', [\r\n\t  'ui.router',\r\n\t  'rootApp',\r\n\t  'lc-service',\r\n\t  'lc-issue-service',\r\n\t  'kanmii-underscore',\r\n\t  'customer'\r\n\t])\r\n\r\n\tapp.config(rootCommons.interpolateProviderConfig)\r\n\r\n\tapp.config(bidURLConfig)\r\n\r\n\tbidURLConfig.$inject = ['$stateProvider']\r\n\r\n\tfunction bidURLConfig($stateProvider) {\r\n\t  $stateProvider\r\n\t    .state('lc_detail', {\r\n\t      url: '/lc/:lc_number',\r\n\r\n\t      params: {lc: null},\r\n\r\n\t      kanmiiTitle: 'Letter of credit',\r\n\r\n\t      templateUrl: __webpack_require__(5).buildUrl('lc/lc-detail/lc-detail.html'),\r\n\r\n\t      controller: 'LetterOfCreditDetailController as lcDetail'\r\n\t    })\r\n\t}\r\n\r\n\tapp.controller('LetterOfCreditDetailController', LetterOfCreditDetailController)\r\n\r\n\tLetterOfCreditDetailController.$inject = [\r\n\t  '$stateParams',\r\n\t  'LetterOfCredit',\r\n\t  '$state',\r\n\t  'getTypeAheadCustomer',\r\n\t  '$filter',\r\n\t  'getTypeAheadLCIssue',\r\n\t  'LCIssueConcrete',\r\n\t  'kanmiiUnderscore',\r\n\t  'xhrErrorDisplay',\r\n\t  'formatDate',\r\n\t  'Customer',\r\n\t  'formMAttributesVerboseNames'\r\n\t]\r\n\r\n\tfunction LetterOfCreditDetailController($stateParams, LetterOfCredit, $state, getTypeAheadCustomer, $filter,\r\n\t  getTypeAheadLCIssue, LCIssueConcrete, kanmiiUnderscore, xhrErrorDisplay, formatDate, Customer,\r\n\t  formMAttributesVerboseNames) {\r\n\t  var vm = this\r\n\r\n\t  initialize()\r\n\r\n\t  function initialize() {\r\n\t    if ($stateParams.lc) {\r\n\t      vm.lc = $stateParams.lc\r\n\t      vm.lcIssues = getIssuesNotClosed(vm.lc.issues)\r\n\t    }\r\n\r\n\t    else {\r\n\t      LetterOfCredit.getPaginated({lc_number: $stateParams.lc_number}).$promise.then(function(data) {\r\n\t        if (data.count) {\r\n\t          vm.lc = data.results[0]\r\n\t          vm.lcIssues = getIssuesNotClosed(vm.lc.issues)\r\n\t        }\r\n\r\n\t        else $state.go('lc')\r\n\t      })\r\n\t    }\r\n\r\n\t    vm.lcForm = {}\r\n\t    vm.alertIsShown = false\r\n\t    vm.issue = {}\r\n\r\n\t    function getIssuesNotClosed(issues) {\r\n\t      if (!issues) return []\r\n\r\n\t      return issues.filter(function(issue) {\r\n\t        return !issue.closed_at\r\n\t      })\r\n\t    }\r\n\t  }\r\n\r\n\t  vm.issueDateGetterSetter = function issueDateGetterSetter() {\r\n\t    if (vm.lc && vm.lc.estb_date) return $filter('date')(vm.lc.estb_date, 'dd-MMM-yyyy')\r\n\t  }\r\n\r\n\t  vm.expiryDateGetterSetter = function expiryDateGetterSetter() {\r\n\t    if (vm.lc && vm.lc.expiry_date) return $filter('date')(vm.lc.expiry_date, 'dd-MMM-yyyy')\r\n\t  }\r\n\r\n\t  vm.saveIssue = function saveIssue(issue, form) {\r\n\t    if (issue && !kanmiiUnderscore.isEmpty(issue)) {\r\n\t      var postData = {\r\n\t        issue: issue.issue.url,\r\n\t        mf: vm.lc.mf,\r\n\t        lc_number: vm.lc.lc_number,\r\n\t        get_or_create_form_m: true\r\n\t      }\r\n\r\n\t      var applicant = issue.applicant\r\n\r\n\t      if (applicant && !kanmiiUnderscore.isEmpty(applicant)) {\r\n\t        postData.form_m_data = {\r\n\t          applicant: applicant.url,\r\n\t          currency: vm.lc.ccy_data.url,\r\n\t          amount: vm.lc.lc_amt_org_ccy,\r\n\t          lc: vm.lc.url,\r\n\t          number: vm.lc.mf\r\n\t        }\r\n\r\n\t      }\r\n\r\n\t      LCIssueConcrete.save(postData).$promise.then(saveSuccess, saveError)\r\n\t    }\r\n\r\n\t    function saveSuccess(data) {\r\n\t      vm.lcIssues.unshift({\r\n\t        issue_text: data.issue_text,\r\n\t        issue: data.issue,\r\n\t        id: data.id,\r\n\t        mf: data.mf\r\n\t      })\r\n\r\n\t      vm.issue = {}\r\n\r\n\t      if (!vm.lc.applicant_data) { vm.lc.applicant_data = applicant}\r\n\t      form.$setPristine()\r\n\t      form.$setUntouched()\r\n\t    }\r\n\r\n\t    function saveError(xhr) {\r\n\t      var transform = null\r\n\t      if (xhr.data.form_m_creation_errors) {\r\n\t        transform = formMAttributesVerboseNames\r\n\t        delete xhr.data.form_m_creation_errors\r\n\t      }\r\n\t      xhrErrorDisplay(xhr, transform)\r\n\t    }\r\n\r\n\t  }\r\n\r\n\t  vm.closeIssue = function closeIssue(issue) {\r\n\t    issue.closed_at = formatDate(new Date())\r\n\t    LCIssueConcrete.put(issue).$promise.then(function() {\r\n\r\n\t      vm.lcIssues = vm.lcIssues.filter(function(anIssue) {\r\n\t        return anIssue.id !== issue.id\r\n\t      })\r\n\r\n\t    }, function(xhr) {\r\n\t      xhrErrorDisplay(xhr)\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.replaceLc = function replaceLc(newLcNumber) {\r\n\t    LetterOfCredit.getPaginated({lc_number: newLcNumber}).$promise.then(function(data) {\r\n\t      if (data.count) {\r\n\t        var lc = data.results[0]\r\n\r\n\t        $state.go('.', {lc_number: lc.lc_number, lc: lc})\r\n\r\n\t      } else vm.alertIsShown = true\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.replaceLcFormInvalid = function replaceLcFormInvalid(formInvalid, newLcNumber) {\r\n\t    return formInvalid || vm.lc.lc_number.toLowerCase().indexOf(newLcNumber.toLowerCase()) !== -1\r\n\t  }\r\n\r\n\t  vm.customerAdded = function customerAdded(customer) {\r\n\t    vm.issue.applicant = customer\r\n\t  }\r\n\r\n\t  vm.getApplicant = getTypeAheadCustomer\r\n\r\n\t  vm.getIssue = function getIssue(text) {\r\n\t    return getTypeAheadLCIssue({text: text, exclude_form_m_issues: vm.lc.mf})\r\n\t  }\r\n\r\n\t  vm.addCustomer = function addCustomer() {\r\n\t    Customer.save({name: vm.lc.applicant}).$promise.then(function(data) {\r\n\t      vm.issue.applicant = data\r\n\t      vm.lc.applicant_data = data\r\n\t    })\r\n\t  }\r\n\r\n\t  vm.closeAlert = function closeAlert() {\r\n\t    vm.alertIsShown = false\r\n\t  }\r\n\t}\r\n\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\t/*jshint camelcase:false*/\r\n\r\n\tvar app = angular.module('search-lc', [\r\n\t  'kanmii-underscore',\r\n\t  'toggle-dim-element',\r\n\t  'form-m-service',\r\n\t  'lc-service'\r\n\t])\r\n\r\n\tapp.factory('SearchLc', SearchLc)\r\n\tSearchLc.$inject = [\r\n\t  'xhrErrorDisplay',\r\n\t  'ModalService',\r\n\t  'kanmiiUnderscore',\r\n\t  '$q',\r\n\t  'ToggleDimElement',\r\n\t  'LetterOfCredit'\r\n\t]\r\n\tfunction SearchLc(xhrErrorDisplay, ModalService, kanmiiUnderscore, $q, ToggleDimElement, LetterOfCredit) {\r\n\r\n\t  function searchLc(submittedSearchParams) {\r\n\t    var deferred = $q.defer()\r\n\t    var searchParams = angular.copy(submittedSearchParams)\r\n\r\n\t    if (searchParams.applicant) searchParams.applicant = searchParams.applicant.name\r\n\t    if (searchParams.currency) searchParams.currency = searchParams.currency.code\r\n\r\n\t    LetterOfCredit.getPaginated(searchParams).$promise.then(searchLcSuccess, searchLcError)\r\n\r\n\t    function searchLcSuccess(data) {\r\n\t      deferred.resolve(data)\r\n\t    }\r\n\r\n\t    function searchLcError(xhr) {\r\n\t      xhrErrorDisplay(xhr)\r\n\t      deferred.reject(xhr)\r\n\t    }\r\n\r\n\t    return deferred.promise\r\n\t  }\r\n\r\n\t  function SearchService() {\r\n\t    var service = this\r\n\r\n\t    service.searchWithModal = searchWithModal\r\n\t    function searchWithModal(config) {\r\n\t      var deferred = $q.defer()\r\n\t      config = config || {}\r\n\r\n\t      ModalService.showModal({\r\n\t        templateUrl: __webpack_require__(5).buildUrl('lc/search-lc/search-lc.html'),\r\n\t        controller: 'SearchLcModalCtrl as searchLcModal',\r\n\t        inputs: {\r\n\t          uiOptions: config.uiOptions\r\n\t        }\r\n\r\n\t      }).then(function(modal) {\r\n\t        modal.element.dialog({\r\n\t          dialogClass: 'no-close',\r\n\t          modal: true,\r\n\t          minWidth: 600,\r\n\t          minHeight: 450,\r\n\t          title: 'Search Letter of credit',\r\n\r\n\t          open: function() {\r\n\t            config.dim && ToggleDimElement.dim(config.parent, config.dimCb)\r\n\t          },\r\n\r\n\t          close: function() {\r\n\t            config.dim && ToggleDimElement.unDim(config.parent, config.unDimCb)\r\n\t          }\r\n\t        })\r\n\r\n\t        modal.close.then(function(submittedSearchParams) {\r\n\t          if (submittedSearchParams && angular.isObject(submittedSearchParams) && !kanmiiUnderscore.isEmpty(submittedSearchParams)) {\r\n\t            deferred.resolve(searchLc(submittedSearchParams))\r\n\t          }\r\n\r\n\t          config.dim && ToggleDimElement.unDim(config.parent, config.unDimCb)\r\n\t        })\r\n\t      })\r\n\r\n\t      return deferred.promise\r\n\t    }\r\n\t  }\r\n\r\n\t  return new SearchService()\r\n\t}\r\n\r\n\tapp.controller('SearchLcModalCtrl', SearchLcModalCtrl)\r\n\tSearchLcModalCtrl.$inject = [\r\n\t  'close',\r\n\t  'resetForm',\r\n\t  '$element',\r\n\t  'getTypeAheadCustomer',\r\n\t  'getTypeAheadCurrency'\r\n\t]\r\n\tfunction SearchLcModalCtrl(close, resetForm, element, getTypeAheadCustomer, getTypeAheadCurrency) {\r\n\t  var vm = this\r\n\r\n\t  initForm()\r\n\t  function initForm() {\r\n\t    vm.searchParams = {}\r\n\t  }\r\n\r\n\t  vm.close = close\r\n\r\n\t  vm.reset = reset\r\n\t  function reset(form) {\r\n\t    resetForm(form, element, '.form-control', initForm)\r\n\t    form.$invalid = false\r\n\t    form.$error = {}\r\n\t  }\r\n\r\n\t  vm.submitSearchParams = submitSearchParams\r\n\t  function submitSearchParams(searchParams) {\r\n\t    close(searchParams)\r\n\t  }\r\n\r\n\t  vm.getApplicant = getTypeAheadCustomer\r\n\t  vm.getCurrency = getTypeAheadCurrency\r\n\t}\r\n\n\n/***/ },\n/* 30 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"form-m-home-view\\\"><div class=\\\"form-m-home-action-buttons btn-group-vertical\\\" role=\\\"group\\\"><a class=\\\"btn btn-info form-m-home-action-button\\\" ui-sref=\\\"lc\\\">Letter of credit</a> <a class=\\\"btn btn-info form-m-home-action-button\\\" ui-sref=\\\"form_m\\\">Form M</a></div></div>\";\n\n/***/ }\n/******/ ]);"],"sourceRoot":"/source/"}