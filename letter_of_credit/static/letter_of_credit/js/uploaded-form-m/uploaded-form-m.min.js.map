{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.js"],"names":["$","parseNumber","val","Number","replace","parseDate","dateRe","RegExp","exec","$idUpload","$toUpload","on","reportHeaderBeginText","toUpload","Papa","parse","trim","delimiter","header","step","row","data","ba","length","push","mf","ccy","CURRENCY","fob","FOB","applicant","submitted_at","goods_description","DESCS","cost_freight","validity_type","status","STAX","JSON","stringify","submit","evt","test","prop","each","this","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAE,WAGA,YAEA,SAASC,GAAYC,GACnB,MAAOC,QAAOD,EAAIE,QAAQ,KAAM,KAGlC,QAASC,GAAUH,GACjB,GAAII,GAAS,GAAIC,QAAO,wBACtBC,EAAOF,EAAOE,KAAKN,EAErB,OAAOM,GAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,GAG9C,GAAIC,GAAYT,EAAE,+BAChBU,EAAYV,EAAE,yBAEhBS,GAAUE,GAAG,QAAS,WACpB,GAAIC,GAAwB,iCAC1BC,IAEFC,MAAKC,MAAMN,EAAUP,MAAME,QAAQQ,EAAuB,IAAII,QAC5DC,UAAW,IACXC,QAAQ,EACRC,KAAM,SAASC,GACb,GAAIC,GAAOD,EAAIC,KAAK,GAClBC,EAAKD,EAAK,SAEM,MAAdC,EAAGC,QACLV,EAASW,MAELF,GAAIA,EACJG,GAAIJ,EAAK,UACTK,IAAKL,EAAKM,SACVC,IAAK3B,EAAYoB,EAAKQ,KACtBC,UAAWT,EAAK,kBAChBU,aAAc1B,EAAUgB,EAAK,mBAC7BW,kBAAmBX,EAAKY,MACxBC,aAAcjC,EAAYoB,EAAK,qBAC/Bc,cAAed,EAAK,iBACpBe,OAAQf,EAAKgB,UAOvB3B,EAAUR,IAAIoC,KAAKC,UAAU1B,MAG/Bb,EAAE,4BAA4BwC,OAAO,SAASC,GAExC,WAAWC,KAAKhC,EAAUR,QAC5BF,EAAE,8BAA8B2C,KAAK,YAAY,GACjD3C,EAAE,YAAY4C,KAAK,WACjB5C,EAAE6C,MAAMF,KAAK,YAAY,KAE3B3C,EAAE6C,MAAMC,SAAS,gCAGjBC,OAAOC,MAAM,6CACbP,EAAIQ","file":"letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.min.js","sourcesContent":["$(function() {\n  /*jshint camelcase:false*/\n\n  \"use strict\";\n\n  function parseNumber(val) {\n    return Number(val.replace(/,/g, ''))\n  }\n\n  function parseDate(val) {\n    var dateRe = new RegExp(\"(\\\\d+)/(\\\\d+)/(\\\\d+)\"),\n      exec = dateRe.exec(val)\n\n    return exec[3] + '-' + exec[2] + '-' + exec[1]\n  }\n\n  var $idUpload = $('#id_upload-lc-register-text'),\n    $toUpload = $('#id_upload-lc-register')\n\n  $idUpload.on('input', function() {\n    var reportHeaderBeginText = 'FORM M PROCESSED ON CBN WINDOW',\n      toUpload = []\n\n    Papa.parse($idUpload.val().replace(reportHeaderBeginText, '').trim(), {\n      delimiter: '\\t',\n      header: true,\n      step: function(row) {\n        var data = row.data[0],\n          ba = data['BA NUM']\n\n        if (ba.length === 16) {\n          toUpload.push(\n            {\n              ba: ba,\n              mf: data['MF NUM'],\n              ccy: data.CURRENCY,\n              fob: parseNumber(data.FOB),\n              applicant: data['APPLICANT NAME'],\n              submitted_at: parseDate(data['DATE SUBMITTED']),\n              goods_description: data.DESCS,\n              cost_freight: parseNumber(data['COST AND FREIGHT']),\n              validity_type: data['VALIDITY TYPE'],\n              status: data.STAX\n            }\n          )\n        }\n      }\n    })\n\n    $toUpload.val(JSON.stringify(toUpload))\n  })\n\n  $('.upload-lc-register-form').submit(function(evt) {\n\n    if (/^\\[\\{\".+/.test($toUpload.val())) {\n      $('#upload-lc-register-submit').prop('disabled', true)\n      $('textarea').each(function() {\n        $(this).prop('readonly', true)\n      })\n      $(this).addClass('ui-widget-overlay ui-front')\n\n    } else {\n      window.alert('Nothing to upload or invalid upload data!')\n      evt.preventDefault()\n    }\n  })\n});\n"],"sourceRoot":"/source/"}