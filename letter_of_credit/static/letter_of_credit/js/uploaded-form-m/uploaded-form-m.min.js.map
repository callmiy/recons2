{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.js"],"names":["$","parseNumber","val","Number","replace","parseDate","dateRe","RegExp","exec","$idUpload","$toUpload","on","reportHeaderBeginText","toUpload","Papa","parse","trim","delimiter","header","step","row","data","ba","length","push","mf","ccy","CURRENCY","fob","FOB","applicant","submitted_at","goods_description","DESCS","cost_freight","validity_type","status","STAX","JSON","stringify","submit","evt","test","prop","each","this","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAE,WAGA,YAEA,SAASC,GAAYC,GACnB,MAAOC,QAAOD,EAAIE,QAAQ,KAAM,KAGlC,QAASC,GAAUH,GACjB,GAAII,GAAS,GAAIC,QAAO,wBACtBC,EAAOF,EAAOE,KAAKN,EAErB,OAAOM,GAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,GAG9C,GAAIC,GAAYT,EAAE,+BAChBU,EAAYV,EAAE,yBAEhBS,GAAUE,GAAG,QAAS,WACpB,GAAIC,GAAwB,iCAC1BC,IAEFC,MAAKC,MAAMN,EAAUP,MAAME,QAAQQ,EAAuB,IAAII,QAC5DC,UAAW,IACXC,QAAQ,EACRC,KAAM,SAASC,GACb,GAAIC,GAAOD,EAAIC,KAAK,GAClBC,EAAKD,EAAK,SAEM,MAAdC,EAAGC,QACLV,EAASW,MAELF,GAAIA,EACJG,GAAIJ,EAAK,UACTK,IAAKL,EAAKM,SACVC,IAAK3B,EAAYoB,EAAKQ,KACtBC,UAAWT,EAAK,kBAChBU,aAAc1B,EAAUgB,EAAK,mBAC7BW,kBAAmBX,EAAKY,MACxBC,aAAcjC,EAAYoB,EAAK,qBAC/Bc,cAAed,EAAK,iBACpBe,OAAQf,EAAKgB,UAOvB3B,EAAUR,IAAIoC,KAAKC,UAAU1B,MAG/Bb,EAAE,4BAA4BwC,OAAO,SAASC,GAExC,WAAWC,KAAKhC,EAAUR,QAC5BF,EAAE,8BAA8B2C,KAAK,YAAY,GACjD3C,EAAE,YAAY4C,KAAK,WACjB5C,EAAE6C,MAAMF,KAAK,YAAY,KAE3B3C,EAAE6C,MAAMC,SAAS,gCAGjBC,OAAOC,MAAM,6CACbP,EAAIQ","file":"letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.min.js","sourcesContent":["$(function() {\r\n  /*jshint camelcase:false*/\r\n\r\n  \"use strict\";\r\n\r\n  function parseNumber(val) {\r\n    return Number(val.replace(/,/g, ''))\r\n  }\r\n\r\n  function parseDate(val) {\r\n    var dateRe = new RegExp(\"(\\\\d+)/(\\\\d+)/(\\\\d+)\"),\r\n      exec = dateRe.exec(val)\r\n\r\n    return exec[3] + '-' + exec[2] + '-' + exec[1]\r\n  }\r\n\r\n  var $idUpload = $('#id_upload-lc-register-text'),\r\n    $toUpload = $('#id_upload-lc-register')\r\n\r\n  $idUpload.on('input', function() {\r\n    var reportHeaderBeginText = 'FORM M PROCESSED ON CBN WINDOW',\r\n      toUpload = []\r\n\r\n    Papa.parse($idUpload.val().replace(reportHeaderBeginText, '').trim(), {\r\n      delimiter: '\\t',\r\n      header: true,\r\n      step: function(row) {\r\n        var data = row.data[0],\r\n          ba = data['BA NUM']\r\n\r\n        if (ba.length === 16) {\r\n          toUpload.push(\r\n            {\r\n              ba: ba,\r\n              mf: data['MF NUM'],\r\n              ccy: data.CURRENCY,\r\n              fob: parseNumber(data.FOB),\r\n              applicant: data['APPLICANT NAME'],\r\n              submitted_at: parseDate(data['DATE SUBMITTED']),\r\n              goods_description: data.DESCS,\r\n              cost_freight: parseNumber(data['COST AND FREIGHT']),\r\n              validity_type: data['VALIDITY TYPE'],\r\n              status: data.STAX\r\n            }\r\n          )\r\n        }\r\n      }\r\n    })\r\n\r\n    $toUpload.val(JSON.stringify(toUpload))\r\n  })\r\n\r\n  $('.upload-lc-register-form').submit(function(evt) {\r\n\r\n    if (/^\\[\\{\".+/.test($toUpload.val())) {\r\n      $('#upload-lc-register-submit').prop('disabled', true)\r\n      $('textarea').each(function() {\r\n        $(this).prop('readonly', true)\r\n      })\r\n      $(this).addClass('ui-widget-overlay ui-front')\r\n\r\n    } else {\r\n      window.alert('Nothing to upload or invalid upload data!')\r\n      evt.preventDefault()\r\n    }\r\n  })\r\n});\r\n"],"sourceRoot":"/source/"}