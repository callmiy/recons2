{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.js"],"names":["$","parseNumber","val","Number","replace","parseDate","dateRe","RegExp","exec","trim","$idUpload","$toUpload","on","reportHeaderBeginText","toUpload","Papa","parse","delimiter","header","step","row","data","push","ba","mf","ccy","CURRENCY","fob","FOB","applicant","submitted_at","goods_description","DESCS","cost_freight","validity_type","status","STAX","e","window","alert","message","JSON","stringify","submit","evt","test","prop","each","this","addClass","preventDefault"],"mappings":"AAAAA,EAAE,WAGA,YAEA,SAASC,GAAYC,GACnB,MAAOC,QAAOD,EAAIE,QAAQ,SAAU,KAGtC,QAASC,GAAUH,GACjB,GAAII,GAAS,GAAIC,QAAO,8BACpBC,EAASF,EAAOE,KAAKN,EAAIO,OAE7B,OAAOD,GAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,GAG9C,GAAIE,GAAYV,EAAE,+BACdW,EAAYX,EAAE,yBAElBU,GAAUE,GAAG,QAAS,WACpB,GAAIC,GAAwB,iCACxBC,IAEJC,MAAKC,MAAMN,EAAUR,MAAME,QAAQS,EAAuB,IAAIJ,OAAOL,QAAQ,KAAM,KACjFa,UAAW,IACXC,QAAQ,EACRC,KAAM,SAAUC,GACd,GAAIC,GAAOD,EAAIC,KAAK,EAEpB,KACEP,EAASQ,MAELC,GAAIF,EAAK,UAAUZ,OACnBe,GAAIH,EAAK,UAAUZ,OACnBgB,IAAKJ,EAAKK,SAASjB,OACnBkB,IAAK1B,EAAYoB,EAAKO,KACtBC,UAAWR,EAAK,kBAAkBZ,OAClCqB,aAAczB,EAAUgB,EAAK,mBAC7BU,kBAAmBV,EAAKW,MAAMvB,OAC9BwB,aAAchC,EAAYoB,EAAK,qBAC/Ba,cAAeb,EAAK,iBAAiBZ,OACrC0B,OAAQd,EAAKe,KAAK3B,SAGtB,MAAO4B,GACPC,OAAOC,MAAM,uBAAyBF,EAAEG,aAM9C7B,EAAUT,IAAIuC,KAAKC,UAAU5B,MAG/Bd,EAAE,4BAA4B2C,OAAO,SAAUC,GAEzC,WAAWC,KAAKlC,EAAUT,QAC5BF,EAAE,8BAA8B8C,KAAK,YAAY,GACjD9C,EAAE,YAAY+C,KAAK,WACjB/C,EAAEgD,MAAMF,KAAK,YAAY,KAE3B9C,EAAEgD,MAAMC,SAAS,gCAGjBX,OAAOC,MAAM,6CACbK,EAAIM","file":"letter_of_credit/static/letter_of_credit/js/uploaded-form-m/uploaded-form-m.min.js","sourcesContent":["$(function () {\r\n  /*jshint camelcase:false*/\r\n\r\n  \"use strict\";\r\n\r\n  function parseNumber(val) {\r\n    return Number(val.replace(/[,\\s]/g, ''))\r\n  }\r\n\r\n  function parseDate(val) {\r\n    var dateRe = new RegExp(\"(\\\\d+)[^\\d](\\\\d+)[^\\d](\\\\d+)\"),\r\n        exec   = dateRe.exec(val.trim())\r\n\r\n    return exec[3] + '-' + exec[2] + '-' + exec[1]\r\n  }\r\n\r\n  var $idUpload = $('#id_upload-lc-register-text'),\r\n      $toUpload = $('#id_upload-lc-register')\r\n\r\n  $idUpload.on('input', function () {\r\n    var reportHeaderBeginText = 'FORM M PROCESSED ON CBN WINDOW',\r\n        toUpload              = []\r\n\r\n    Papa.parse($idUpload.val().replace(reportHeaderBeginText, '').trim().replace(/\"/g, ''), {\r\n      delimiter: '\\t',\r\n      header: true,\r\n      step: function (row) {\r\n        var data = row.data[0]\r\n\r\n        try {\r\n          toUpload.push(\r\n            {\r\n              ba: data['BA NUM'].trim(),\r\n              mf: data['MF NUM'].trim(),\r\n              ccy: data.CURRENCY.trim(),\r\n              fob: parseNumber(data.FOB),\r\n              applicant: data['APPLICANT NAME'].trim(),\r\n              submitted_at: parseDate(data['DATE SUBMITTED']),\r\n              goods_description: data.DESCS.trim(),\r\n              cost_freight: parseNumber(data['COST AND FREIGHT']),\r\n              validity_type: data['VALIDITY TYPE'].trim(),\r\n              status: data.STAX.trim()\r\n            }\r\n          )\r\n        } catch (e) {\r\n          window.alert(\"Error parsing data\\n\" + e.message)\r\n        }\r\n\r\n      }\r\n    })\r\n\r\n    $toUpload.val(JSON.stringify(toUpload))\r\n  })\r\n\r\n  $('.upload-lc-register-form').submit(function (evt) {\r\n\r\n    if (/^\\[\\{\".+/.test($toUpload.val())) {\r\n      $('#upload-lc-register-submit').prop('disabled', true)\r\n      $('textarea').each(function () {\r\n        $(this).prop('readonly', true)\r\n      })\r\n      $(this).addClass('ui-widget-overlay ui-front')\r\n\r\n    } else {\r\n      window.alert('Nothing to upload or invalid upload data!')\r\n      evt.preventDefault()\r\n    }\r\n  })\r\n});\r\n"],"sourceRoot":"/source/"}