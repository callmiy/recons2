{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/lc-register-upload.js"],"names":["$","$preLabel","$targetCtrl","data","val","hide","css","position","top","left","margin","padding","color","display","border","cursor","background-color","white-space","border-radius","on","$el","this","focus","show","text","next","focusout","prev","focusin","reportText","$idUpload","lcInstances","reportHeaderBeginText","trim","slice","indexOf","Papa","parse","delimiter","header","step","row","lcInstance","obj","_","each","key","mappings","lcAttribute","push","JSON","stringify","submit","evt","test","prop","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAE,WACA,YAEA,IAAIC,GAAYD,EAAE,uBACdE,EAAcF,EAAE,IAAOC,EAAUE,KAAK,aAEtCD,GAAYE,OACdH,EAAUI,OAGZJ,EAAUK,KACRC,SAAU,WACVC,IAAK,GACLC,KAAM,GACNC,OAAQ,EACRC,QAAS,EACTC,MAAO,UACPC,QAAS,QACTC,OAAQ,EACRC,OAAQ,OACRC,mBAAoB,UACpBC,cAAe,WACfC,gBAAiB,IAChBC,GAAG,QAAS,WACX,GAAIC,EACJA,GAAMpB,EAAEqB,MACJnB,EAAYE,IACVF,EAAYE,MACdgB,EAAIf,QAEJH,EAAYoB,QACZF,EAAIG,QAEGrB,EAAYsB,OACjBtB,EAAYsB,OACdJ,EAAIf,OAEJe,EAAIG,QAGRrB,EAAYoB,UAEbG,OAAON,IACRO,SAAY,WACV,GAAIN,GAAMpB,EAAEqB,KACZ,OAAID,GAAIhB,IACDgB,EAAIhB,MAGAgB,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAIXH,EAAII,KACRJ,EAAII,OAGAJ,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAFf,QAQTK,QAAW,WAAc5B,EAAEqB,MAAMM,OAAOtB,SAG1C,IAEIwB,GAFAC,EAAc9B,EAAE,0BAChB+B,IAGJD,GAAUX,GAAG,QAAS,WACpB,GAAIa,GAAwB,qCAC5BH,GAAaC,EAAU1B,MAAM6B,OAC7BJ,EAAaA,EAAWK,MAAML,EAAWM,QAAQH,IAEjDI,KAAKC,MAAMR,GACTS,UAAW,IAAMC,QAAQ,EAAMC,KAAM,SAAUC,GAC7C,GAAIC,MACAC,EAAMF,EAAItC,KAAK,EAEsB,KAArCwC,EAAI,aAAaR,QAAQ,UAE7BS,EAAEC,KAAKF,EAAK,SAAUvC,EAAK0C,GACzB,GAAIA,IAAOC,UAAU,CACnB,GAAIC,GAAcD,SAASD,EAC3BJ,GAAWM,GAAe5C,EAAI6B,UAIlCF,EAAYkB,KAAKP,OAIrBZ,EAAU1B,IAAI8C,KAAKC,UAAUpB,MAG/B/B,EAAE,4BAA4BoD,OAAO,SAAUC,GAEzC,WAAWC,KAAKxB,EAAU1B,QAC5BJ,EAAE,8BAA8BuD,KAAK,YAAY,GACjDzB,EAAUyB,KAAK,YAAY,GAC3BvD,EAAEqB,MAAMmC,SAAS,gCAGjBC,OAAOC,MAAM,6CACbL,EAAIM","file":"letter_of_credit/static/letter_of_credit/js/lc-register-upload.min.js","sourcesContent":["$(function () {\r\n  \"use strict\";\r\n\r\n  var $preLabel = $('pre[data-label-for]');\r\n  var $targetCtrl = $(\"#\" + ($preLabel.data('label-for')));\r\n\r\n  if ($targetCtrl.val()) {\r\n    $preLabel.hide();\r\n  }\r\n\r\n  $preLabel.css({\r\n    position: 'absolute',\r\n    top: 10,\r\n    left: 25,\r\n    margin: 0,\r\n    padding: 0,\r\n    color: '#ADACAC',\r\n    display: 'block',\r\n    border: 0,\r\n    cursor: 'text',\r\n    'background-color': 'initial',\r\n    'white-space': 'pre-line',\r\n    'border-radius': 0\r\n  }).on('click', function () {\r\n      var $el;\r\n      $el = $(this);\r\n      if ($targetCtrl.val) {\r\n        if ($targetCtrl.val()) {\r\n          $el.hide();\r\n        } else {\r\n          $targetCtrl.focus();\r\n          $el.show();\r\n        }\r\n      } else if ($targetCtrl.text) {\r\n        if ($targetCtrl.text()) {\r\n          $el.hide();\r\n        } else {\r\n          $el.show();\r\n        }\r\n      }\r\n      $targetCtrl.focus();\r\n    })\r\n    .next().on({\r\n    'focusout': function () {\r\n      var $el = $(this);\r\n      if ($el.val) {\r\n        if (!$el.val()) {\r\n          return $el.prev().show();\r\n        } else {\r\n          return $el.prev().hide();\r\n        }\r\n      } else if ($el.text) {\r\n        if (!$el.text()) {\r\n          return $el.prev().show();\r\n        } else {\r\n          return $el.prev().hide();\r\n        }\r\n      }\r\n    },\r\n    'focusin': function () { $(this).prev().hide();}\r\n  });\r\n\r\n  var $idUpload   = $('#id_upload-lc-register'),\r\n      lcInstances = [],\r\n      reportText\r\n\r\n  $idUpload.on('input', function () {\r\n    var reportHeaderBeginText = 'APPLICANT REF\tLC ESTABLISHMENT DATE'\r\n    reportText = $idUpload.val().trim()\r\n    reportText = reportText.slice(reportText.indexOf(reportHeaderBeginText))\r\n\r\n    Papa.parse(reportText, {\r\n      delimiter: '\\t', header: true, step: function (row) {\r\n        var lcInstance = {}\r\n        var obj = row.data[0]\r\n\r\n        if (obj['LC NUMBER'].indexOf('GTE-') === 0) return\r\n\r\n        _.each(obj, function (val, key) {\r\n          if (key in mappings) {\r\n            var lcAttribute = mappings[key]\r\n            lcInstance[lcAttribute] = val.trim()\r\n          }\r\n        })\r\n\r\n        lcInstances.push(lcInstance)\r\n      }\r\n    })\r\n\r\n    $idUpload.val(JSON.stringify(lcInstances));\r\n  });\r\n\r\n  $('.upload-lc-register-form').submit(function (evt) {\r\n\r\n    if (/^\\[\\{\".+/.test($idUpload.val())) {\r\n      $('#upload-lc-register-submit').prop('disabled', true)\r\n      $idUpload.prop('readonly', true)\r\n      $(this).addClass('ui-widget-overlay ui-front')\r\n\r\n    } else {\r\n      window.alert('Nothing to upload or invalid upload data!')\r\n      evt.preventDefault()\r\n    }\r\n  })\r\n});\r\n"],"sourceRoot":"/source/"}