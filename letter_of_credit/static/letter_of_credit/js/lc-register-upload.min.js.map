{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/lc-register-upload.js"],"names":["$","$preLabel","$targetCtrl","data","val","hide","css","position","top","left","margin","padding","color","display","border","cursor","background-color","white-space","border-radius","on","$el","this","focus","show","text","next","focusout","prev","focusin","reportText","$idUpload","returnedData","reportHeaderBeginText","trim","slice","indexOf","results","Papa","parse","delimiter","header","i","length","obj","returnedObj","key","mappings","mappingsVal","push","JSON","stringify","submit","evt","test","prop","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAE,WACA,YAEA,IAAIC,GAAYD,EAAE,uBACdE,EAAcF,EAAE,IAAOC,EAAUE,KAAK,aAEtCD,GAAYE,OACdH,EAAUI,OAGZJ,EAAUK,KACRC,SAAU,WACVC,IAAK,GACLC,KAAM,GACNC,OAAQ,EACRC,QAAS,EACTC,MAAO,UACPC,QAAS,QACTC,OAAQ,EACRC,OAAQ,OACRC,mBAAoB,UACpBC,cAAe,WACfC,gBAAiB,IAChBC,GAAG,QAAS,WACb,GAAIC,EACJA,GAAMpB,EAAEqB,MACJnB,EAAYE,IACVF,EAAYE,MACdgB,EAAIf,QAEJH,EAAYoB,QACZF,EAAIG,QAEGrB,EAAYsB,OACjBtB,EAAYsB,OACdJ,EAAIf,OAEJe,EAAIG,QAGRrB,EAAYoB,UAEXG,OAAON,IACNO,SAAY,WACV,GAAIN,GAAMpB,EAAEqB,KACZ,OAAID,GAAIhB,IACDgB,EAAIhB,MAGAgB,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAIXH,EAAII,KACRJ,EAAII,OAGAJ,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAFf,QAQTK,QAAW,WAAa5B,EAAEqB,MAAMM,OAAOtB,SAG3C,IAEEwB,GAFEC,EAAY9B,EAAE,0BAChB+B,IAGFD,GAAUX,GAAG,QAAS,WACpB,GAAIa,GAAwB,qCAE5BH,GAAaC,EAAU1B,MAAM6B,OAE7BJ,EAAaA,EAAWK,MAAML,EAAWM,QAAQH,GAIjD,KAAK,GAFDI,GAAUC,KAAKC,MAAMT,GAAaU,UAAW,IAAMC,QAAQ,IAAOrC,KAE7DsC,EAAI,EAAGA,EAAIL,EAAQM,OAAQD,IAAK,CACvC,GAAIE,GAAMP,EAAQK,GAChBG,IACF,KAAK,GAAIC,KAAOF,GACd,GAAIE,IAAOC,UAAU,CACnB,GAAIC,GAAcD,SAASD,EAC3BD,GAAYG,GAAeJ,EAAIE,GAAKZ,OAGxCF,EAAaiB,KAAKJ,GAEpBd,EAAU1B,IAAI6C,KAAKC,UAAUnB,MAG/B/B,EAAE,4BAA4BmD,OAAO,SAASC,GAExC,WAAWC,KAAKvB,EAAU1B,QAC5BJ,EAAE,8BAA8BsD,KAAK,YAAY,GACjDxB,EAAUwB,KAAK,YAAY,GAC3BtD,EAAEqB,MAAMkC,SAAS,gCAGjBC,OAAOC,MAAM,6CACbL,EAAIM","file":"letter_of_credit/static/letter_of_credit/js/lc-register-upload.min.js","sourcesContent":["$(function() {\n  \"use strict\";\n\n  var $preLabel = $('pre[data-label-for]');\n  var $targetCtrl = $(\"#\" + ($preLabel.data('label-for')));\n\n  if ($targetCtrl.val()) {\n    $preLabel.hide();\n  }\n\n  $preLabel.css({\n    position: 'absolute',\n    top: 10,\n    left: 25,\n    margin: 0,\n    padding: 0,\n    color: '#ADACAC',\n    display: 'block',\n    border: 0,\n    cursor: 'text',\n    'background-color': 'initial',\n    'white-space': 'pre-line',\n    'border-radius': 0\n  }).on('click', function() {\n    var $el;\n    $el = $(this);\n    if ($targetCtrl.val) {\n      if ($targetCtrl.val()) {\n        $el.hide();\n      } else {\n        $targetCtrl.focus();\n        $el.show();\n      }\n    } else if ($targetCtrl.text) {\n      if ($targetCtrl.text()) {\n        $el.hide();\n      } else {\n        $el.show();\n      }\n    }\n    $targetCtrl.focus();\n  })\n    .next().on({\n      'focusout': function() {\n        var $el = $(this);\n        if ($el.val) {\n          if (!$el.val()) {\n            return $el.prev().show();\n          } else {\n            return $el.prev().hide();\n          }\n        } else if ($el.text) {\n          if (!$el.text()) {\n            return $el.prev().show();\n          } else {\n            return $el.prev().hide();\n          }\n        }\n      },\n      'focusin': function() { $(this).prev().hide();}\n    });\n\n  var $idUpload = $('#id_upload-lc-register'),\n    returnedData = [],\n    reportText\n\n  $idUpload.on('input', function() {\n    var reportHeaderBeginText = 'APPLICANT REF\tLC ESTABLISHMENT DATE'\n\n    reportText = $idUpload.val().trim()\n\n    reportText = reportText.slice(reportText.indexOf(reportHeaderBeginText))\n\n    var results = Papa.parse(reportText, {delimiter: '\\t', header: true}).data;\n\n    for (var i = 0; i < results.length; i++) {\n      var obj = results[i],\n        returnedObj = {};\n      for (var key in obj) {\n        if (key in mappings) {\n          var mappingsVal = mappings[key];\n          returnedObj[mappingsVal] = obj[key].trim();\n        }\n      }\n      returnedData.push(returnedObj);\n    }\n    $idUpload.val(JSON.stringify(returnedData));\n  });\n\n  $('.upload-lc-register-form').submit(function(evt) {\n\n    if (/^\\[\\{\".+/.test($idUpload.val())) {\n      $('#upload-lc-register-submit').prop('disabled', true)\n      $idUpload.prop('readonly', true)\n      $(this).addClass('ui-widget-overlay ui-front')\n\n    } else{\n      window.alert('Nothing to upload or invalid upload data!')\n      evt.preventDefault()\n    }\n  })\n});\n"],"sourceRoot":"/source/"}