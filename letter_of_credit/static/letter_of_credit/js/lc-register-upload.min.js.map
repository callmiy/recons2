{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/lc-register-upload.js"],"names":["$","reportText","$idUpload","lcInstances","$dateFormat","change","prop","filter","size","on","reportHeaderBeginText","val","trim","slice","indexOf","Papa","parse","delimiter","header","step","row","lcInstance","obj","data","_","each","key","mappings","lcAttribute","push","JSON","stringify","submit","evt","test","this","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAG,WACD,YAEA,IAGEC,GAHEC,EAAYF,EAAG,0BACjBG,KACAC,EAAcJ,EAAG,qBAInBI,GAAYC,OAAQ,WAClBH,EAAUI,KAAM,YAAaF,EAAYG,OAAQ,YAAaC,UAGhEN,EAAUO,GAAI,QAAS,WACrB,GAAIC,GAAwB,qCAC5BT,GAAaC,EAAUS,MAAMC,OAC7BX,EAAaA,EAAWY,MAAOZ,EAAWa,QAASJ,IAEnDK,KAAKC,MAAOf,GACVgB,UAAW,IAAMC,QAAQ,EAAMC,KAAM,SAAUC,GAC7C,GAAIC,MACAC,EAAMF,EAAIG,KAAK,EAEyB,KAAvCD,EAAI,aAAaR,QAAS,UAE/BU,EAAEC,KAAMH,EAAK,SAAUX,EAAKe,GAC1B,GAAKA,IAAOC,UAAW,CACrB,GAAIC,GAAcD,SAASD,EAC3BL,GAAWO,GAAejB,EAAIC,UAIlCT,EAAY0B,KAAMR,OAItBnB,EAAUS,IAAKmB,KAAKC,UAAW5B,MAGjCH,EAAG,4BAA6BgC,OAAQ,SAAUC,GAE3C,WAAWC,KAAMhC,EAAUS,QAC9BX,EAAG,8BAA+BM,KAAM,YAAY,GACpDJ,EAAUI,KAAM,YAAY,GAC5BN,EAAGmC,MAAOC,SAAU,gCAGpBC,OAAOC,MAAO,6CACdL,EAAIM","file":"letter_of_credit/static/letter_of_credit/js/lc-register-upload.min.js","sourcesContent":["$( function () {\r\n  \"use strict\";\r\n\r\n  var $idUpload = $( '#id_upload-lc-register' ),\r\n    lcInstances = [],\r\n    $dateFormat = $( '[name=date-format]' ),\r\n    reportText\r\n\r\n\r\n  $dateFormat.change( function () {\r\n    $idUpload.prop( 'disabled', !$dateFormat.filter( ':checked' ).size() )\r\n  } )\r\n\r\n  $idUpload.on( 'input', function () {\r\n    var reportHeaderBeginText = 'APPLICANT REF\tLC ESTABLISHMENT DATE'\r\n    reportText = $idUpload.val().trim()\r\n    reportText = reportText.slice( reportText.indexOf( reportHeaderBeginText ) )\r\n\r\n    Papa.parse( reportText, {\r\n      delimiter: '\\t', header: true, step: function (row) {\r\n        var lcInstance = {}\r\n        var obj = row.data[0]\r\n\r\n        if ( obj['LC NUMBER'].indexOf( 'GTE-' ) === 0 ) return\r\n\r\n        _.each( obj, function (val, key) {\r\n          if ( key in mappings ) {\r\n            var lcAttribute = mappings[key]\r\n            lcInstance[lcAttribute] = val.trim()\r\n          }\r\n        } )\r\n\r\n        lcInstances.push( lcInstance )\r\n      }\r\n    } )\r\n\r\n    $idUpload.val( JSON.stringify( lcInstances ) );\r\n  } );\r\n\r\n  $( '.upload-lc-register-form' ).submit( function (evt) {\r\n\r\n    if ( /^\\[\\{\".+/.test( $idUpload.val() ) ) {\r\n      $( '#upload-lc-register-submit' ).prop( 'disabled', true )\r\n      $idUpload.prop( 'readonly', true )\r\n      $( this ).addClass( 'ui-widget-overlay ui-front' )\r\n\r\n    } else {\r\n      window.alert( 'Nothing to upload or invalid upload data!' )\r\n      evt.preventDefault()\r\n    }\r\n  } )\r\n} );\r\n"],"sourceRoot":"/source/"}