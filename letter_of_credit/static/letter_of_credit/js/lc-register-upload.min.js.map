{"version":3,"sources":["letter_of_credit/static/letter_of_credit/js/lc-register-upload.js"],"names":["$","$preLabel","$targetCtrl","data","val","hide","css","position","top","left","margin","padding","color","display","border","cursor","background-color","white-space","border-radius","on","$el","this","focus","show","text","next","focusout","prev","focusin","reportText","$idUpload","returnedData","reportHeaderBeginText","trim","slice","indexOf","results","Papa","parse","delimiter","header","i","length","obj","returnedObj","key","mappings","mappingsVal","push","JSON","stringify","submit","evt","test","prop","addClass","window","alert","preventDefault"],"mappings":"AAAAA,EAAE,WACA,YAEA,IAAIC,GAAYD,EAAE,uBACdE,EAAcF,EAAE,IAAOC,EAAUE,KAAK,aAEtCD,GAAYE,OACdH,EAAUI,OAGZJ,EAAUK,KACRC,SAAU,WACVC,IAAK,GACLC,KAAM,GACNC,OAAQ,EACRC,QAAS,EACTC,MAAO,UACPC,QAAS,QACTC,OAAQ,EACRC,OAAQ,OACRC,mBAAoB,UACpBC,cAAe,WACfC,gBAAiB,IAChBC,GAAG,QAAS,WACb,GAAIC,EACJA,GAAMpB,EAAEqB,MACJnB,EAAYE,IACVF,EAAYE,MACdgB,EAAIf,QAEJH,EAAYoB,QACZF,EAAIG,QAEGrB,EAAYsB,OACjBtB,EAAYsB,OACdJ,EAAIf,OAEJe,EAAIG,QAGRrB,EAAYoB,UAEXG,OAAON,IACNO,SAAY,WACV,GAAIN,GAAMpB,EAAEqB,KACZ,OAAID,GAAIhB,IACDgB,EAAIhB,MAGAgB,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAIXH,EAAII,KACRJ,EAAII,OAGAJ,EAAIO,OAAOtB,OAFXe,EAAIO,OAAOJ,OAFf,QAQTK,QAAW,WAAa5B,EAAEqB,MAAMM,OAAOtB,SAG3C,IAEEwB,GAFEC,EAAY9B,EAAE,0BAChB+B,IAGFD,GAAUX,GAAG,QAAS,WACpB,GAAIa,GAAwB,qCAE5BH,GAAaC,EAAU1B,MAAM6B,OAE7BJ,EAAaA,EAAWK,MAAML,EAAWM,QAAQH,GAIjD,KAAK,GAFDI,GAAUC,KAAKC,MAAMT,GAAaU,UAAW,IAAMC,QAAQ,IAAOrC,KAE7DsC,EAAI,EAAGA,EAAIL,EAAQM,OAAQD,IAAK,CACvC,GAAIE,GAAMP,EAAQK,GAChBG,IACF,KAAK,GAAIC,KAAOF,GACd,GAAIE,IAAOC,UAAU,CACnB,GAAIC,GAAcD,SAASD,EAC3BD,GAAYG,GAAeJ,EAAIE,GAAKZ,OAGxCF,EAAaiB,KAAKJ,GAEpBd,EAAU1B,IAAI6C,KAAKC,UAAUnB,MAG/B/B,EAAE,4BAA4BmD,OAAO,SAASC,GAExC,WAAWC,KAAKvB,EAAU1B,QAC5BJ,EAAE,8BAA8BsD,KAAK,YAAY,GACjDxB,EAAUwB,KAAK,YAAY,GAC3BtD,EAAEqB,MAAMkC,SAAS,gCAGjBC,OAAOC,MAAM,6CACbL,EAAIM","file":"letter_of_credit/static/letter_of_credit/js/lc-register-upload.min.js","sourcesContent":["$(function() {\r\n  \"use strict\";\r\n\r\n  var $preLabel = $('pre[data-label-for]');\r\n  var $targetCtrl = $(\"#\" + ($preLabel.data('label-for')));\r\n\r\n  if ($targetCtrl.val()) {\r\n    $preLabel.hide();\r\n  }\r\n\r\n  $preLabel.css({\r\n    position: 'absolute',\r\n    top: 10,\r\n    left: 25,\r\n    margin: 0,\r\n    padding: 0,\r\n    color: '#ADACAC',\r\n    display: 'block',\r\n    border: 0,\r\n    cursor: 'text',\r\n    'background-color': 'initial',\r\n    'white-space': 'pre-line',\r\n    'border-radius': 0\r\n  }).on('click', function() {\r\n    var $el;\r\n    $el = $(this);\r\n    if ($targetCtrl.val) {\r\n      if ($targetCtrl.val()) {\r\n        $el.hide();\r\n      } else {\r\n        $targetCtrl.focus();\r\n        $el.show();\r\n      }\r\n    } else if ($targetCtrl.text) {\r\n      if ($targetCtrl.text()) {\r\n        $el.hide();\r\n      } else {\r\n        $el.show();\r\n      }\r\n    }\r\n    $targetCtrl.focus();\r\n  })\r\n    .next().on({\r\n      'focusout': function() {\r\n        var $el = $(this);\r\n        if ($el.val) {\r\n          if (!$el.val()) {\r\n            return $el.prev().show();\r\n          } else {\r\n            return $el.prev().hide();\r\n          }\r\n        } else if ($el.text) {\r\n          if (!$el.text()) {\r\n            return $el.prev().show();\r\n          } else {\r\n            return $el.prev().hide();\r\n          }\r\n        }\r\n      },\r\n      'focusin': function() { $(this).prev().hide();}\r\n    });\r\n\r\n  var $idUpload = $('#id_upload-lc-register'),\r\n    returnedData = [],\r\n    reportText\r\n\r\n  $idUpload.on('input', function() {\r\n    var reportHeaderBeginText = 'APPLICANT REF\tLC ESTABLISHMENT DATE'\r\n\r\n    reportText = $idUpload.val().trim()\r\n\r\n    reportText = reportText.slice(reportText.indexOf(reportHeaderBeginText))\r\n\r\n    var results = Papa.parse(reportText, {delimiter: '\\t', header: true}).data;\r\n\r\n    for (var i = 0; i < results.length; i++) {\r\n      var obj = results[i],\r\n        returnedObj = {};\r\n      for (var key in obj) {\r\n        if (key in mappings) {\r\n          var mappingsVal = mappings[key];\r\n          returnedObj[mappingsVal] = obj[key].trim();\r\n        }\r\n      }\r\n      returnedData.push(returnedObj);\r\n    }\r\n    $idUpload.val(JSON.stringify(returnedData));\r\n  });\r\n\r\n  $('.upload-lc-register-form').submit(function(evt) {\r\n\r\n    if (/^\\[\\{\".+/.test($idUpload.val())) {\r\n      $('#upload-lc-register-submit').prop('disabled', true)\r\n      $idUpload.prop('readonly', true)\r\n      $(this).addClass('ui-widget-overlay ui-front')\r\n\r\n    } else{\r\n      window.alert('Nothing to upload or invalid upload data!')\r\n      evt.preventDefault()\r\n    }\r\n  })\r\n});\r\n"],"sourceRoot":"/source/"}