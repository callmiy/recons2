<div class="treasury-upload-allocation-directive-container"><uib-accordion><uib-accordion-group is-open="uploadTreasuryAllocation.showPasteForm"><uib-accordion-heading><i class="glyphicon" ng-class="{'glyphicon-chevron-down': uploadTreasuryAllocation.showPasteForm, 'glyphicon-chevron-right': !uploadTreasuryAllocation.showPasteForm}"></i> Copy and paste from blotter excel</uib-accordion-heading><form ng-show="uploadTreasuryAllocation.showPasteForm" class="form-horizontal" role="form" name="pasteBlotterForm"><textarea style="height: 350px;" name="pasteBlotterText" id="paste-blotter" class="form-control" placeholder="copy and paste from blotter" ng-model="uploadTreasuryAllocation.pastedBlotter" ng-change="uploadTreasuryAllocation.onBlotterPasted()"></textarea></form></uib-accordion-group></uib-accordion><div ng-if="uploadTreasuryAllocation.showParsedPastedBid" class="parsed-pasted-bid-table-container"><div ng-if="uploadTreasuryAllocation.showSaveBtn(uploadTreasuryAllocation.tableParams.dataset)" class="save-parsed-allocation-btn-container"><button class="btn btn-success" ng-disabled="uploadTreasuryAllocation.isSaving" ng-click="uploadTreasuryAllocation.saveAllocations(uploadTreasuryAllocation.tableParams.dataset)">{$uploadTreasuryAllocation.isSaving ? 'Saving...' : 'Save'$}<spinner name="treasuryAllocationSpinner" img-src="{$$root.spinnerImgSrc$}"></spinner></button></div><div class="parsed-pasted-bid-table"><div ng-class="{'parsed-pasted-bid-table-overlay': uploadTreasuryAllocation.isSaving}"></div><table ng-table="uploadTreasuryAllocation.tableParams" class="table table-bordered table-condensed table-responsive table-striped"><tbody><tr ng-repeat="allocationObj in $data track by allocationObj.index" ng-class="{'pasted-bid-row-matched': allocationObj.original_requests}"><td data-title="'S/N'">{$$index + 1$}</td><td title="'DEAL NO'" filter="{TRANSACTION_DEAL_SLIP: 'text'}">{$::allocationObj.TRANSACTION_DEAL_SLIP$}</td><td data-title="'SOURCE'" sortable="'SOURCE_OF_FUND'">{$::allocationObj.SOURCE_OF_FUND$}</td><td data-title="'DEAL DATE'" sortable="'DEAL_DATE'">{$::allocationObj.DEAL_DATE | date:'dd-MMM-yyyy'$}</td><td data-title="'SETTLEMENT DATE'" sortable="'SETTLEMENT_DATE'">{$::allocationObj.SETTLEMENT_DATE | date:'dd-MMM-yyyy'$}</td><td data-title="'TYPE'" sortable="'TRANSACTION_TYPE'">{$::allocationObj.TRANSACTION_TYPE$}</td><td data-title="'CATEGORY'" sortable="'CLIENT_CATEGORY'" filter="{CLIENT_CATEGORY:'text'}">{$ allocationObj.CLIENT_CATEGORY$}</td><td data-title="'RATE'" sortable="'RATE'">{$::allocationObj.RATE $}</td><td data-title="'CCY'" sortable="'CURRENCY'" filter="{CURRENCY:'text'}">{$::allocationObj.CURRENCY $}</td><td data-title="'CUSTOMER NAME'" sortable="'NAME_NO_REF'" filter="{NAME_NO_REF:'text'}">{$allocationObj.NAME_NO_REF $}</td><td data-title="'REFERENCE'" sortable="'REF'" filter="{REF :'text'}">{$allocationObj.REF $}</td><td data-title="'CURRENT ALLOCATION'" sortable="'FCY_AMOUNT'" filter="{FCY_AMOUNT: 'number'}">{$::allocationObj.FCY_AMOUNT |number:2$}</td><td style="min-width: 135px;" data-title="'ORIGINAL REQUEST'" filter="{original_requests :'number'}"><span class="original-request-row" ng-repeat="req in allocationObj.original_requests" ng-class="{'multiple-requests': (allocationObj.original_requests.length > 1), 'deleted': (allocationObj.original_requests_deleted[$index] == $index)}">{$::req |number:2$} <span class="glyphicon remove-add-bid-icons" ng-class="{'glyphicon-remove': (allocationObj.original_requests_deleted[$index] != $index), 'glyphicon-plus-sign': (allocationObj.original_requests_deleted[$index] == $index)}" ng-click="uploadTreasuryAllocation.toggleMapOriginalRequest(allocationObj.index, $index)"></span></span></td><td data-title="'PREVIOUS ALLOCATIONS'" filter="{previous_allocations :'number'}"><span class="original-request-row" ng-repeat="req in allocationObj.previous_allocations" ng-class="{'multiple-requests': (allocationObj.original_requests.length > 1), 'deleted': (allocationObj.original_requests_deleted[$index] == $index)}">{$::req |number:2$}</span></td><td data-title="'PREVIOUS OUTSTANDING'" filter="{previous_outstandings :'number'}"><span class="original-request-row" ng-repeat="req in allocationObj.previous_outstandings" ng-class="{'multiple-requests': (allocationObj.original_requests.length > 1), 'deleted': (allocationObj.original_requests_deleted[$index] == $index)}">{$::req |number:2$}</span></td><td data-title="'CURRENT OUTSTANDING'" sortable="'current_outstandings'"><span class="original-request-row" ng-repeat="req in allocationObj.current_outstandings" ng-class="{'multiple-requests': (allocationObj.original_requests.length > 1), 'deleted': (allocationObj.original_requests_deleted[$index] == $index)}">{$req |number:2$}</span></td></tr></tbody></table></div></div></div>