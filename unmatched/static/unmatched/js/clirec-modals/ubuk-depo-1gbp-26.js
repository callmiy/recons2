// Generated by CoffeeScript 1.7.1
$(function() {
  var absNetAmtFormatted, ids, netAmt, rows, selectionSummary, _ref;
  _ref = selectedClirecsEnum(), rows = _ref.rows, ids = _ref.ids, netAmt = _ref.netAmt, absNetAmtFormatted = _ref.absNetAmtFormatted, selectionSummary = _ref.selectionSummary;
  $('#id_clirec_ids').val(ids.join(','));
  $("#id_manual_post_amount").val(Math.abs(netAmt));
  $('#id_dr_acct_text').val(clirecUploadUtils.nostroObj.ledger_acct.number).addClass('nostro-ledger');
  $('#id_dr_acct').val(clirecUploadUtils.nostroObj.ledger_acct.id);
  $('#id_posting_enum').val(_.template("<%=selectionSummary%>\n\n%tab%DR%tab%<%-drAcct%>%tab%<%-absNetAmtFormatted%>\n%tab%CR%tab%<%-crAcct%>%tab%<%-absNetAmtFormatted%>", {
    selectionSummary: selectionSummary,
    absNetAmtFormatted: absNetAmtFormatted,
    drAcct: clirecUploadUtils.nostroObj.ledger_acct.number,
    crAcct: $('#id_cr_acct_text').val()
  }).replace(/%tab%/g, '\t'));
  return $('#clirec-modal-ubuk-depo-1gbp-26-form').submit(function(evt) {
    evt.preventDefault();
    return $.ajax({
      url: clirecUploadUtils.getModalActionUrl('ubuk-depo-1gbp-26'),
      data: $(this).serialize(),
      type: 'post',
      dataType: 'json',
      success: function(resp) {
        var id, _i, _len, _ref1, _results;
        setSuccessMessage(resp);
        _ref1 = resp.ids;
        _results = [];
        for (_i = 0, _len = _ref1.length; _i < _len; _i++) {
          id = _ref1[_i];
          _results.push(setRowComment(rows[id], resp.comment));
        }
        return _results;
      },
      error: function(resp) {
        return console.log(resp);
      }
    });
  });
});
